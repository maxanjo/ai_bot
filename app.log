INFO:werkzeug:127.0.0.1 - - [01/Jan/2024 20:41:34] "OPTIONS /projects/e47f0f811145d03c33fd6639dc3f09c0839d0891e264d849a75df04f4d047625/KW2uCtbdOgV3cltg8W3i6JbZcQWtfy9j HTTP/1.1" 200 -
INFO:myapp:{'api': 1, 'product_data': 'http://wordpress/wp-json/chatty/v1', 'website': 'asdf', 'id': 4, 'left_tokens': 78266, 'description': None, 'temperature': Decimal('0.00'), 'model': 'gpt-3.5-turbo', 'prompt': 'Вы — ИИ ассистент компании. Вам будут заданы вопросы о нашей компании. Вежливо отвечайте на вопросы.\r\n    Ниже мы предоставили контекстную информацию.\r\n    ---------------------\r\n    {context_str}\r\n    ---------------------\r\n    Учитывая эту информацию, ответьте, пожалуйста, на вопрос: {query_str}\r\n    ', 'response_mode': 'compact', 'user_id': 12, 'answer': None, 'context': None}
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): wordpress:80
DEBUG:urllib3.connectionpool:http://wordpress:80 "GET /wp-json/chatty/v1/shop_meta HTTP/1.1" 200 67
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.openai.com:443
DEBUG:urllib3.connectionpool:https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
INFO:myapp:[{'url_params': 'product_name=samsung&category=smartphones', 'is_related': 'yes', 'category': 'smartphones'}]
INFO:myapp:product_name=samsung&category=smartphones
INFO:myapp:prompt
INFO:myapp:You are AI assistant for a online shop. You should determine if a client is asking or information about a product in our store. It can be a question about price, availability in stock, product characteristic, comparing 2 products. In this case you should contruct query parameters based on a client question. Construct them for every mentioned product. Add sort_price parameter if required .For example product_name=item_name&color=green&size=44&sort_price=desc|asc List of available query parameters: product_name, color. product_name is a required parameter. You should use it in every query.Use only these query parameters for consructing. Add a category. List of available categories: laptops,smartphones. Write your asnwer as array of json objects. [{url_params: <url_here>, is_related: 'yes', category: <category_here> }] If the question is not related to products of the store, then your answer would be [{is_related: 'no'}] Be strict. Fix typos in product names. Dont write anything else. Your answer will be used for a next query. Client question: hello do you have samsung smartphones .Your answer:
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): wordpress:80
DEBUG:urllib3.connectionpool:http://wordpress:80 "GET /wp-json/chatty/v1/posts?product_name=samsung&category=smartphones HTTP/1.1" 200 2193
INFO:myapp:api data Unfortunately i cant find product 'samsung'. But please checkout our similar products: 
[{"ID":17,"post_author":"1","post_date":"2023-12-27 20:25:46","post_date_gmt":"2023-12-27 17:25:46","post_content":"<ul class=\"a-unordered-list a-vertical a-spacing-mini\">\r\n \t<li class=\"a-spacing-mini\"><span class=\"a-list-item\">Ultra-immersive display design Light up the screen to enjoy an unrivalled experience. The 1.61mm ultra-thin bezels offer a boundless vision.<\/span><\/li>\r\n \t<li class=\"a-spacing-mini\"><span class=\"a-list-item\">Built for more scenarios IP68 water and dust resistant* Born splash-proof and water-resistant, thanks to the precision manufacturing. Record special memories anytime and anywhere.<\/span><\/li>\r\n \t<li class=\"a-spacing-mini\"><span class=\"a-list-item\">Leica main camera with professional optical lens Captures every great moment<\/span><\/li>\r\n \t<li class=\"a-spacing-mini\"><span class=\"a-list-item\">Masterpiece performance Leading Snapdragon 8 Gen 2 Boosted performance, reduced consumption<\/span><\/li>\r\n<\/ul>","post_title":"Xiaomi 13","post_excerpt":"","post_status":"publish","comment_status":"open","ping_status":"closed","post_password":"","post_name":"%d0%ba%d1%80%d0%be%d1%81%d1%81%d0%be%d0%b2%d0%ba%d0%b8","to_ping":"","pinged":"","post_modified":"2024-01-01 12:03:20","post_modified_gmt":"2024-01-01 09:03:20","post_content_filtered":"","post_parent":0,"guid":"http:\/\/wordpress\/?post_type=product&#038;p=17","menu_order":0,"post_type":"product","post_mime_type":"","comment_count":"0","filter":"raw"},{"ID":20,"post_author":"1","post_date":"2023-12-29 11:32:59","post_date_gmt":"2023-12-29 08:32:59","post_content":"","post_title":"Xiaomi Redmi 12 128GB - Black - Unlocked - Dual-SIM","post_excerpt":"","post_status":"publish","comment_status":"open","ping_status":"closed","post_password":"","post_name":"xiaomi-12-black","to_ping":"","pinged":"","post_modified":"2023-12-29 11:45:27","post_modified_gmt":"2023-12-29 08:45:27","post_content_filtered":"","post_parent":0,"guid":"http:\/\/wordpress\/?post_type=product&#038;p=20","menu_order":0,"post_type":"product","post_mime_type":"","comment_count":"0","filter":"raw"}]
DEBUG:llama_index.storage.kvstore.simple_kvstore:Loading llama_index.storage.kvstore.simple_kvstore from projects/4/data\docstore.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/docstore.json
DEBUG:llama_index.storage.kvstore.simple_kvstore:Loading llama_index.storage.kvstore.simple_kvstore from projects/4/data\index_store.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/index_store.json
DEBUG:llama_index.vector_stores.simple:Loading llama_index.vector_stores.simple from projects/4/data\vector_store.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/vector_store.json
DEBUG:llama_index.graph_stores.simple:Loading llama_index.graph_stores.simple from projects/4/data\graph_store.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/graph_store.json
INFO:myapp:Final prompt: Вы — ИИ ассистент компании. Вам будут заданы вопросы о нашей компании. Вежливо отвечайте на вопросы.
    Ниже мы предоставили контекстную информацию.
    ---------------------
    {context_str}
    ---------------------
    Учитывая эту информацию, ответьте, пожалуйста, на вопрос: {query_str}
    
 History of conversation with the client: None. 
 Information about relative products Unfortunately i cant find product 'samsung'. But please checkout our similar products: 
[{"ID":17,"post_author":"1","post_date":"2023-12-27 20:25:46","post_date_gmt":"2023-12-27 17:25:46","post_content":"<ul class=\"a-unordered-list a-vertical a-spacing-mini\">\r\n \t<li class=\"a-spacing-mini\"><span class=\"a-list-item\">Ultra-immersive display design Light up the screen to enjoy an unrivalled experience. The 1.61mm ultra-thin bezels offer a boundless vision.<\/span><\/li>\r\n \t<li class=\"a-spacing-mini\"><span class=\"a-list-item\">Built for more scenarios IP68 water and dust resistant* Born splash-proof and water-resistant, thanks to the precision manufacturing. Record special memories anytime and anywhere.<\/span><\/li>\r\n \t<li class=\"a-spacing-mini\"><span class=\"a-list-item\">Leica main camera with professional optical lens Captures every great moment<\/span><\/li>\r\n \t<li class=\"a-spacing-mini\"><span class=\"a-list-item\">Masterpiece performance Leading Snapdragon 8 Gen 2 Boosted performance, reduced consumption<\/span><\/li>\r\n<\/ul>","post_title":"Xiaomi 13","post_excerpt":"","post_status":"publish","comment_status":"open","ping_status":"closed","post_password":"","post_name":"%d0%ba%d1%80%d0%be%d1%81%d1%81%d0%be%d0%b2%d0%ba%d0%b8","to_ping":"","pinged":"","post_modified":"2024-01-01 12:03:20","post_modified_gmt":"2024-01-01 09:03:20","post_content_filtered":"","post_parent":0,"guid":"http:\/\/wordpress\/?post_type=product&#038;p=17","menu_order":0,"post_type":"product","post_mime_type":"","comment_count":"0","filter":"raw"},{"ID":20,"post_author":"1","post_date":"2023-12-29 11:32:59","post_date_gmt":"2023-12-29 08:32:59","post_content":"","post_title":"Xiaomi Redmi 12 128GB - Black - Unlocked - Dual-SIM","post_excerpt":"","post_status":"publish","comment_status":"open","ping_status":"closed","post_password":"","post_name":"xiaomi-12-black","to_ping":"","pinged":"","post_modified":"2023-12-29 11:45:27","post_modified_gmt":"2023-12-29 08:45:27","post_content_filtered":"","post_parent":0,"guid":"http:\/\/wordpress\/?post_type=product&#038;p=20","menu_order":0,"post_type":"product","post_mime_type":"","comment_count":"0","filter":"raw"}]
INFO:llama_index.indices.loading:Loading indices with ids: ['vector_index']
DEBUG:openai:message='Request to OpenAI API' method=post path=https://api.openai.com/v1/embeddings
DEBUG:openai:api_version=None data='{"input": ["hello do you have samsung smartphones"], "model": "text-embedding-ada-002", "encoding_format": "base64"}' message='Post details'
DEBUG:urllib3.util.retry:Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.openai.com:443
DEBUG:urllib3.connectionpool:https://api.openai.com:443 "POST /v1/embeddings HTTP/1.1" 200 None
DEBUG:openai:message='OpenAI API response' path=https://api.openai.com/v1/embeddings processing_ms=31 request_id=1532c7bb42855d9412f9c5df8851c709 response_code=200
DEBUG:llama_index.indices.utils:> Top 1 nodes:
> [Node 909c5dd5-e87e-4999-a794-761f96e44168] [Similarity score:             -0.0274845] Welcome to TechHub, your ultimate destination for cutting-edge technology and innovation! At Tech...
DEBUG:openai:message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
DEBUG:openai:api_version=None data='{"messages": [{"role": "system", "content": "Context information is below.\\n--------------------\\nWelcome to TechHub, your ultimate destination for cutting-edge technology and innovation! At TechHub, we pride ourselves on being a premier online store dedicated to providing a curated selection of the latest and greatest in tech gadgets, including laptops, smartphones, and more.\\n\\nAbout Us:\\n\\nAt the heart of TechHub is a passion for technology and a commitment to delivering top-notch products that seamlessly blend style, functionality, and performance. With a team of tech enthusiasts, we understand the ever-evolving nature of the digital landscape and strive to stay at the forefront of the latest trends and advancements.\\n\\nOur Mission:\\n\\nOur mission at TechHub is to empower our customers with the best tools and devices that enhance their digital lifestyle. Whether you\'re a professional looking for a high-performance laptop to boost productivity or a smartphone aficionado seeking the latest flagship model, we\'ve got you covered. We believe that technology should not only meet but exceed your expectations, making every interaction with your devices a seamless and enjoyable experience.\\n\\nQuality Assurance:\\n\\nTechHub is committed to delivering products of the highest quality. We carefully curate our inventory, partnering with leading brands known for their commitment to excellence. Each product undergoes rigorous testing to ensure reliability, durability, and top-notch performance. Our dedication to quality assurance is reflected in every item we offer.\\n\\nCustomer-Centric Approach:\\n\\nAt TechHub, our customers are at the core of everything we do. We prioritize your satisfaction and strive to provide an unparalleled shopping experience. Our customer support team is ready to assist you at every step, from product inquiries to after-sales support. We value your feedback and continuously work to improve our services based on your needs.\\n\\nSecure Shopping:\\n\\nYour online security is our priority. TechHub employs state-of-the-art encryption technology to ensure that your personal information remains secure and protected. Shop with confidence, knowing that your data is in safe hands.\\n\\nExplore the world of innovation at TechHub, where technology meets lifestyle. Discover the perfect blend of style and functionality with our carefully curated selection of laptops, smartphones, and other cutting-edge gadgets. Join us on this exciting journey, and let\'s embrace the future together!\\n--------------------\\n\\u0412\\u044b \\u2014 \\u0418\\u0418 \\u0430\\u0441\\u0441\\u0438\\u0441\\u0442\\u0435\\u043d\\u0442 \\u043a\\u043e\\u043c\\u043f\\u0430\\u043d\\u0438\\u0438. \\u0412\\u0430\\u043c \\u0431\\u0443\\u0434\\u0443\\u0442 \\u0437\\u0430\\u0434\\u0430\\u043d\\u044b \\u0432\\u043e\\u043f\\u0440\\u043e\\u0441\\u044b \\u043e \\u043d\\u0430\\u0448\\u0435\\u0439 \\u043a\\u043e\\u043c\\u043f\\u0430\\u043d\\u0438\\u0438. \\u0412\\u0435\\u0436\\u043b\\u0438\\u0432\\u043e \\u043e\\u0442\\u0432\\u0435\\u0447\\u0430\\u0439\\u0442\\u0435 \\u043d\\u0430 \\u0432\\u043e\\u043f\\u0440\\u043e\\u0441\\u044b.\\r\\n    \\u041d\\u0438\\u0436\\u0435 \\u043c\\u044b \\u043f\\u0440\\u0435\\u0434\\u043e\\u0441\\u0442\\u0430\\u0432\\u0438\\u043b\\u0438 \\u043a\\u043e\\u043d\\u0442\\u0435\\u043a\\u0441\\u0442\\u043d\\u0443\\u044e \\u0438\\u043d\\u0444\\u043e\\u0440\\u043c\\u0430\\u0446\\u0438\\u044e.\\r\\n    ---------------------\\r\\n    {context_str}\\r\\n    ---------------------\\r\\n    \\u0423\\u0447\\u0438\\u0442\\u044b\\u0432\\u0430\\u044f \\u044d\\u0442\\u0443 \\u0438\\u043d\\u0444\\u043e\\u0440\\u043c\\u0430\\u0446\\u0438\\u044e, \\u043e\\u0442\\u0432\\u0435\\u0442\\u044c\\u0442\\u0435, \\u043f\\u043e\\u0436\\u0430\\u043b\\u0443\\u0439\\u0441\\u0442\\u0430, \\u043d\\u0430 \\u0432\\u043e\\u043f\\u0440\\u043e\\u0441: {query_str}\\r\\n    \\n History of conversation with the client: None. \\n Information about relative products Unfortunately i cant find product \'samsung\'. But please checkout our similar products: \\n[{\\"ID\\":17,\\"post_author\\":\\"1\\",\\"post_date\\":\\"2023-12-27 20:25:46\\",\\"post_date_gmt\\":\\"2023-12-27 17:25:46\\",\\"post_content\\":\\"<ul class=\\\\\\"a-unordered-list a-vertical a-spacing-mini\\\\\\">\\\\r\\\\n \\\\t<li class=\\\\\\"a-spacing-mini\\\\\\"><span class=\\\\\\"a-list-item\\\\\\">Ultra-immersive display design Light up the screen to enjoy an unrivalled experience. The 1.61mm ultra-thin bezels offer a boundless vision.<\\\\/span><\\\\/li>\\\\r\\\\n \\\\t<li class=\\\\\\"a-spacing-mini\\\\\\"><span class=\\\\\\"a-list-item\\\\\\">Built for more scenarios IP68 water and dust resistant* Born splash-proof and water-resistant, thanks to the precision manufacturing. Record special memories anytime and anywhere.<\\\\/span><\\\\/li>\\\\r\\\\n \\\\t<li class=\\\\\\"a-spacing-mini\\\\\\"><span class=\\\\\\"a-list-item\\\\\\">Leica main camera with professional optical lens Captures every great moment<\\\\/span><\\\\/li>\\\\r\\\\n \\\\t<li class=\\\\\\"a-spacing-mini\\\\\\"><span class=\\\\\\"a-list-item\\\\\\">Masterpiece performance Leading Snapdragon 8 Gen 2 Boosted performance, reduced consumption<\\\\/span><\\\\/li>\\\\r\\\\n<\\\\/ul>\\",\\"post_title\\":\\"Xiaomi 13\\",\\"post_excerpt\\":\\"\\",\\"post_status\\":\\"publish\\",\\"comment_status\\":\\"open\\",\\"ping_status\\":\\"closed\\",\\"post_password\\":\\"\\",\\"post_name\\":\\"%d0%ba%d1%80%d0%be%d1%81%d1%81%d0%be%d0%b2%d0%ba%d0%b8\\",\\"to_ping\\":\\"\\",\\"pinged\\":\\"\\",\\"post_modified\\":\\"2024-01-01 12:03:20\\",\\"post_modified_gmt\\":\\"2024-01-01 09:03:20\\",\\"post_content_filtered\\":\\"\\",\\"post_parent\\":0,\\"guid\\":\\"http:\\\\/\\\\/wordpress\\\\/?post_type=product&#038;p=17\\",\\"menu_order\\":0,\\"post_type\\":\\"product\\",\\"post_mime_type\\":\\"\\",\\"comment_count\\":\\"0\\",\\"filter\\":\\"raw\\"},{\\"ID\\":20,\\"post_author\\":\\"1\\",\\"post_date\\":\\"2023-12-29 11:32:59\\",\\"post_date_gmt\\":\\"2023-12-29 08:32:59\\",\\"post_content\\":\\"\\",\\"post_title\\":\\"Xiaomi Redmi 12 128GB - Black - Unlocked - Dual-SIM\\",\\"post_excerpt\\":\\"\\",\\"post_status\\":\\"publish\\",\\"comment_status\\":\\"open\\",\\"ping_status\\":\\"closed\\",\\"post_password\\":\\"\\",\\"post_name\\":\\"xiaomi-12-black\\",\\"to_ping\\":\\"\\",\\"pinged\\":\\"\\",\\"post_modified\\":\\"2023-12-29 11:45:27\\",\\"post_modified_gmt\\":\\"2023-12-29 08:45:27\\",\\"post_content_filtered\\":\\"\\",\\"post_parent\\":0,\\"guid\\":\\"http:\\\\/\\\\/wordpress\\\\/?post_type=product&#038;p=20\\",\\"menu_order\\":0,\\"post_type\\":\\"product\\",\\"post_mime_type\\":\\"\\",\\"comment_count\\":\\"0\\",\\"filter\\":\\"raw\\"}]"}, {"role": "user", "content": "hello do you have samsung smartphones"}], "stream": false, "model": "gpt-3.5-turbo", "temperature": 0, "max_tokens": null}' message='Post details'
DEBUG:urllib3.connectionpool:https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
DEBUG:openai:message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=1678 request_id=beeac96888d7350c71d7c9438dd8aebb response_code=200
INFO:myapp:{'api': 1, 'product_data': 'http://wordpress/wp-json/chatty/v1', 'website': 'asdf', 'id': 4, 'left_tokens': 78266, 'description': None, 'temperature': Decimal('0.00'), 'model': 'gpt-3.5-turbo', 'prompt': 'Вы — ИИ ассистент компании. Вам будут заданы вопросы о нашей компании. Вежливо отвечайте на вопросы.\r\n    Ниже мы предоставили контекстную информацию.\r\n    ---------------------\r\n    {context_str}\r\n    ---------------------\r\n    Учитывая эту информацию, ответьте, пожалуйста, на вопрос: {query_str}\r\n    ', 'response_mode': 'compact', 'user_id': 12, 'answer': None, 'context': None}
DEBUG:root:This is a debug message
DEBUG:celery.utils.functional:
def send_chat_request(user_id, project_id, session, total_tokens, answer, context):
    return 1

INFO:werkzeug:127.0.0.1 - - [01/Jan/2024 20:41:40] "POST /projects/e47f0f811145d03c33fd6639dc3f09c0839d0891e264d849a75df04f4d047625/KW2uCtbdOgV3cltg8W3i6JbZcQWtfy9j HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [01/Jan/2024 20:41:55] "OPTIONS /projects/e47f0f811145d03c33fd6639dc3f09c0839d0891e264d849a75df04f4d047625/KW2uCtbdOgV3cltg8W3i6JbZcQWtfy9j HTTP/1.1" 200 -
INFO:myapp:{'api': 1, 'product_data': 'http://wordpress/wp-json/chatty/v1', 'website': 'asdf', 'id': 4, 'left_tokens': 77009, 'description': None, 'temperature': Decimal('0.00'), 'model': 'gpt-3.5-turbo', 'prompt': 'Вы — ИИ ассистент компании. Вам будут заданы вопросы о нашей компании. Вежливо отвечайте на вопросы.\r\n    Ниже мы предоставили контекстную информацию.\r\n    ---------------------\r\n    {context_str}\r\n    ---------------------\r\n    Учитывая эту информацию, ответьте, пожалуйста, на вопрос: {query_str}\r\n    ', 'response_mode': 'compact', 'user_id': 12, 'answer': "Client: hello do you have samsung smartphones,\nAi response: I apologize, but we currently do not have any Samsung smartphones available. However, we do have a wide range of other smartphones from different brands that you might be interested in. Please let me know if you would like information about any specific brand or model, and I'll be happy to assist you.", 'context': 'Unfortunately i cant find product \'samsung\'. But please checkout our similar products: \n[{"ID":17,"post_author":"1","post_date":"2023-12-27 20:25:46","post_date_gmt":"2023-12-27 17:25:46","post_content":"<ul class=\\"a-unordered-list a-vertical a-spacing-mini\\">\\r\\n \\t<li class=\\"a-spacing-mini\\"><span class=\\"a-list-item\\">Ultra-immersive display design Light up the screen to enjoy an unrivalled experience. The 1.61mm ultra-thin bezels offer a boundless vision.<\\/span><\\/li>\\r\\n \\t<li class=\\"a-spacing-mini\\"><span class=\\"a-list-item\\">Built for more scenarios IP68 water and dust resistant* Born splash-proof and water-resistant, thanks to the precision manufacturing. Record special memories anytime and anywhere.<\\/span><\\/li>\\r\\n \\t<li class=\\"a-spacing-mini\\"><span class=\\"a-list-item\\">Leica main camera with professional optical lens Captures every great moment<\\/span><\\/li>\\r\\n \\t<li class=\\"a-spacing-mini\\"><span class=\\"a-list-item\\">Masterpiece performance Leading Snapdragon 8 Gen 2 Boosted performance, reduced consumption<\\/span><\\/li>\\r\\n<\\/ul>","post_title":"Xiaomi 13","post_excerpt":"","post_status":"publish","comment_status":"open","ping_status":"closed","post_password":"","post_name":"%d0%ba%d1%80%d0%be%d1%81%d1%81%d0%be%d0%b2%d0%ba%d0%b8","to_ping":"","pinged":"","post_modified":"2024-01-01 12:03:20","post_modified_gmt":"2024-01-01 09:03:20","post_content_filtered":"","post_parent":0,"guid":"http:\\/\\/wordpress\\/?post_type=product&#038;p=17","menu_order":0,"post_type":"product","post_mime_type":"","comment_count":"0","filter":"raw"},{"ID":20,"post_author":"1","post_date":"2023-12-29 11:32:59","post_date_gmt":"2023-12-29 08:32:59","post_content":"","post_title":"Xiaomi Redmi 12 128GB - Black - Unlocked - Dual-SIM","post_excerpt":"","post_status":"publish","comment_status":"open","ping_status":"closed","post_password":"","post_name":"xiaomi-12-black","to_ping":"","pinged":"","post_modified":"2023-12-29 11:45:27","post_modified_gmt":"2023-12-29 08:45:27","post_content_filtered":"","post_parent":0,"guid":"http:\\/\\/wordpress\\/?post_type=product&#038;p=20","menu_order":0,"post_type":"product","post_mime_type":"","comment_count":"0","filter":"raw"}]'}
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): wordpress:80
DEBUG:urllib3.connectionpool:http://wordpress:80 "GET /wp-json/chatty/v1/shop_meta HTTP/1.1" 200 67
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.openai.com:443
DEBUG:urllib3.connectionpool:https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
INFO:myapp:[{'is_related': 'no'}]
INFO:myapp:None
INFO:myapp:prompt
INFO:myapp:You are AI assistant for a online shop. You should determine if a client is asking or information about a product in our store. It can be a question about price, availability in stock, product characteristic, comparing 2 products. In this case you should contruct query parameters based on a client question. Construct them for every mentioned product. Add sort_price parameter if required .For example product_name=item_name&color=green&size=44&sort_price=desc|asc List of available query parameters: product_name, color. product_name is a required parameter. You should use it in every query.Use only these query parameters for consructing. Add a category. List of available categories: laptops,smartphones. Write your asnwer as array of json objects. [{url_params: <url_here>, is_related: 'yes', category: <category_here> }] If the question is not related to products of the store, then your answer would be [{is_related: 'no'}] Be strict. Fix typos in product names. Dont write anything else. Your answer will be used for a next query. Client question: ok, recommend me something .Your answer:
DEBUG:llama_index.storage.kvstore.simple_kvstore:Loading llama_index.storage.kvstore.simple_kvstore from projects/4/data\docstore.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/docstore.json
DEBUG:llama_index.storage.kvstore.simple_kvstore:Loading llama_index.storage.kvstore.simple_kvstore from projects/4/data\index_store.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/index_store.json
DEBUG:llama_index.vector_stores.simple:Loading llama_index.vector_stores.simple from projects/4/data\vector_store.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/vector_store.json
DEBUG:llama_index.graph_stores.simple:Loading llama_index.graph_stores.simple from projects/4/data\graph_store.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/graph_store.json
INFO:myapp:Final prompt: Вы — ИИ ассистент компании. Вам будут заданы вопросы о нашей компании. Вежливо отвечайте на вопросы.
    Ниже мы предоставили контекстную информацию.
    ---------------------
    {context_str}
    ---------------------
    Учитывая эту информацию, ответьте, пожалуйста, на вопрос: {query_str}
    
 History of conversation with the client: Client: hello do you have samsung smartphones,
Ai response: I apologize, but we currently do not have any Samsung smartphones available. However, we do have a wide range of other smartphones from different brands that you might be interested in. Please let me know if you would like information about any specific brand or model, and I'll be happy to assist you.. 
 Information about relative products Unfortunately i cant find product 'samsung'. But please checkout our similar products: 
[{"ID":17,"post_author":"1","post_date":"2023-12-27 20:25:46","post_date_gmt":"2023-12-27 17:25:46","post_content":"<ul class=\"a-unordered-list a-vertical a-spacing-mini\">\r\n \t<li class=\"a-spacing-mini\"><span class=\"a-list-item\">Ultra-immersive display design Light up the screen to enjoy an unrivalled experience. The 1.61mm ultra-thin bezels offer a boundless vision.<\/span><\/li>\r\n \t<li class=\"a-spacing-mini\"><span class=\"a-list-item\">Built for more scenarios IP68 water and dust resistant* Born splash-proof and water-resistant, thanks to the precision manufacturing. Record special memories anytime and anywhere.<\/span><\/li>\r\n \t<li class=\"a-spacing-mini\"><span class=\"a-list-item\">Leica main camera with professional optical lens Captures every great moment<\/span><\/li>\r\n \t<li class=\"a-spacing-mini\"><span class=\"a-list-item\">Masterpiece performance Leading Snapdragon 8 Gen 2 Boosted performance, reduced consumption<\/span><\/li>\r\n<\/ul>","post_title":"Xiaomi 13","post_excerpt":"","post_status":"publish","comment_status":"open","ping_status":"closed","post_password":"","post_name":"%d0%ba%d1%80%d0%be%d1%81%d1%81%d0%be%d0%b2%d0%ba%d0%b8","to_ping":"","pinged":"","post_modified":"2024-01-01 12:03:20","post_modified_gmt":"2024-01-01 09:03:20","post_content_filtered":"","post_parent":0,"guid":"http:\/\/wordpress\/?post_type=product&#038;p=17","menu_order":0,"post_type":"product","post_mime_type":"","comment_count":"0","filter":"raw"},{"ID":20,"post_author":"1","post_date":"2023-12-29 11:32:59","post_date_gmt":"2023-12-29 08:32:59","post_content":"","post_title":"Xiaomi Redmi 12 128GB - Black - Unlocked - Dual-SIM","post_excerpt":"","post_status":"publish","comment_status":"open","ping_status":"closed","post_password":"","post_name":"xiaomi-12-black","to_ping":"","pinged":"","post_modified":"2023-12-29 11:45:27","post_modified_gmt":"2023-12-29 08:45:27","post_content_filtered":"","post_parent":0,"guid":"http:\/\/wordpress\/?post_type=product&#038;p=20","menu_order":0,"post_type":"product","post_mime_type":"","comment_count":"0","filter":"raw"}]
INFO:llama_index.indices.loading:Loading indices with ids: ['vector_index']
DEBUG:openai:message='Request to OpenAI API' method=post path=https://api.openai.com/v1/embeddings
DEBUG:openai:api_version=None data='{"input": ["ok, recommend me something"], "model": "text-embedding-ada-002", "encoding_format": "base64"}' message='Post details'
DEBUG:urllib3.util.retry:Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.openai.com:443
DEBUG:urllib3.connectionpool:https://api.openai.com:443 "POST /v1/embeddings HTTP/1.1" 200 None
DEBUG:openai:message='OpenAI API response' path=https://api.openai.com/v1/embeddings processing_ms=26 request_id=cb61982ff2b0fc8a18dc60817b641fcd response_code=200
DEBUG:llama_index.indices.utils:> Top 1 nodes:
> [Node 909c5dd5-e87e-4999-a794-761f96e44168] [Similarity score:             -0.027379] Welcome to TechHub, your ultimate destination for cutting-edge technology and innovation! At Tech...
DEBUG:openai:message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
DEBUG:openai:api_version=None data='{"messages": [{"role": "system", "content": "Context information is below.\\n--------------------\\nWelcome to TechHub, your ultimate destination for cutting-edge technology and innovation! At TechHub, we pride ourselves on being a premier online store dedicated to providing a curated selection of the latest and greatest in tech gadgets, including laptops, smartphones, and more.\\n\\nAbout Us:\\n\\nAt the heart of TechHub is a passion for technology and a commitment to delivering top-notch products that seamlessly blend style, functionality, and performance. With a team of tech enthusiasts, we understand the ever-evolving nature of the digital landscape and strive to stay at the forefront of the latest trends and advancements.\\n\\nOur Mission:\\n\\nOur mission at TechHub is to empower our customers with the best tools and devices that enhance their digital lifestyle. Whether you\'re a professional looking for a high-performance laptop to boost productivity or a smartphone aficionado seeking the latest flagship model, we\'ve got you covered. We believe that technology should not only meet but exceed your expectations, making every interaction with your devices a seamless and enjoyable experience.\\n\\nQuality Assurance:\\n\\nTechHub is committed to delivering products of the highest quality. We carefully curate our inventory, partnering with leading brands known for their commitment to excellence. Each product undergoes rigorous testing to ensure reliability, durability, and top-notch performance. Our dedication to quality assurance is reflected in every item we offer.\\n\\nCustomer-Centric Approach:\\n\\nAt TechHub, our customers are at the core of everything we do. We prioritize your satisfaction and strive to provide an unparalleled shopping experience. Our customer support team is ready to assist you at every step, from product inquiries to after-sales support. We value your feedback and continuously work to improve our services based on your needs.\\n\\nSecure Shopping:\\n\\nYour online security is our priority. TechHub employs state-of-the-art encryption technology to ensure that your personal information remains secure and protected. Shop with confidence, knowing that your data is in safe hands.\\n\\nExplore the world of innovation at TechHub, where technology meets lifestyle. Discover the perfect blend of style and functionality with our carefully curated selection of laptops, smartphones, and other cutting-edge gadgets. Join us on this exciting journey, and let\'s embrace the future together!\\n--------------------\\n\\u0412\\u044b \\u2014 \\u0418\\u0418 \\u0430\\u0441\\u0441\\u0438\\u0441\\u0442\\u0435\\u043d\\u0442 \\u043a\\u043e\\u043c\\u043f\\u0430\\u043d\\u0438\\u0438. \\u0412\\u0430\\u043c \\u0431\\u0443\\u0434\\u0443\\u0442 \\u0437\\u0430\\u0434\\u0430\\u043d\\u044b \\u0432\\u043e\\u043f\\u0440\\u043e\\u0441\\u044b \\u043e \\u043d\\u0430\\u0448\\u0435\\u0439 \\u043a\\u043e\\u043c\\u043f\\u0430\\u043d\\u0438\\u0438. \\u0412\\u0435\\u0436\\u043b\\u0438\\u0432\\u043e \\u043e\\u0442\\u0432\\u0435\\u0447\\u0430\\u0439\\u0442\\u0435 \\u043d\\u0430 \\u0432\\u043e\\u043f\\u0440\\u043e\\u0441\\u044b.\\r\\n    \\u041d\\u0438\\u0436\\u0435 \\u043c\\u044b \\u043f\\u0440\\u0435\\u0434\\u043e\\u0441\\u0442\\u0430\\u0432\\u0438\\u043b\\u0438 \\u043a\\u043e\\u043d\\u0442\\u0435\\u043a\\u0441\\u0442\\u043d\\u0443\\u044e \\u0438\\u043d\\u0444\\u043e\\u0440\\u043c\\u0430\\u0446\\u0438\\u044e.\\r\\n    ---------------------\\r\\n    {context_str}\\r\\n    ---------------------\\r\\n    \\u0423\\u0447\\u0438\\u0442\\u044b\\u0432\\u0430\\u044f \\u044d\\u0442\\u0443 \\u0438\\u043d\\u0444\\u043e\\u0440\\u043c\\u0430\\u0446\\u0438\\u044e, \\u043e\\u0442\\u0432\\u0435\\u0442\\u044c\\u0442\\u0435, \\u043f\\u043e\\u0436\\u0430\\u043b\\u0443\\u0439\\u0441\\u0442\\u0430, \\u043d\\u0430 \\u0432\\u043e\\u043f\\u0440\\u043e\\u0441: {query_str}\\r\\n    \\n History of conversation with the client: Client: hello do you have samsung smartphones,\\nAi response: I apologize, but we currently do not have any Samsung smartphones available. However, we do have a wide range of other smartphones from different brands that you might be interested in. Please let me know if you would like information about any specific brand or model, and I\'ll be happy to assist you.. \\n Information about relative products Unfortunately i cant find product \'samsung\'. But please checkout our similar products: \\n[{\\"ID\\":17,\\"post_author\\":\\"1\\",\\"post_date\\":\\"2023-12-27 20:25:46\\",\\"post_date_gmt\\":\\"2023-12-27 17:25:46\\",\\"post_content\\":\\"<ul class=\\\\\\"a-unordered-list a-vertical a-spacing-mini\\\\\\">\\\\r\\\\n \\\\t<li class=\\\\\\"a-spacing-mini\\\\\\"><span class=\\\\\\"a-list-item\\\\\\">Ultra-immersive display design Light up the screen to enjoy an unrivalled experience. The 1.61mm ultra-thin bezels offer a boundless vision.<\\\\/span><\\\\/li>\\\\r\\\\n \\\\t<li class=\\\\\\"a-spacing-mini\\\\\\"><span class=\\\\\\"a-list-item\\\\\\">Built for more scenarios IP68 water and dust resistant* Born splash-proof and water-resistant, thanks to the precision manufacturing. Record special memories anytime and anywhere.<\\\\/span><\\\\/li>\\\\r\\\\n \\\\t<li class=\\\\\\"a-spacing-mini\\\\\\"><span class=\\\\\\"a-list-item\\\\\\">Leica main camera with professional optical lens Captures every great moment<\\\\/span><\\\\/li>\\\\r\\\\n \\\\t<li class=\\\\\\"a-spacing-mini\\\\\\"><span class=\\\\\\"a-list-item\\\\\\">Masterpiece performance Leading Snapdragon 8 Gen 2 Boosted performance, reduced consumption<\\\\/span><\\\\/li>\\\\r\\\\n<\\\\/ul>\\",\\"post_title\\":\\"Xiaomi 13\\",\\"post_excerpt\\":\\"\\",\\"post_status\\":\\"publish\\",\\"comment_status\\":\\"open\\",\\"ping_status\\":\\"closed\\",\\"post_password\\":\\"\\",\\"post_name\\":\\"%d0%ba%d1%80%d0%be%d1%81%d1%81%d0%be%d0%b2%d0%ba%d0%b8\\",\\"to_ping\\":\\"\\",\\"pinged\\":\\"\\",\\"post_modified\\":\\"2024-01-01 12:03:20\\",\\"post_modified_gmt\\":\\"2024-01-01 09:03:20\\",\\"post_content_filtered\\":\\"\\",\\"post_parent\\":0,\\"guid\\":\\"http:\\\\/\\\\/wordpress\\\\/?post_type=product&#038;p=17\\",\\"menu_order\\":0,\\"post_type\\":\\"product\\",\\"post_mime_type\\":\\"\\",\\"comment_count\\":\\"0\\",\\"filter\\":\\"raw\\"},{\\"ID\\":20,\\"post_author\\":\\"1\\",\\"post_date\\":\\"2023-12-29 11:32:59\\",\\"post_date_gmt\\":\\"2023-12-29 08:32:59\\",\\"post_content\\":\\"\\",\\"post_title\\":\\"Xiaomi Redmi 12 128GB - Black - Unlocked - Dual-SIM\\",\\"post_excerpt\\":\\"\\",\\"post_status\\":\\"publish\\",\\"comment_status\\":\\"open\\",\\"ping_status\\":\\"closed\\",\\"post_password\\":\\"\\",\\"post_name\\":\\"xiaomi-12-black\\",\\"to_ping\\":\\"\\",\\"pinged\\":\\"\\",\\"post_modified\\":\\"2023-12-29 11:45:27\\",\\"post_modified_gmt\\":\\"2023-12-29 08:45:27\\",\\"post_content_filtered\\":\\"\\",\\"post_parent\\":0,\\"guid\\":\\"http:\\\\/\\\\/wordpress\\\\/?post_type=product&#038;p=20\\",\\"menu_order\\":0,\\"post_type\\":\\"product\\",\\"post_mime_type\\":\\"\\",\\"comment_count\\":\\"0\\",\\"filter\\":\\"raw\\"}]"}, {"role": "user", "content": "ok, recommend me something"}], "stream": false, "model": "gpt-3.5-turbo", "temperature": 0, "max_tokens": null}' message='Post details'
DEBUG:urllib3.connectionpool:https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
DEBUG:openai:message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=5367 request_id=c653bec6f016857e7bbe4a978f972d26 response_code=200
INFO:myapp:{'api': 1, 'product_data': 'http://wordpress/wp-json/chatty/v1', 'website': 'asdf', 'id': 4, 'left_tokens': 77009, 'description': None, 'temperature': Decimal('0.00'), 'model': 'gpt-3.5-turbo', 'prompt': 'Вы — ИИ ассистент компании. Вам будут заданы вопросы о нашей компании. Вежливо отвечайте на вопросы.\r\n    Ниже мы предоставили контекстную информацию.\r\n    ---------------------\r\n    {context_str}\r\n    ---------------------\r\n    Учитывая эту информацию, ответьте, пожалуйста, на вопрос: {query_str}\r\n    ', 'response_mode': 'compact', 'user_id': 12, 'answer': "Client: hello do you have samsung smartphones,\nAi response: I apologize, but we currently do not have any Samsung smartphones available. However, we do have a wide range of other smartphones from different brands that you might be interested in. Please let me know if you would like information about any specific brand or model, and I'll be happy to assist you.", 'context': 'Unfortunately i cant find product \'samsung\'. But please checkout our similar products: \n[{"ID":17,"post_author":"1","post_date":"2023-12-27 20:25:46","post_date_gmt":"2023-12-27 17:25:46","post_content":"<ul class=\\"a-unordered-list a-vertical a-spacing-mini\\">\\r\\n \\t<li class=\\"a-spacing-mini\\"><span class=\\"a-list-item\\">Ultra-immersive display design Light up the screen to enjoy an unrivalled experience. The 1.61mm ultra-thin bezels offer a boundless vision.<\\/span><\\/li>\\r\\n \\t<li class=\\"a-spacing-mini\\"><span class=\\"a-list-item\\">Built for more scenarios IP68 water and dust resistant* Born splash-proof and water-resistant, thanks to the precision manufacturing. Record special memories anytime and anywhere.<\\/span><\\/li>\\r\\n \\t<li class=\\"a-spacing-mini\\"><span class=\\"a-list-item\\">Leica main camera with professional optical lens Captures every great moment<\\/span><\\/li>\\r\\n \\t<li class=\\"a-spacing-mini\\"><span class=\\"a-list-item\\">Masterpiece performance Leading Snapdragon 8 Gen 2 Boosted performance, reduced consumption<\\/span><\\/li>\\r\\n<\\/ul>","post_title":"Xiaomi 13","post_excerpt":"","post_status":"publish","comment_status":"open","ping_status":"closed","post_password":"","post_name":"%d0%ba%d1%80%d0%be%d1%81%d1%81%d0%be%d0%b2%d0%ba%d0%b8","to_ping":"","pinged":"","post_modified":"2024-01-01 12:03:20","post_modified_gmt":"2024-01-01 09:03:20","post_content_filtered":"","post_parent":0,"guid":"http:\\/\\/wordpress\\/?post_type=product&#038;p=17","menu_order":0,"post_type":"product","post_mime_type":"","comment_count":"0","filter":"raw"},{"ID":20,"post_author":"1","post_date":"2023-12-29 11:32:59","post_date_gmt":"2023-12-29 08:32:59","post_content":"","post_title":"Xiaomi Redmi 12 128GB - Black - Unlocked - Dual-SIM","post_excerpt":"","post_status":"publish","comment_status":"open","ping_status":"closed","post_password":"","post_name":"xiaomi-12-black","to_ping":"","pinged":"","post_modified":"2023-12-29 11:45:27","post_modified_gmt":"2023-12-29 08:45:27","post_content_filtered":"","post_parent":0,"guid":"http:\\/\\/wordpress\\/?post_type=product&#038;p=20","menu_order":0,"post_type":"product","post_mime_type":"","comment_count":"0","filter":"raw"}]'}
INFO:werkzeug:127.0.0.1 - - [01/Jan/2024 20:42:03] "POST /projects/e47f0f811145d03c33fd6639dc3f09c0839d0891e264d849a75df04f4d047625/KW2uCtbdOgV3cltg8W3i6JbZcQWtfy9j HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [01/Jan/2024 20:42:32] "OPTIONS /projects/e47f0f811145d03c33fd6639dc3f09c0839d0891e264d849a75df04f4d047625/KW2uCtbdOgV3cltg8W3i6JbZcQWtfy9j HTTP/1.1" 200 -
INFO:myapp:{'api': 1, 'product_data': 'http://wordpress/wp-json/chatty/v1', 'website': 'asdf', 'id': 4, 'left_tokens': 75534, 'description': None, 'temperature': Decimal('0.00'), 'model': 'gpt-3.5-turbo', 'prompt': 'Вы — ИИ ассистент компании. Вам будут заданы вопросы о нашей компании. Вежливо отвечайте на вопросы.\r\n    Ниже мы предоставили контекстную информацию.\r\n    ---------------------\r\n    {context_str}\r\n    ---------------------\r\n    Учитывая эту информацию, ответьте, пожалуйста, на вопрос: {query_str}\r\n    ', 'response_mode': 'compact', 'user_id': 12, 'answer': "Client: hello do you have samsung smartphones,\nAi response: I apologize, but we currently do not have any Samsung smartphones available. However, we do have a wide range of other smartphones from different brands that you might be interested in. Please let me know if you would like information about any specific brand or model, and I'll be happy to assist you.\r\nClient: ok, recommend me something,\nAi response: Certainly! Based on your interest in Samsung smartphones, I apologize for not having any Samsung smartphones available at the moment. However, I can recommend some alternative options that you might be interested in:\n\n1. Xiaomi 13: This smartphone offers an ultra-immersive display design with 1.61mm ultra-thin bezels, providing a boundless vision. It is also IP68 water and dust resistant, making it suitable for various scenarios. The Leica main camera with a professional optical lens ensures capturing great moments, and the device is powered by the leading Snapdragon 8 Gen 2 for excellent performance. \n\n2. Xiaomi Redmi 12 128GB - Black - Unlocked - Dual-SIM: This smartphone features a large storage capacity of 128GB, allowing you to store all your files and media. It is unlocked and supports dual-SIM functionality, providing flexibility in using multiple networks. \n\nPlease let me know if you would like more information about any of these options or if there's anything else I can assist you with!", 'context': 'Unfortunately i cant find product \'samsung\'. But please checkout our similar products: \n[{"ID":17,"post_author":"1","post_date":"2023-12-27 20:25:46","post_date_gmt":"2023-12-27 17:25:46","post_content":"<ul class=\\"a-unordered-list a-vertical a-spacing-mini\\">\\r\\n \\t<li class=\\"a-spacing-mini\\"><span class=\\"a-list-item\\">Ultra-immersive display design Light up the screen to enjoy an unrivalled experience. The 1.61mm ultra-thin bezels offer a boundless vision.<\\/span><\\/li>\\r\\n \\t<li class=\\"a-spacing-mini\\"><span class=\\"a-list-item\\">Built for more scenarios IP68 water and dust resistant* Born splash-proof and water-resistant, thanks to the precision manufacturing. Record special memories anytime and anywhere.<\\/span><\\/li>\\r\\n \\t<li class=\\"a-spacing-mini\\"><span class=\\"a-list-item\\">Leica main camera with professional optical lens Captures every great moment<\\/span><\\/li>\\r\\n \\t<li class=\\"a-spacing-mini\\"><span class=\\"a-list-item\\">Masterpiece performance Leading Snapdragon 8 Gen 2 Boosted performance, reduced consumption<\\/span><\\/li>\\r\\n<\\/ul>","post_title":"Xiaomi 13","post_excerpt":"","post_status":"publish","comment_status":"open","ping_status":"closed","post_password":"","post_name":"%d0%ba%d1%80%d0%be%d1%81%d1%81%d0%be%d0%b2%d0%ba%d0%b8","to_ping":"","pinged":"","post_modified":"2024-01-01 12:03:20","post_modified_gmt":"2024-01-01 09:03:20","post_content_filtered":"","post_parent":0,"guid":"http:\\/\\/wordpress\\/?post_type=product&#038;p=17","menu_order":0,"post_type":"product","post_mime_type":"","comment_count":"0","filter":"raw"},{"ID":20,"post_author":"1","post_date":"2023-12-29 11:32:59","post_date_gmt":"2023-12-29 08:32:59","post_content":"","post_title":"Xiaomi Redmi 12 128GB - Black - Unlocked - Dual-SIM","post_excerpt":"","post_status":"publish","comment_status":"open","ping_status":"closed","post_password":"","post_name":"xiaomi-12-black","to_ping":"","pinged":"","post_modified":"2023-12-29 11:45:27","post_modified_gmt":"2023-12-29 08:45:27","post_content_filtered":"","post_parent":0,"guid":"http:\\/\\/wordpress\\/?post_type=product&#038;p=20","menu_order":0,"post_type":"product","post_mime_type":"","comment_count":"0","filter":"raw"}]\r\n'}
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): wordpress:80
DEBUG:urllib3.connectionpool:http://wordpress:80 "GET /wp-json/chatty/v1/shop_meta HTTP/1.1" 200 67
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.openai.com:443
DEBUG:urllib3.connectionpool:https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
INFO:myapp:[{'url_params': 'product_name=this&sort_price=asc', 'is_related': 'yes', 'category': 'laptops'}, {'url_params': 'product_name=this&sort_price=asc', 'is_related': 'yes', 'category': 'smartphones'}]
INFO:myapp:product_name=this&sort_price=asc
INFO:myapp:prompt
INFO:myapp:You are AI assistant for a online shop. You should determine if a client is asking or information about a product in our store. It can be a question about price, availability in stock, product characteristic, comparing 2 products. In this case you should contruct query parameters based on a client question. Construct them for every mentioned product. Add sort_price parameter if required .For example product_name=item_name&color=green&size=44&sort_price=desc|asc List of available query parameters: product_name, color. product_name is a required parameter. You should use it in every query.Use only these query parameters for consructing. Add a category. List of available categories: laptops,smartphones. Write your asnwer as array of json objects. [{url_params: <url_here>, is_related: 'yes', category: <category_here> }] If the question is not related to products of the store, then your answer would be [{is_related: 'no'}] Be strict. Fix typos in product names. Dont write anything else. Your answer will be used for a next query. Client question: what price is this? give me the link .Your answer:
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): wordpress:80
DEBUG:urllib3.connectionpool:http://wordpress:80 "GET /wp-json/chatty/v1/posts?product_name=this&sort_price=asc HTTP/1.1" 200 87
INFO:myapp:api data Unfortunately i cant find product 'this'. But please checkout our similar products: 
[]
DEBUG:llama_index.storage.kvstore.simple_kvstore:Loading llama_index.storage.kvstore.simple_kvstore from projects/4/data\docstore.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/docstore.json
DEBUG:llama_index.storage.kvstore.simple_kvstore:Loading llama_index.storage.kvstore.simple_kvstore from projects/4/data\index_store.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/index_store.json
DEBUG:llama_index.vector_stores.simple:Loading llama_index.vector_stores.simple from projects/4/data\vector_store.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/vector_store.json
DEBUG:llama_index.graph_stores.simple:Loading llama_index.graph_stores.simple from projects/4/data\graph_store.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/graph_store.json
INFO:myapp:Final prompt: Вы — ИИ ассистент компании. Вам будут заданы вопросы о нашей компании. Вежливо отвечайте на вопросы.
    Ниже мы предоставили контекстную информацию.
    ---------------------
    {context_str}
    ---------------------
    Учитывая эту информацию, ответьте, пожалуйста, на вопрос: {query_str}
    
 History of conversation with the client: Client: hello do you have samsung smartphones,
Ai response: I apologize, but we currently do not have any Samsung smartphones available. However, we do have a wide range of other smartphones from different brands that you might be interested in. Please let me know if you would like information about any specific brand or model, and I'll be happy to assist you.
Client: ok, recommend me something,
Ai response: Certainly! Based on your interest in Samsung smartphones, I apologize for not having any Samsung smartphones available at the moment. However, I can recommend some alternative options that you might be interested in:

1. Xiaomi 13: This smartphone offers an ultra-immersive display design with 1.61mm ultra-thin bezels, providing a boundless vision. It is also IP68 water and dust resistant, making it suitable for various scenarios. The Leica main camera with a professional optical lens ensures capturing great moments, and the device is powered by the leading Snapdragon 8 Gen 2 for excellent performance. 

2. Xiaomi Redmi 12 128GB - Black - Unlocked - Dual-SIM: This smartphone features a large storage capacity of 128GB, allowing you to store all your files and media. It is unlocked and supports dual-SIM functionality, providing flexibility in using multiple networks. 

Please let me know if you would like more information about any of these options or if there's anything else I can assist you with!. 
 Information about relative products Unfortunately i cant find product 'samsung'. But please checkout our similar products: 
[{"ID":17,"post_author":"1","post_date":"2023-12-27 20:25:46","post_date_gmt":"2023-12-27 17:25:46","post_content":"<ul class=\"a-unordered-list a-vertical a-spacing-mini\">\r\n \t<li class=\"a-spacing-mini\"><span class=\"a-list-item\">Ultra-immersive display design Light up the screen to enjoy an unrivalled experience. The 1.61mm ultra-thin bezels offer a boundless vision.<\/span><\/li>\r\n \t<li class=\"a-spacing-mini\"><span class=\"a-list-item\">Built for more scenarios IP68 water and dust resistant* Born splash-proof and water-resistant, thanks to the precision manufacturing. Record special memories anytime and anywhere.<\/span><\/li>\r\n \t<li class=\"a-spacing-mini\"><span class=\"a-list-item\">Leica main camera with professional optical lens Captures every great moment<\/span><\/li>\r\n \t<li class=\"a-spacing-mini\"><span class=\"a-list-item\">Masterpiece performance Leading Snapdragon 8 Gen 2 Boosted performance, reduced consumption<\/span><\/li>\r\n<\/ul>","post_title":"Xiaomi 13","post_excerpt":"","post_status":"publish","comment_status":"open","ping_status":"closed","post_password":"","post_name":"%d0%ba%d1%80%d0%be%d1%81%d1%81%d0%be%d0%b2%d0%ba%d0%b8","to_ping":"","pinged":"","post_modified":"2024-01-01 12:03:20","post_modified_gmt":"2024-01-01 09:03:20","post_content_filtered":"","post_parent":0,"guid":"http:\/\/wordpress\/?post_type=product&#038;p=17","menu_order":0,"post_type":"product","post_mime_type":"","comment_count":"0","filter":"raw"},{"ID":20,"post_author":"1","post_date":"2023-12-29 11:32:59","post_date_gmt":"2023-12-29 08:32:59","post_content":"","post_title":"Xiaomi Redmi 12 128GB - Black - Unlocked - Dual-SIM","post_excerpt":"","post_status":"publish","comment_status":"open","ping_status":"closed","post_password":"","post_name":"xiaomi-12-black","to_ping":"","pinged":"","post_modified":"2023-12-29 11:45:27","post_modified_gmt":"2023-12-29 08:45:27","post_content_filtered":"","post_parent":0,"guid":"http:\/\/wordpress\/?post_type=product&#038;p=20","menu_order":0,"post_type":"product","post_mime_type":"","comment_count":"0","filter":"raw"}]
Unfortunately i cant find product 'this'. But please checkout our similar products: 
[]
INFO:llama_index.indices.loading:Loading indices with ids: ['vector_index']
DEBUG:openai:message='Request to OpenAI API' method=post path=https://api.openai.com/v1/embeddings
DEBUG:openai:api_version=None data='{"input": ["what price is this? give me the link"], "model": "text-embedding-ada-002", "encoding_format": "base64"}' message='Post details'
DEBUG:urllib3.util.retry:Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.openai.com:443
DEBUG:urllib3.connectionpool:https://api.openai.com:443 "POST /v1/embeddings HTTP/1.1" 200 None
DEBUG:openai:message='OpenAI API response' path=https://api.openai.com/v1/embeddings processing_ms=21 request_id=588c78fb4ccd84817b422590da1f3781 response_code=200
DEBUG:llama_index.indices.utils:> Top 1 nodes:
> [Node 909c5dd5-e87e-4999-a794-761f96e44168] [Similarity score:             -0.0272045] Welcome to TechHub, your ultimate destination for cutting-edge technology and innovation! At Tech...
DEBUG:openai:message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
DEBUG:openai:api_version=None data='{"messages": [{"role": "system", "content": "Context information is below.\\n--------------------\\nWelcome to TechHub, your ultimate destination for cutting-edge technology and innovation! At TechHub, we pride ourselves on being a premier online store dedicated to providing a curated selection of the latest and greatest in tech gadgets, including laptops, smartphones, and more.\\n\\nAbout Us:\\n\\nAt the heart of TechHub is a passion for technology and a commitment to delivering top-notch products that seamlessly blend style, functionality, and performance. With a team of tech enthusiasts, we understand the ever-evolving nature of the digital landscape and strive to stay at the forefront of the latest trends and advancements.\\n\\nOur Mission:\\n\\nOur mission at TechHub is to empower our customers with the best tools and devices that enhance their digital lifestyle. Whether you\'re a professional looking for a high-performance laptop to boost productivity or a smartphone aficionado seeking the latest flagship model, we\'ve got you covered. We believe that technology should not only meet but exceed your expectations, making every interaction with your devices a seamless and enjoyable experience.\\n\\nQuality Assurance:\\n\\nTechHub is committed to delivering products of the highest quality. We carefully curate our inventory, partnering with leading brands known for their commitment to excellence. Each product undergoes rigorous testing to ensure reliability, durability, and top-notch performance. Our dedication to quality assurance is reflected in every item we offer.\\n\\nCustomer-Centric Approach:\\n\\nAt TechHub, our customers are at the core of everything we do. We prioritize your satisfaction and strive to provide an unparalleled shopping experience. Our customer support team is ready to assist you at every step, from product inquiries to after-sales support. We value your feedback and continuously work to improve our services based on your needs.\\n\\nSecure Shopping:\\n\\nYour online security is our priority. TechHub employs state-of-the-art encryption technology to ensure that your personal information remains secure and protected. Shop with confidence, knowing that your data is in safe hands.\\n\\nExplore the world of innovation at TechHub, where technology meets lifestyle. Discover the perfect blend of style and functionality with our carefully curated selection of laptops, smartphones, and other cutting-edge gadgets. Join us on this exciting journey, and let\'s embrace the future together!\\n--------------------\\n\\u0412\\u044b \\u2014 \\u0418\\u0418 \\u0430\\u0441\\u0441\\u0438\\u0441\\u0442\\u0435\\u043d\\u0442 \\u043a\\u043e\\u043c\\u043f\\u0430\\u043d\\u0438\\u0438. \\u0412\\u0430\\u043c \\u0431\\u0443\\u0434\\u0443\\u0442 \\u0437\\u0430\\u0434\\u0430\\u043d\\u044b \\u0432\\u043e\\u043f\\u0440\\u043e\\u0441\\u044b \\u043e \\u043d\\u0430\\u0448\\u0435\\u0439 \\u043a\\u043e\\u043c\\u043f\\u0430\\u043d\\u0438\\u0438. \\u0412\\u0435\\u0436\\u043b\\u0438\\u0432\\u043e \\u043e\\u0442\\u0432\\u0435\\u0447\\u0430\\u0439\\u0442\\u0435 \\u043d\\u0430 \\u0432\\u043e\\u043f\\u0440\\u043e\\u0441\\u044b.\\r\\n    \\u041d\\u0438\\u0436\\u0435 \\u043c\\u044b \\u043f\\u0440\\u0435\\u0434\\u043e\\u0441\\u0442\\u0430\\u0432\\u0438\\u043b\\u0438 \\u043a\\u043e\\u043d\\u0442\\u0435\\u043a\\u0441\\u0442\\u043d\\u0443\\u044e \\u0438\\u043d\\u0444\\u043e\\u0440\\u043c\\u0430\\u0446\\u0438\\u044e.\\r\\n    ---------------------\\r\\n    {context_str}\\r\\n    ---------------------\\r\\n    \\u0423\\u0447\\u0438\\u0442\\u044b\\u0432\\u0430\\u044f \\u044d\\u0442\\u0443 \\u0438\\u043d\\u0444\\u043e\\u0440\\u043c\\u0430\\u0446\\u0438\\u044e, \\u043e\\u0442\\u0432\\u0435\\u0442\\u044c\\u0442\\u0435, \\u043f\\u043e\\u0436\\u0430\\u043b\\u0443\\u0439\\u0441\\u0442\\u0430, \\u043d\\u0430 \\u0432\\u043e\\u043f\\u0440\\u043e\\u0441: {query_str}\\r\\n    \\n History of conversation with the client: Client: hello do you have samsung smartphones,\\nAi response: I apologize, but we currently do not have any Samsung smartphones available. However, we do have a wide range of other smartphones from different brands that you might be interested in. Please let me know if you would like information about any specific brand or model, and I\'ll be happy to assist you.\\r\\nClient: ok, recommend me something,\\nAi response: Certainly! Based on your interest in Samsung smartphones, I apologize for not having any Samsung smartphones available at the moment. However, I can recommend some alternative options that you might be interested in:\\n\\n1. Xiaomi 13: This smartphone offers an ultra-immersive display design with 1.61mm ultra-thin bezels, providing a boundless vision. It is also IP68 water and dust resistant, making it suitable for various scenarios. The Leica main camera with a professional optical lens ensures capturing great moments, and the device is powered by the leading Snapdragon 8 Gen 2 for excellent performance. \\n\\n2. Xiaomi Redmi 12 128GB - Black - Unlocked - Dual-SIM: This smartphone features a large storage capacity of 128GB, allowing you to store all your files and media. It is unlocked and supports dual-SIM functionality, providing flexibility in using multiple networks. \\n\\nPlease let me know if you would like more information about any of these options or if there\'s anything else I can assist you with!. \\n Information about relative products Unfortunately i cant find product \'samsung\'. But please checkout our similar products: \\n[{\\"ID\\":17,\\"post_author\\":\\"1\\",\\"post_date\\":\\"2023-12-27 20:25:46\\",\\"post_date_gmt\\":\\"2023-12-27 17:25:46\\",\\"post_content\\":\\"<ul class=\\\\\\"a-unordered-list a-vertical a-spacing-mini\\\\\\">\\\\r\\\\n \\\\t<li class=\\\\\\"a-spacing-mini\\\\\\"><span class=\\\\\\"a-list-item\\\\\\">Ultra-immersive display design Light up the screen to enjoy an unrivalled experience. The 1.61mm ultra-thin bezels offer a boundless vision.<\\\\/span><\\\\/li>\\\\r\\\\n \\\\t<li class=\\\\\\"a-spacing-mini\\\\\\"><span class=\\\\\\"a-list-item\\\\\\">Built for more scenarios IP68 water and dust resistant* Born splash-proof and water-resistant, thanks to the precision manufacturing. Record special memories anytime and anywhere.<\\\\/span><\\\\/li>\\\\r\\\\n \\\\t<li class=\\\\\\"a-spacing-mini\\\\\\"><span class=\\\\\\"a-list-item\\\\\\">Leica main camera with professional optical lens Captures every great moment<\\\\/span><\\\\/li>\\\\r\\\\n \\\\t<li class=\\\\\\"a-spacing-mini\\\\\\"><span class=\\\\\\"a-list-item\\\\\\">Masterpiece performance Leading Snapdragon 8 Gen 2 Boosted performance, reduced consumption<\\\\/span><\\\\/li>\\\\r\\\\n<\\\\/ul>\\",\\"post_title\\":\\"Xiaomi 13\\",\\"post_excerpt\\":\\"\\",\\"post_status\\":\\"publish\\",\\"comment_status\\":\\"open\\",\\"ping_status\\":\\"closed\\",\\"post_password\\":\\"\\",\\"post_name\\":\\"%d0%ba%d1%80%d0%be%d1%81%d1%81%d0%be%d0%b2%d0%ba%d0%b8\\",\\"to_ping\\":\\"\\",\\"pinged\\":\\"\\",\\"post_modified\\":\\"2024-01-01 12:03:20\\",\\"post_modified_gmt\\":\\"2024-01-01 09:03:20\\",\\"post_content_filtered\\":\\"\\",\\"post_parent\\":0,\\"guid\\":\\"http:\\\\/\\\\/wordpress\\\\/?post_type=product&#038;p=17\\",\\"menu_order\\":0,\\"post_type\\":\\"product\\",\\"post_mime_type\\":\\"\\",\\"comment_count\\":\\"0\\",\\"filter\\":\\"raw\\"},{\\"ID\\":20,\\"post_author\\":\\"1\\",\\"post_date\\":\\"2023-12-29 11:32:59\\",\\"post_date_gmt\\":\\"2023-12-29 08:32:59\\",\\"post_content\\":\\"\\",\\"post_title\\":\\"Xiaomi Redmi 12 128GB - Black - Unlocked - Dual-SIM\\",\\"post_excerpt\\":\\"\\",\\"post_status\\":\\"publish\\",\\"comment_status\\":\\"open\\",\\"ping_status\\":\\"closed\\",\\"post_password\\":\\"\\",\\"post_name\\":\\"xiaomi-12-black\\",\\"to_ping\\":\\"\\",\\"pinged\\":\\"\\",\\"post_modified\\":\\"2023-12-29 11:45:27\\",\\"post_modified_gmt\\":\\"2023-12-29 08:45:27\\",\\"post_content_filtered\\":\\"\\",\\"post_parent\\":0,\\"guid\\":\\"http:\\\\/\\\\/wordpress\\\\/?post_type=product&#038;p=20\\",\\"menu_order\\":0,\\"post_type\\":\\"product\\",\\"post_mime_type\\":\\"\\",\\"comment_count\\":\\"0\\",\\"filter\\":\\"raw\\"}]\\r\\nUnfortunately i cant find product \'this\'. But please checkout our similar products: \\n[]"}, {"role": "user", "content": "what price is this? give me the link"}], "stream": false, "model": "gpt-3.5-turbo", "temperature": 0, "max_tokens": null}' message='Post details'
DEBUG:urllib3.connectionpool:https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
DEBUG:openai:message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=603 request_id=a5d3ce3cf3376aed46dbb17577f8913e response_code=200
INFO:myapp:{'api': 1, 'product_data': 'http://wordpress/wp-json/chatty/v1', 'website': 'asdf', 'id': 4, 'left_tokens': 75534, 'description': None, 'temperature': Decimal('0.00'), 'model': 'gpt-3.5-turbo', 'prompt': 'Вы — ИИ ассистент компании. Вам будут заданы вопросы о нашей компании. Вежливо отвечайте на вопросы.\r\n    Ниже мы предоставили контекстную информацию.\r\n    ---------------------\r\n    {context_str}\r\n    ---------------------\r\n    Учитывая эту информацию, ответьте, пожалуйста, на вопрос: {query_str}\r\n    ', 'response_mode': 'compact', 'user_id': 12, 'answer': "Client: hello do you have samsung smartphones,\nAi response: I apologize, but we currently do not have any Samsung smartphones available. However, we do have a wide range of other smartphones from different brands that you might be interested in. Please let me know if you would like information about any specific brand or model, and I'll be happy to assist you.\r\nClient: ok, recommend me something,\nAi response: Certainly! Based on your interest in Samsung smartphones, I apologize for not having any Samsung smartphones available at the moment. However, I can recommend some alternative options that you might be interested in:\n\n1. Xiaomi 13: This smartphone offers an ultra-immersive display design with 1.61mm ultra-thin bezels, providing a boundless vision. It is also IP68 water and dust resistant, making it suitable for various scenarios. The Leica main camera with a professional optical lens ensures capturing great moments, and the device is powered by the leading Snapdragon 8 Gen 2 for excellent performance. \n\n2. Xiaomi Redmi 12 128GB - Black - Unlocked - Dual-SIM: This smartphone features a large storage capacity of 128GB, allowing you to store all your files and media. It is unlocked and supports dual-SIM functionality, providing flexibility in using multiple networks. \n\nPlease let me know if you would like more information about any of these options or if there's anything else I can assist you with!", 'context': 'Unfortunately i cant find product \'samsung\'. But please checkout our similar products: \n[{"ID":17,"post_author":"1","post_date":"2023-12-27 20:25:46","post_date_gmt":"2023-12-27 17:25:46","post_content":"<ul class=\\"a-unordered-list a-vertical a-spacing-mini\\">\\r\\n \\t<li class=\\"a-spacing-mini\\"><span class=\\"a-list-item\\">Ultra-immersive display design Light up the screen to enjoy an unrivalled experience. The 1.61mm ultra-thin bezels offer a boundless vision.<\\/span><\\/li>\\r\\n \\t<li class=\\"a-spacing-mini\\"><span class=\\"a-list-item\\">Built for more scenarios IP68 water and dust resistant* Born splash-proof and water-resistant, thanks to the precision manufacturing. Record special memories anytime and anywhere.<\\/span><\\/li>\\r\\n \\t<li class=\\"a-spacing-mini\\"><span class=\\"a-list-item\\">Leica main camera with professional optical lens Captures every great moment<\\/span><\\/li>\\r\\n \\t<li class=\\"a-spacing-mini\\"><span class=\\"a-list-item\\">Masterpiece performance Leading Snapdragon 8 Gen 2 Boosted performance, reduced consumption<\\/span><\\/li>\\r\\n<\\/ul>","post_title":"Xiaomi 13","post_excerpt":"","post_status":"publish","comment_status":"open","ping_status":"closed","post_password":"","post_name":"%d0%ba%d1%80%d0%be%d1%81%d1%81%d0%be%d0%b2%d0%ba%d0%b8","to_ping":"","pinged":"","post_modified":"2024-01-01 12:03:20","post_modified_gmt":"2024-01-01 09:03:20","post_content_filtered":"","post_parent":0,"guid":"http:\\/\\/wordpress\\/?post_type=product&#038;p=17","menu_order":0,"post_type":"product","post_mime_type":"","comment_count":"0","filter":"raw"},{"ID":20,"post_author":"1","post_date":"2023-12-29 11:32:59","post_date_gmt":"2023-12-29 08:32:59","post_content":"","post_title":"Xiaomi Redmi 12 128GB - Black - Unlocked - Dual-SIM","post_excerpt":"","post_status":"publish","comment_status":"open","ping_status":"closed","post_password":"","post_name":"xiaomi-12-black","to_ping":"","pinged":"","post_modified":"2023-12-29 11:45:27","post_modified_gmt":"2023-12-29 08:45:27","post_content_filtered":"","post_parent":0,"guid":"http:\\/\\/wordpress\\/?post_type=product&#038;p=20","menu_order":0,"post_type":"product","post_mime_type":"","comment_count":"0","filter":"raw"}]\r\n'}
INFO:werkzeug:127.0.0.1 - - [01/Jan/2024 20:42:37] "POST /projects/e47f0f811145d03c33fd6639dc3f09c0839d0891e264d849a75df04f4d047625/KW2uCtbdOgV3cltg8W3i6JbZcQWtfy9j HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [01/Jan/2024 20:43:21] "OPTIONS /projects/e47f0f811145d03c33fd6639dc3f09c0839d0891e264d849a75df04f4d047625/KW2uCtbdOgV3cltg8W3i6JbZcQWtfy9j HTTP/1.1" 200 -
INFO:myapp:{'api': 1, 'product_data': 'http://wordpress/wp-json/chatty/v1', 'website': 'asdf', 'id': 4, 'left_tokens': 74010, 'description': None, 'temperature': Decimal('0.00'), 'model': 'gpt-3.5-turbo', 'prompt': 'Вы — ИИ ассистент компании. Вам будут заданы вопросы о нашей компании. Вежливо отвечайте на вопросы.\r\n    Ниже мы предоставили контекстную информацию.\r\n    ---------------------\r\n    {context_str}\r\n    ---------------------\r\n    Учитывая эту информацию, ответьте, пожалуйста, на вопрос: {query_str}\r\n    ', 'response_mode': 'compact', 'user_id': 12, 'answer': "Client: hello do you have samsung smartphones,\nAi response: I apologize, but we currently do not have any Samsung smartphones available. However, we do have a wide range of other smartphones from different brands that you might be interested in. Please let me know if you would like information about any specific brand or model, and I'll be happy to assist you.\r\nClient: ok, recommend me something,\nAi response: Certainly! Based on your interest in Samsung smartphones, I apologize for not having any Samsung smartphones available at the moment. However, I can recommend some alternative options that you might be interested in:\n\n1. Xiaomi 13: This smartphone offers an ultra-immersive display design with 1.61mm ultra-thin bezels, providing a boundless vision. It is also IP68 water and dust resistant, making it suitable for various scenarios. The Leica main camera with a professional optical lens ensures capturing great moments, and the device is powered by the leading Snapdragon 8 Gen 2 for excellent performance. \n\n2. Xiaomi Redmi 12 128GB - Black - Unlocked - Dual-SIM: This smartphone features a large storage capacity of 128GB, allowing you to store all your files and media. It is unlocked and supports dual-SIM functionality, providing flexibility in using multiple networks. \n\nPlease let me know if you would like more information about any of these options or if there's anything else I can assist you with!\r\nClient: what price is this? give me the link,\nAi response: I apologize for the confusion. Could you please clarify which product you are referring to?", 'context': 'Unfortunately i cant find product \'samsung\'. But please checkout our similar products: \n[{"ID":17,"post_author":"1","post_date":"2023-12-27 20:25:46","post_date_gmt":"2023-12-27 17:25:46","post_content":"<ul class=\\"a-unordered-list a-vertical a-spacing-mini\\">\\r\\n \\t<li class=\\"a-spacing-mini\\"><span class=\\"a-list-item\\">Ultra-immersive display design Light up the screen to enjoy an unrivalled experience. The 1.61mm ultra-thin bezels offer a boundless vision.<\\/span><\\/li>\\r\\n \\t<li class=\\"a-spacing-mini\\"><span class=\\"a-list-item\\">Built for more scenarios IP68 water and dust resistant* Born splash-proof and water-resistant, thanks to the precision manufacturing. Record special memories anytime and anywhere.<\\/span><\\/li>\\r\\n \\t<li class=\\"a-spacing-mini\\"><span class=\\"a-list-item\\">Leica main camera with professional optical lens Captures every great moment<\\/span><\\/li>\\r\\n \\t<li class=\\"a-spacing-mini\\"><span class=\\"a-list-item\\">Masterpiece performance Leading Snapdragon 8 Gen 2 Boosted performance, reduced consumption<\\/span><\\/li>\\r\\n<\\/ul>","post_title":"Xiaomi 13","post_excerpt":"","post_status":"publish","comment_status":"open","ping_status":"closed","post_password":"","post_name":"%d0%ba%d1%80%d0%be%d1%81%d1%81%d0%be%d0%b2%d0%ba%d0%b8","to_ping":"","pinged":"","post_modified":"2024-01-01 12:03:20","post_modified_gmt":"2024-01-01 09:03:20","post_content_filtered":"","post_parent":0,"guid":"http:\\/\\/wordpress\\/?post_type=product&#038;p=17","menu_order":0,"post_type":"product","post_mime_type":"","comment_count":"0","filter":"raw"},{"ID":20,"post_author":"1","post_date":"2023-12-29 11:32:59","post_date_gmt":"2023-12-29 08:32:59","post_content":"","post_title":"Xiaomi Redmi 12 128GB - Black - Unlocked - Dual-SIM","post_excerpt":"","post_status":"publish","comment_status":"open","ping_status":"closed","post_password":"","post_name":"xiaomi-12-black","to_ping":"","pinged":"","post_modified":"2023-12-29 11:45:27","post_modified_gmt":"2023-12-29 08:45:27","post_content_filtered":"","post_parent":0,"guid":"http:\\/\\/wordpress\\/?post_type=product&#038;p=20","menu_order":0,"post_type":"product","post_mime_type":"","comment_count":"0","filter":"raw"}]\r\n\r\nUnfortunately i cant find product \'this\'. But please checkout our similar products: \n[]'}
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): wordpress:80
DEBUG:urllib3.connectionpool:http://wordpress:80 "GET /wp-json/chatty/v1/shop_meta HTTP/1.1" 200 67
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.openai.com:443
DEBUG:urllib3.connectionpool:https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
INFO:myapp:[{'url_params': 'product_name=xiaomi 12', 'is_related': 'yes', 'category': 'smartphones'}]
INFO:myapp:product_name=xiaomi 12
INFO:myapp:prompt
INFO:myapp:You are AI assistant for a online shop. You should determine if a client is asking or information about a product in our store. It can be a question about price, availability in stock, product characteristic, comparing 2 products. In this case you should contruct query parameters based on a client question. Construct them for every mentioned product. Add sort_price parameter if required .For example product_name=item_name&color=green&size=44&sort_price=desc|asc List of available query parameters: product_name, color. product_name is a required parameter. You should use it in every query.Use only these query parameters for consructing. Add a category. List of available categories: laptops,smartphones. Write your asnwer as array of json objects. [{url_params: <url_here>, is_related: 'yes', category: <category_here> }] If the question is not related to products of the store, then your answer would be [{is_related: 'no'}] Be strict. Fix typos in product names. Dont write anything else. Your answer will be used for a next query. Client question: xiaomi 12 .Your answer:
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): wordpress:80
DEBUG:urllib3.connectionpool:http://wordpress:80 "GET /wp-json/chatty/v1/posts?product_name=xiaomi+12 HTTP/1.1" 200 722
INFO:myapp:api data [{"id":20,"title":"Xiaomi Redmi 12 128GB &#8212; Black &#8212; Unlocked &#8212; Dual-SIM","content":"","date":"29.12.2023","attributes":{"pa_color":["black"]},"stock":"instock","image_url":false,"sku":"141234-1","price":"15000","formatted_price":"<span class=\"woocommerce-Price-amount amount\"><bdi>15000,00&nbsp;<span class=\"woocommerce-Price-currencySymbol\">&#8381;<\/span><\/bdi><\/span>","formatted_sale_price":"<span class=\"woocommerce-Price-amount amount\"><bdi>0,00&nbsp;<span class=\"woocommerce-Price-currencySymbol\">&#8381;<\/span><\/bdi><\/span>","on_sale":false,"product_link":"http:\/\/wordpress\/product\/xiaomi-12-black\/","weigth":"\u041d\/\u0414","dimensions":"\u041d\/\u0414","dimension_unit":"cm"}]
DEBUG:llama_index.storage.kvstore.simple_kvstore:Loading llama_index.storage.kvstore.simple_kvstore from projects/4/data\docstore.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/docstore.json
DEBUG:llama_index.storage.kvstore.simple_kvstore:Loading llama_index.storage.kvstore.simple_kvstore from projects/4/data\index_store.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/index_store.json
DEBUG:llama_index.vector_stores.simple:Loading llama_index.vector_stores.simple from projects/4/data\vector_store.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/vector_store.json
DEBUG:llama_index.graph_stores.simple:Loading llama_index.graph_stores.simple from projects/4/data\graph_store.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/graph_store.json
INFO:myapp:Final prompt: Вы — ИИ ассистент компании. Вам будут заданы вопросы о нашей компании. Вежливо отвечайте на вопросы.
    Ниже мы предоставили контекстную информацию.
    ---------------------
    {context_str}
    ---------------------
    Учитывая эту информацию, ответьте, пожалуйста, на вопрос: {query_str}
    
 History of conversation with the client: Client: hello do you have samsung smartphones,
Ai response: I apologize, but we currently do not have any Samsung smartphones available. However, we do have a wide range of other smartphones from different brands that you might be interested in. Please let me know if you would like information about any specific brand or model, and I'll be happy to assist you.
Client: ok, recommend me something,
Ai response: Certainly! Based on your interest in Samsung smartphones, I apologize for not having any Samsung smartphones available at the moment. However, I can recommend some alternative options that you might be interested in:

1. Xiaomi 13: This smartphone offers an ultra-immersive display design with 1.61mm ultra-thin bezels, providing a boundless vision. It is also IP68 water and dust resistant, making it suitable for various scenarios. The Leica main camera with a professional optical lens ensures capturing great moments, and the device is powered by the leading Snapdragon 8 Gen 2 for excellent performance. 

2. Xiaomi Redmi 12 128GB - Black - Unlocked - Dual-SIM: This smartphone features a large storage capacity of 128GB, allowing you to store all your files and media. It is unlocked and supports dual-SIM functionality, providing flexibility in using multiple networks. 

Please let me know if you would like more information about any of these options or if there's anything else I can assist you with!
Client: what price is this? give me the link,
Ai response: I apologize for the confusion. Could you please clarify which product you are referring to?. 
 Information about relative products Unfortunately i cant find product 'samsung'. But please checkout our similar products: 
[{"ID":17,"post_author":"1","post_date":"2023-12-27 20:25:46","post_date_gmt":"2023-12-27 17:25:46","post_content":"<ul class=\"a-unordered-list a-vertical a-spacing-mini\">\r\n \t<li class=\"a-spacing-mini\"><span class=\"a-list-item\">Ultra-immersive display design Light up the screen to enjoy an unrivalled experience. The 1.61mm ultra-thin bezels offer a boundless vision.<\/span><\/li>\r\n \t<li class=\"a-spacing-mini\"><span class=\"a-list-item\">Built for more scenarios IP68 water and dust resistant* Born splash-proof and water-resistant, thanks to the precision manufacturing. Record special memories anytime and anywhere.<\/span><\/li>\r\n \t<li class=\"a-spacing-mini\"><span class=\"a-list-item\">Leica main camera with professional optical lens Captures every great moment<\/span><\/li>\r\n \t<li class=\"a-spacing-mini\"><span class=\"a-list-item\">Masterpiece performance Leading Snapdragon 8 Gen 2 Boosted performance, reduced consumption<\/span><\/li>\r\n<\/ul>","post_title":"Xiaomi 13","post_excerpt":"","post_status":"publish","comment_status":"open","ping_status":"closed","post_password":"","post_name":"%d0%ba%d1%80%d0%be%d1%81%d1%81%d0%be%d0%b2%d0%ba%d0%b8","to_ping":"","pinged":"","post_modified":"2024-01-01 12:03:20","post_modified_gmt":"2024-01-01 09:03:20","post_content_filtered":"","post_parent":0,"guid":"http:\/\/wordpress\/?post_type=product&#038;p=17","menu_order":0,"post_type":"product","post_mime_type":"","comment_count":"0","filter":"raw"},{"ID":20,"post_author":"1","post_date":"2023-12-29 11:32:59","post_date_gmt":"2023-12-29 08:32:59","post_content":"","post_title":"Xiaomi Redmi 12 128GB - Black - Unlocked - Dual-SIM","post_excerpt":"","post_status":"publish","comment_status":"open","ping_status":"closed","post_password":"","post_name":"xiaomi-12-black","to_ping":"","pinged":"","post_modified":"2023-12-29 11:45:27","post_modified_gmt":"2023-12-29 08:45:27","post_content_filtered":"","post_parent":0,"guid":"http:\/\/wordpress\/?post_type=product&#038;p=20","menu_order":0,"post_type":"product","post_mime_type":"","comment_count":"0","filter":"raw"}]

Unfortunately i cant find product 'this'. But please checkout our similar products: 
[][{"id":20,"title":"Xiaomi Redmi 12 128GB &#8212; Black &#8212; Unlocked &#8212; Dual-SIM","content":"","date":"29.12.2023","attributes":{"pa_color":["black"]},"stock":"instock","image_url":false,"sku":"141234-1","price":"15000","formatted_price":"<span class=\"woocommerce-Price-amount amount\"><bdi>15000,00&nbsp;<span class=\"woocommerce-Price-currencySymbol\">&#8381;<\/span><\/bdi><\/span>","formatted_sale_price":"<span class=\"woocommerce-Price-amount amount\"><bdi>0,00&nbsp;<span class=\"woocommerce-Price-currencySymbol\">&#8381;<\/span><\/bdi><\/span>","on_sale":false,"product_link":"http:\/\/wordpress\/product\/xiaomi-12-black\/","weigth":"\u041d\/\u0414","dimensions":"\u041d\/\u0414","dimension_unit":"cm"}]
INFO:llama_index.indices.loading:Loading indices with ids: ['vector_index']
DEBUG:openai:message='Request to OpenAI API' method=post path=https://api.openai.com/v1/embeddings
DEBUG:openai:api_version=None data='{"input": ["xiaomi 12"], "model": "text-embedding-ada-002", "encoding_format": "base64"}' message='Post details'
DEBUG:urllib3.util.retry:Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.openai.com:443
DEBUG:urllib3.connectionpool:https://api.openai.com:443 "POST /v1/embeddings HTTP/1.1" 200 None
DEBUG:openai:message='OpenAI API response' path=https://api.openai.com/v1/embeddings processing_ms=19 request_id=d1f5ad49d791ad638ea806a020d738a3 response_code=200
DEBUG:llama_index.indices.utils:> Top 1 nodes:
> [Node 909c5dd5-e87e-4999-a794-761f96e44168] [Similarity score:             -0.0299127] Welcome to TechHub, your ultimate destination for cutting-edge technology and innovation! At Tech...
DEBUG:openai:message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
DEBUG:openai:api_version=None data='{"messages": [{"role": "system", "content": "Context information is below.\\n--------------------\\nWelcome to TechHub, your ultimate destination for cutting-edge technology and innovation! At TechHub, we pride ourselves on being a premier online store dedicated to providing a curated selection of the latest and greatest in tech gadgets, including laptops, smartphones, and more.\\n\\nAbout Us:\\n\\nAt the heart of TechHub is a passion for technology and a commitment to delivering top-notch products that seamlessly blend style, functionality, and performance. With a team of tech enthusiasts, we understand the ever-evolving nature of the digital landscape and strive to stay at the forefront of the latest trends and advancements.\\n\\nOur Mission:\\n\\nOur mission at TechHub is to empower our customers with the best tools and devices that enhance their digital lifestyle. Whether you\'re a professional looking for a high-performance laptop to boost productivity or a smartphone aficionado seeking the latest flagship model, we\'ve got you covered. We believe that technology should not only meet but exceed your expectations, making every interaction with your devices a seamless and enjoyable experience.\\n\\nQuality Assurance:\\n\\nTechHub is committed to delivering products of the highest quality. We carefully curate our inventory, partnering with leading brands known for their commitment to excellence. Each product undergoes rigorous testing to ensure reliability, durability, and top-notch performance. Our dedication to quality assurance is reflected in every item we offer.\\n\\nCustomer-Centric Approach:\\n\\nAt TechHub, our customers are at the core of everything we do. We prioritize your satisfaction and strive to provide an unparalleled shopping experience. Our customer support team is ready to assist you at every step, from product inquiries to after-sales support. We value your feedback and continuously work to improve our services based on your needs.\\n\\nSecure Shopping:\\n\\nYour online security is our priority. TechHub employs state-of-the-art encryption technology to ensure that your personal information remains secure and protected. Shop with confidence, knowing that your data is in safe hands.\\n\\nExplore the world of innovation at TechHub, where technology meets lifestyle. Discover the perfect blend of style and functionality with our carefully curated selection of laptops, smartphones, and other cutting-edge gadgets. Join us on this exciting journey, and let\'s embrace the future together!\\n--------------------\\n\\u0412\\u044b \\u2014 \\u0418\\u0418 \\u0430\\u0441\\u0441\\u0438\\u0441\\u0442\\u0435\\u043d\\u0442 \\u043a\\u043e\\u043c\\u043f\\u0430\\u043d\\u0438\\u0438. \\u0412\\u0430\\u043c \\u0431\\u0443\\u0434\\u0443\\u0442 \\u0437\\u0430\\u0434\\u0430\\u043d\\u044b \\u0432\\u043e\\u043f\\u0440\\u043e\\u0441\\u044b \\u043e \\u043d\\u0430\\u0448\\u0435\\u0439 \\u043a\\u043e\\u043c\\u043f\\u0430\\u043d\\u0438\\u0438. \\u0412\\u0435\\u0436\\u043b\\u0438\\u0432\\u043e \\u043e\\u0442\\u0432\\u0435\\u0447\\u0430\\u0439\\u0442\\u0435 \\u043d\\u0430 \\u0432\\u043e\\u043f\\u0440\\u043e\\u0441\\u044b.\\r\\n    \\u041d\\u0438\\u0436\\u0435 \\u043c\\u044b \\u043f\\u0440\\u0435\\u0434\\u043e\\u0441\\u0442\\u0430\\u0432\\u0438\\u043b\\u0438 \\u043a\\u043e\\u043d\\u0442\\u0435\\u043a\\u0441\\u0442\\u043d\\u0443\\u044e \\u0438\\u043d\\u0444\\u043e\\u0440\\u043c\\u0430\\u0446\\u0438\\u044e.\\r\\n    ---------------------\\r\\n    {context_str}\\r\\n    ---------------------\\r\\n    \\u0423\\u0447\\u0438\\u0442\\u044b\\u0432\\u0430\\u044f \\u044d\\u0442\\u0443 \\u0438\\u043d\\u0444\\u043e\\u0440\\u043c\\u0430\\u0446\\u0438\\u044e, \\u043e\\u0442\\u0432\\u0435\\u0442\\u044c\\u0442\\u0435, \\u043f\\u043e\\u0436\\u0430\\u043b\\u0443\\u0439\\u0441\\u0442\\u0430, \\u043d\\u0430 \\u0432\\u043e\\u043f\\u0440\\u043e\\u0441: {query_str}\\r\\n    \\n History of conversation with the client: Client: hello do you have samsung smartphones,\\nAi response: I apologize, but we currently do not have any Samsung smartphones available. However, we do have a wide range of other smartphones from different brands that you might be interested in. Please let me know if you would like information about any specific brand or model, and I\'ll be happy to assist you.\\r\\nClient: ok, recommend me something,\\nAi response: Certainly! Based on your interest in Samsung smartphones, I apologize for not having any Samsung smartphones available at the moment. However, I can recommend some alternative options that you might be interested in:\\n\\n1. Xiaomi 13: This smartphone offers an ultra-immersive display design with 1.61mm ultra-thin bezels, providing a boundless vision. It is also IP68 water and dust resistant, making it suitable for various scenarios. The Leica main camera with a professional optical lens ensures capturing great moments, and the device is powered by the leading Snapdragon 8 Gen 2 for excellent performance. \\n\\n2. Xiaomi Redmi 12 128GB - Black - Unlocked - Dual-SIM: This smartphone features a large storage capacity of 128GB, allowing you to store all your files and media. It is unlocked and supports dual-SIM functionality, providing flexibility in using multiple networks. \\n\\nPlease let me know if you would like more information about any of these options or if there\'s anything else I can assist you with!\\r\\nClient: what price is this? give me the link,\\nAi response: I apologize for the confusion. Could you please clarify which product you are referring to?. \\n Information about relative products Unfortunately i cant find product \'samsung\'. But please checkout our similar products: \\n[{\\"ID\\":17,\\"post_author\\":\\"1\\",\\"post_date\\":\\"2023-12-27 20:25:46\\",\\"post_date_gmt\\":\\"2023-12-27 17:25:46\\",\\"post_content\\":\\"<ul class=\\\\\\"a-unordered-list a-vertical a-spacing-mini\\\\\\">\\\\r\\\\n \\\\t<li class=\\\\\\"a-spacing-mini\\\\\\"><span class=\\\\\\"a-list-item\\\\\\">Ultra-immersive display design Light up the screen to enjoy an unrivalled experience. The 1.61mm ultra-thin bezels offer a boundless vision.<\\\\/span><\\\\/li>\\\\r\\\\n \\\\t<li class=\\\\\\"a-spacing-mini\\\\\\"><span class=\\\\\\"a-list-item\\\\\\">Built for more scenarios IP68 water and dust resistant* Born splash-proof and water-resistant, thanks to the precision manufacturing. Record special memories anytime and anywhere.<\\\\/span><\\\\/li>\\\\r\\\\n \\\\t<li class=\\\\\\"a-spacing-mini\\\\\\"><span class=\\\\\\"a-list-item\\\\\\">Leica main camera with professional optical lens Captures every great moment<\\\\/span><\\\\/li>\\\\r\\\\n \\\\t<li class=\\\\\\"a-spacing-mini\\\\\\"><span class=\\\\\\"a-list-item\\\\\\">Masterpiece performance Leading Snapdragon 8 Gen 2 Boosted performance, reduced consumption<\\\\/span><\\\\/li>\\\\r\\\\n<\\\\/ul>\\",\\"post_title\\":\\"Xiaomi 13\\",\\"post_excerpt\\":\\"\\",\\"post_status\\":\\"publish\\",\\"comment_status\\":\\"open\\",\\"ping_status\\":\\"closed\\",\\"post_password\\":\\"\\",\\"post_name\\":\\"%d0%ba%d1%80%d0%be%d1%81%d1%81%d0%be%d0%b2%d0%ba%d0%b8\\",\\"to_ping\\":\\"\\",\\"pinged\\":\\"\\",\\"post_modified\\":\\"2024-01-01 12:03:20\\",\\"post_modified_gmt\\":\\"2024-01-01 09:03:20\\",\\"post_content_filtered\\":\\"\\",\\"post_parent\\":0,\\"guid\\":\\"http:\\\\/\\\\/wordpress\\\\/?post_type=product&#038;p=17\\",\\"menu_order\\":0,\\"post_type\\":\\"product\\",\\"post_mime_type\\":\\"\\",\\"comment_count\\":\\"0\\",\\"filter\\":\\"raw\\"},{\\"ID\\":20,\\"post_author\\":\\"1\\",\\"post_date\\":\\"2023-12-29 11:32:59\\",\\"post_date_gmt\\":\\"2023-12-29 08:32:59\\",\\"post_content\\":\\"\\",\\"post_title\\":\\"Xiaomi Redmi 12 128GB - Black - Unlocked - Dual-SIM\\",\\"post_excerpt\\":\\"\\",\\"post_status\\":\\"publish\\",\\"comment_status\\":\\"open\\",\\"ping_status\\":\\"closed\\",\\"post_password\\":\\"\\",\\"post_name\\":\\"xiaomi-12-black\\",\\"to_ping\\":\\"\\",\\"pinged\\":\\"\\",\\"post_modified\\":\\"2023-12-29 11:45:27\\",\\"post_modified_gmt\\":\\"2023-12-29 08:45:27\\",\\"post_content_filtered\\":\\"\\",\\"post_parent\\":0,\\"guid\\":\\"http:\\\\/\\\\/wordpress\\\\/?post_type=product&#038;p=20\\",\\"menu_order\\":0,\\"post_type\\":\\"product\\",\\"post_mime_type\\":\\"\\",\\"comment_count\\":\\"0\\",\\"filter\\":\\"raw\\"}]\\r\\n\\r\\nUnfortunately i cant find product \'this\'. But please checkout our similar products: \\n[][{\\"id\\":20,\\"title\\":\\"Xiaomi Redmi 12 128GB &#8212; Black &#8212; Unlocked &#8212; Dual-SIM\\",\\"content\\":\\"\\",\\"date\\":\\"29.12.2023\\",\\"attributes\\":{\\"pa_color\\":[\\"black\\"]},\\"stock\\":\\"instock\\",\\"image_url\\":false,\\"sku\\":\\"141234-1\\",\\"price\\":\\"15000\\",\\"formatted_price\\":\\"<span class=\\\\\\"woocommerce-Price-amount amount\\\\\\"><bdi>15000,00&nbsp;<span class=\\\\\\"woocommerce-Price-currencySymbol\\\\\\">&#8381;<\\\\/span><\\\\/bdi><\\\\/span>\\",\\"formatted_sale_price\\":\\"<span class=\\\\\\"woocommerce-Price-amount amount\\\\\\"><bdi>0,00&nbsp;<span class=\\\\\\"woocommerce-Price-currencySymbol\\\\\\">&#8381;<\\\\/span><\\\\/bdi><\\\\/span>\\",\\"on_sale\\":false,\\"product_link\\":\\"http:\\\\/\\\\/wordpress\\\\/product\\\\/xiaomi-12-black\\\\/\\",\\"weigth\\":\\"\\\\u041d\\\\/\\\\u0414\\",\\"dimensions\\":\\"\\\\u041d\\\\/\\\\u0414\\",\\"dimension_unit\\":\\"cm\\"}]"}, {"role": "user", "content": "xiaomi 12"}], "stream": false, "model": "gpt-3.5-turbo", "temperature": 0, "max_tokens": null}' message='Post details'
DEBUG:urllib3.connectionpool:https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
DEBUG:openai:message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=6047 request_id=a2b916803ae4013029f146ea70b28197 response_code=200
INFO:myapp:{'api': 1, 'product_data': 'http://wordpress/wp-json/chatty/v1', 'website': 'asdf', 'id': 4, 'left_tokens': 74010, 'description': None, 'temperature': Decimal('0.00'), 'model': 'gpt-3.5-turbo', 'prompt': 'Вы — ИИ ассистент компании. Вам будут заданы вопросы о нашей компании. Вежливо отвечайте на вопросы.\r\n    Ниже мы предоставили контекстную информацию.\r\n    ---------------------\r\n    {context_str}\r\n    ---------------------\r\n    Учитывая эту информацию, ответьте, пожалуйста, на вопрос: {query_str}\r\n    ', 'response_mode': 'compact', 'user_id': 12, 'answer': "Client: hello do you have samsung smartphones,\nAi response: I apologize, but we currently do not have any Samsung smartphones available. However, we do have a wide range of other smartphones from different brands that you might be interested in. Please let me know if you would like information about any specific brand or model, and I'll be happy to assist you.\r\nClient: ok, recommend me something,\nAi response: Certainly! Based on your interest in Samsung smartphones, I apologize for not having any Samsung smartphones available at the moment. However, I can recommend some alternative options that you might be interested in:\n\n1. Xiaomi 13: This smartphone offers an ultra-immersive display design with 1.61mm ultra-thin bezels, providing a boundless vision. It is also IP68 water and dust resistant, making it suitable for various scenarios. The Leica main camera with a professional optical lens ensures capturing great moments, and the device is powered by the leading Snapdragon 8 Gen 2 for excellent performance. \n\n2. Xiaomi Redmi 12 128GB - Black - Unlocked - Dual-SIM: This smartphone features a large storage capacity of 128GB, allowing you to store all your files and media. It is unlocked and supports dual-SIM functionality, providing flexibility in using multiple networks. \n\nPlease let me know if you would like more information about any of these options or if there's anything else I can assist you with!\r\nClient: what price is this? give me the link,\nAi response: I apologize for the confusion. Could you please clarify which product you are referring to?", 'context': 'Unfortunately i cant find product \'samsung\'. But please checkout our similar products: \n[{"ID":17,"post_author":"1","post_date":"2023-12-27 20:25:46","post_date_gmt":"2023-12-27 17:25:46","post_content":"<ul class=\\"a-unordered-list a-vertical a-spacing-mini\\">\\r\\n \\t<li class=\\"a-spacing-mini\\"><span class=\\"a-list-item\\">Ultra-immersive display design Light up the screen to enjoy an unrivalled experience. The 1.61mm ultra-thin bezels offer a boundless vision.<\\/span><\\/li>\\r\\n \\t<li class=\\"a-spacing-mini\\"><span class=\\"a-list-item\\">Built for more scenarios IP68 water and dust resistant* Born splash-proof and water-resistant, thanks to the precision manufacturing. Record special memories anytime and anywhere.<\\/span><\\/li>\\r\\n \\t<li class=\\"a-spacing-mini\\"><span class=\\"a-list-item\\">Leica main camera with professional optical lens Captures every great moment<\\/span><\\/li>\\r\\n \\t<li class=\\"a-spacing-mini\\"><span class=\\"a-list-item\\">Masterpiece performance Leading Snapdragon 8 Gen 2 Boosted performance, reduced consumption<\\/span><\\/li>\\r\\n<\\/ul>","post_title":"Xiaomi 13","post_excerpt":"","post_status":"publish","comment_status":"open","ping_status":"closed","post_password":"","post_name":"%d0%ba%d1%80%d0%be%d1%81%d1%81%d0%be%d0%b2%d0%ba%d0%b8","to_ping":"","pinged":"","post_modified":"2024-01-01 12:03:20","post_modified_gmt":"2024-01-01 09:03:20","post_content_filtered":"","post_parent":0,"guid":"http:\\/\\/wordpress\\/?post_type=product&#038;p=17","menu_order":0,"post_type":"product","post_mime_type":"","comment_count":"0","filter":"raw"},{"ID":20,"post_author":"1","post_date":"2023-12-29 11:32:59","post_date_gmt":"2023-12-29 08:32:59","post_content":"","post_title":"Xiaomi Redmi 12 128GB - Black - Unlocked - Dual-SIM","post_excerpt":"","post_status":"publish","comment_status":"open","ping_status":"closed","post_password":"","post_name":"xiaomi-12-black","to_ping":"","pinged":"","post_modified":"2023-12-29 11:45:27","post_modified_gmt":"2023-12-29 08:45:27","post_content_filtered":"","post_parent":0,"guid":"http:\\/\\/wordpress\\/?post_type=product&#038;p=20","menu_order":0,"post_type":"product","post_mime_type":"","comment_count":"0","filter":"raw"}]\r\n\r\nUnfortunately i cant find product \'this\'. But please checkout our similar products: \n[]'}
INFO:werkzeug:127.0.0.1 - - [01/Jan/2024 20:43:30] "POST /projects/e47f0f811145d03c33fd6639dc3f09c0839d0891e264d849a75df04f4d047625/KW2uCtbdOgV3cltg8W3i6JbZcQWtfy9j HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [01/Jan/2024 21:21:07] "GET /files/e47f0f811145d03c33fd6639dc3f09c0839d0891e264d849a75df04f4d047625 HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [01/Jan/2024 21:21:29] "OPTIONS /projects/e47f0f811145d03c33fd6639dc3f09c0839d0891e264d849a75df04f4d047625/XP8TJvg4XlWnP3bPqPZ7Y8sND9H1CULT HTTP/1.1" 200 -
INFO:myapp:{'api': 1, 'product_data': 'http://wordpress/wp-json/chatty/v1', 'website': 'asdf', 'id': 4, 'left_tokens': 72018, 'description': None, 'temperature': Decimal('0.00'), 'model': 'gpt-3.5-turbo', 'prompt': 'Вы — ИИ ассистент компании. Вам будут заданы вопросы о нашей компании. Вежливо отвечайте на вопросы.\r\n    Ниже мы предоставили контекстную информацию.\r\n    ---------------------\r\n    {context_str}\r\n    ---------------------\r\n    Учитывая эту информацию, ответьте, пожалуйста, на вопрос: {query_str}\r\n    ', 'response_mode': 'compact', 'user_id': 12, 'answer': None, 'context': None}
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): wordpress:80
DEBUG:urllib3.connectionpool:http://wordpress:80 "GET /wp-json/chatty/v1/shop_meta HTTP/1.1" 200 67
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.openai.com:443
DEBUG:urllib3.connectionpool:https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
INFO:myapp:[{'url_params': 'product_name=smartphone', 'is_related': 'yes', 'category': 'smartphones'}]
INFO:myapp:product_name=smartphone
INFO:myapp:prompt
INFO:myapp:You are AI assistant for a online shop. You should determine if a client is asking or information about a product in our store. It can be a question about price, availability in stock, product characteristic, comparing 2 products. In this case you should contruct query parameters based on a client question. Construct them for every mentioned product. Add sort_price parameter if required .For example product_name=item_name&color=green&size=44&sort_price=desc|asc List of available query parameters: product_name, color. product_name is a required parameter. You should use it in every query.Use only these query parameters for consructing. Add a category. List of available categories: laptops,smartphones. Write your asnwer as array of json objects. [{url_params: <url_here>, is_related: 'yes', category: <category_here> }] If the question is not related to products of the store, then your answer would be [{is_related: 'no'}] Be strict. Fix typos in product names. Dont write anything else. Your answer will be used for a next query. Client question: i am looking for a smartphone .Your answer:
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): wordpress:80
DEBUG:urllib3.connectionpool:http://wordpress:80 "GET /wp-json/chatty/v1/posts?product_name=smartphone HTTP/1.1" 200 93
INFO:myapp:api data Unfortunately i cant find product 'smartphone'. But please checkout our similar products: 
[]
DEBUG:llama_index.storage.kvstore.simple_kvstore:Loading llama_index.storage.kvstore.simple_kvstore from projects/4/data\docstore.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/docstore.json
DEBUG:llama_index.storage.kvstore.simple_kvstore:Loading llama_index.storage.kvstore.simple_kvstore from projects/4/data\index_store.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/index_store.json
DEBUG:llama_index.vector_stores.simple:Loading llama_index.vector_stores.simple from projects/4/data\vector_store.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/vector_store.json
DEBUG:llama_index.graph_stores.simple:Loading llama_index.graph_stores.simple from projects/4/data\graph_store.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/graph_store.json
INFO:myapp:Final prompt: Вы — ИИ ассистент компании. Вам будут заданы вопросы о нашей компании. Вежливо отвечайте на вопросы.
    Ниже мы предоставили контекстную информацию.
    ---------------------
    {context_str}
    ---------------------
    Учитывая эту информацию, ответьте, пожалуйста, на вопрос: {query_str}
    
 History of conversation with the client: None. 
 Information about relative products Unfortunately i cant find product 'smartphone'. But please checkout our similar products: 
[]
INFO:llama_index.indices.loading:Loading indices with ids: ['vector_index']
DEBUG:openai:message='Request to OpenAI API' method=post path=https://api.openai.com/v1/embeddings
DEBUG:openai:api_version=None data='{"input": ["i am looking for a smartphone"], "model": "text-embedding-ada-002", "encoding_format": "base64"}' message='Post details'
DEBUG:urllib3.util.retry:Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.openai.com:443
DEBUG:urllib3.connectionpool:https://api.openai.com:443 "POST /v1/embeddings HTTP/1.1" 200 None
DEBUG:openai:message='OpenAI API response' path=https://api.openai.com/v1/embeddings processing_ms=17 request_id=e6546242eadacacba63185f9452c546b response_code=200
DEBUG:llama_index.indices.utils:> Top 1 nodes:
> [Node 909c5dd5-e87e-4999-a794-761f96e44168] [Similarity score:             -0.02904] Welcome to TechHub, your ultimate destination for cutting-edge technology and innovation! At Tech...
DEBUG:openai:message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
DEBUG:openai:api_version=None data='{"messages": [{"role": "system", "content": "Context information is below.\\n--------------------\\nWelcome to TechHub, your ultimate destination for cutting-edge technology and innovation! At TechHub, we pride ourselves on being a premier online store dedicated to providing a curated selection of the latest and greatest in tech gadgets, including laptops, smartphones, and more.\\n\\nAbout Us:\\n\\nAt the heart of TechHub is a passion for technology and a commitment to delivering top-notch products that seamlessly blend style, functionality, and performance. With a team of tech enthusiasts, we understand the ever-evolving nature of the digital landscape and strive to stay at the forefront of the latest trends and advancements.\\n\\nOur Mission:\\n\\nOur mission at TechHub is to empower our customers with the best tools and devices that enhance their digital lifestyle. Whether you\'re a professional looking for a high-performance laptop to boost productivity or a smartphone aficionado seeking the latest flagship model, we\'ve got you covered. We believe that technology should not only meet but exceed your expectations, making every interaction with your devices a seamless and enjoyable experience.\\n\\nQuality Assurance:\\n\\nTechHub is committed to delivering products of the highest quality. We carefully curate our inventory, partnering with leading brands known for their commitment to excellence. Each product undergoes rigorous testing to ensure reliability, durability, and top-notch performance. Our dedication to quality assurance is reflected in every item we offer.\\n\\nCustomer-Centric Approach:\\n\\nAt TechHub, our customers are at the core of everything we do. We prioritize your satisfaction and strive to provide an unparalleled shopping experience. Our customer support team is ready to assist you at every step, from product inquiries to after-sales support. We value your feedback and continuously work to improve our services based on your needs.\\n\\nSecure Shopping:\\n\\nYour online security is our priority. TechHub employs state-of-the-art encryption technology to ensure that your personal information remains secure and protected. Shop with confidence, knowing that your data is in safe hands.\\n\\nExplore the world of innovation at TechHub, where technology meets lifestyle. Discover the perfect blend of style and functionality with our carefully curated selection of laptops, smartphones, and other cutting-edge gadgets. Join us on this exciting journey, and let\'s embrace the future together!\\n--------------------\\n\\u0412\\u044b \\u2014 \\u0418\\u0418 \\u0430\\u0441\\u0441\\u0438\\u0441\\u0442\\u0435\\u043d\\u0442 \\u043a\\u043e\\u043c\\u043f\\u0430\\u043d\\u0438\\u0438. \\u0412\\u0430\\u043c \\u0431\\u0443\\u0434\\u0443\\u0442 \\u0437\\u0430\\u0434\\u0430\\u043d\\u044b \\u0432\\u043e\\u043f\\u0440\\u043e\\u0441\\u044b \\u043e \\u043d\\u0430\\u0448\\u0435\\u0439 \\u043a\\u043e\\u043c\\u043f\\u0430\\u043d\\u0438\\u0438. \\u0412\\u0435\\u0436\\u043b\\u0438\\u0432\\u043e \\u043e\\u0442\\u0432\\u0435\\u0447\\u0430\\u0439\\u0442\\u0435 \\u043d\\u0430 \\u0432\\u043e\\u043f\\u0440\\u043e\\u0441\\u044b.\\r\\n    \\u041d\\u0438\\u0436\\u0435 \\u043c\\u044b \\u043f\\u0440\\u0435\\u0434\\u043e\\u0441\\u0442\\u0430\\u0432\\u0438\\u043b\\u0438 \\u043a\\u043e\\u043d\\u0442\\u0435\\u043a\\u0441\\u0442\\u043d\\u0443\\u044e \\u0438\\u043d\\u0444\\u043e\\u0440\\u043c\\u0430\\u0446\\u0438\\u044e.\\r\\n    ---------------------\\r\\n    {context_str}\\r\\n    ---------------------\\r\\n    \\u0423\\u0447\\u0438\\u0442\\u044b\\u0432\\u0430\\u044f \\u044d\\u0442\\u0443 \\u0438\\u043d\\u0444\\u043e\\u0440\\u043c\\u0430\\u0446\\u0438\\u044e, \\u043e\\u0442\\u0432\\u0435\\u0442\\u044c\\u0442\\u0435, \\u043f\\u043e\\u0436\\u0430\\u043b\\u0443\\u0439\\u0441\\u0442\\u0430, \\u043d\\u0430 \\u0432\\u043e\\u043f\\u0440\\u043e\\u0441: {query_str}\\r\\n    \\n History of conversation with the client: None. \\n Information about relative products Unfortunately i cant find product \'smartphone\'. But please checkout our similar products: \\n[]"}, {"role": "user", "content": "i am looking for a smartphone"}], "stream": false, "model": "gpt-3.5-turbo", "temperature": 0, "max_tokens": null}' message='Post details'
DEBUG:urllib3.connectionpool:https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
DEBUG:openai:message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=2610 request_id=aae83c567502def31a69a7839400ffed response_code=200
INFO:myapp:{'api': 1, 'product_data': 'http://wordpress/wp-json/chatty/v1', 'website': 'asdf', 'id': 4, 'left_tokens': 72018, 'description': None, 'temperature': Decimal('0.00'), 'model': 'gpt-3.5-turbo', 'prompt': 'Вы — ИИ ассистент компании. Вам будут заданы вопросы о нашей компании. Вежливо отвечайте на вопросы.\r\n    Ниже мы предоставили контекстную информацию.\r\n    ---------------------\r\n    {context_str}\r\n    ---------------------\r\n    Учитывая эту информацию, ответьте, пожалуйста, на вопрос: {query_str}\r\n    ', 'response_mode': 'compact', 'user_id': 12, 'answer': None, 'context': None}
INFO:werkzeug:127.0.0.1 - - [01/Jan/2024 21:21:36] "POST /projects/e47f0f811145d03c33fd6639dc3f09c0839d0891e264d849a75df04f4d047625/XP8TJvg4XlWnP3bPqPZ7Y8sND9H1CULT HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [01/Jan/2024 21:34:52] "GET /files/e47f0f811145d03c33fd6639dc3f09c0839d0891e264d849a75df04f4d047625 HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [01/Jan/2024 21:35:02] "OPTIONS /projects/e47f0f811145d03c33fd6639dc3f09c0839d0891e264d849a75df04f4d047625/XP8TJvg4XlWnP3bPqPZ7Y8sND9H1CULT HTTP/1.1" 200 -
INFO:myapp:{'api': 1, 'product_data': 'http://wordpress/wp-json/chatty/v1', 'website': 'asdf', 'id': 4, 'left_tokens': 71340, 'description': None, 'temperature': Decimal('0.00'), 'model': 'gpt-3.5-turbo', 'prompt': 'Вы — ИИ ассистент компании. Вам будут заданы вопросы о нашей компании. Вежливо отвечайте на вопросы.\r\n    Ниже мы предоставили контекстную информацию.\r\n    ---------------------\r\n    {context_str}\r\n    ---------------------\r\n    Учитывая эту информацию, ответьте, пожалуйста, на вопрос: {query_str}\r\n    ', 'response_mode': 'compact', 'user_id': 12, 'answer': 'Client: i am looking for a smartphone,\nAi response: Thank you for your interest in our products! While we don\'t have a specific product called "smartphone," we do offer a wide range of similar products such as mobile phones and other cutting-edge gadgets. Our curated selection includes top brands known for their quality and performance. Please feel free to browse our website to explore the latest mobile phone options available. If you have any specific requirements or questions, our customer support team is here to assist you.', 'context': "Unfortunately i cant find product 'smartphone'. But please checkout our similar products: \n[]"}
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): wordpress:80
DEBUG:urllib3.connectionpool:http://wordpress:80 "GET /wp-json/chatty/v1/shop_meta HTTP/1.1" 200 67
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.openai.com:443
DEBUG:urllib3.connectionpool:https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
INFO:myapp:[{'url_params': 'product_name=smartphone', 'is_related': 'yes', 'category': 'smartphones'}]
INFO:myapp:product_name=smartphone
INFO:myapp:prompt
INFO:myapp:You are AI assistant for a online shop. You should determine if a client is asking or information about a product in our store. It can be a question about price, availability in stock, product characteristic, comparing 2 products. In this case you should contruct query parameters based on a client question. Construct them for every mentioned product. Add sort_price parameter if required .For example product_name=item_name&color=green&size=44&sort_price=desc|asc List of available query parameters: product_name, color. product_name is a required parameter. You should use it in every query.Use only these query parameters for consructing. Add a category. List of available categories: laptops,smartphones. Write your asnwer as array of json objects. [{url_params: <url_here>, is_related: 'yes', category: <category_here> }] If the question is not related to products of the store, then your answer would be [{is_related: 'no'}] Be strict. Fix typos in product names. Dont write anything else. Your answer will be used for a next query. Client question: i am looking for a smartphone .Your answer:
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): wordpress:80
DEBUG:urllib3.connectionpool:http://wordpress:80 "GET /wp-json/chatty/v1/posts?product_name=smartphone HTTP/1.1" 200 173
INFO:myapp:api data Information for AI Assistant: Our Api can't find product 'smartphone'. Advise the client to use search and filters in the website if he is still interested in this product 

DEBUG:llama_index.storage.kvstore.simple_kvstore:Loading llama_index.storage.kvstore.simple_kvstore from projects/4/data\docstore.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/docstore.json
DEBUG:llama_index.storage.kvstore.simple_kvstore:Loading llama_index.storage.kvstore.simple_kvstore from projects/4/data\index_store.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/index_store.json
DEBUG:llama_index.vector_stores.simple:Loading llama_index.vector_stores.simple from projects/4/data\vector_store.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/vector_store.json
DEBUG:llama_index.graph_stores.simple:Loading llama_index.graph_stores.simple from projects/4/data\graph_store.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/graph_store.json
INFO:myapp:Final prompt: Вы — ИИ ассистент компании. Вам будут заданы вопросы о нашей компании. Вежливо отвечайте на вопросы.
    Ниже мы предоставили контекстную информацию.
    ---------------------
    {context_str}
    ---------------------
    Учитывая эту информацию, ответьте, пожалуйста, на вопрос: {query_str}
    
 History of conversation with the client: Client: i am looking for a smartphone,
Ai response: Thank you for your interest in our products! While we don't have a specific product called "smartphone," we do offer a wide range of similar products such as mobile phones and other cutting-edge gadgets. Our curated selection includes top brands known for their quality and performance. Please feel free to browse our website to explore the latest mobile phone options available. If you have any specific requirements or questions, our customer support team is here to assist you.. 
 Information about relative products Unfortunately i cant find product 'smartphone'. But please checkout our similar products: 
[]Information for AI Assistant: Our Api can't find product 'smartphone'. Advise the client to use search and filters in the website if he is still interested in this product 

INFO:llama_index.indices.loading:Loading indices with ids: ['vector_index']
DEBUG:openai:message='Request to OpenAI API' method=post path=https://api.openai.com/v1/embeddings
DEBUG:openai:api_version=None data='{"input": ["i am looking for a smartphone"], "model": "text-embedding-ada-002", "encoding_format": "base64"}' message='Post details'
DEBUG:urllib3.util.retry:Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.openai.com:443
DEBUG:urllib3.connectionpool:https://api.openai.com:443 "POST /v1/embeddings HTTP/1.1" 200 None
DEBUG:openai:message='OpenAI API response' path=https://api.openai.com/v1/embeddings processing_ms=17 request_id=69e6bb4387bce7da284ed3f058c8977a response_code=200
DEBUG:llama_index.indices.utils:> Top 1 nodes:
> [Node 909c5dd5-e87e-4999-a794-761f96e44168] [Similarity score:             -0.02904] Welcome to TechHub, your ultimate destination for cutting-edge technology and innovation! At Tech...
DEBUG:openai:message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
DEBUG:openai:api_version=None data='{"messages": [{"role": "system", "content": "Context information is below.\\n--------------------\\nWelcome to TechHub, your ultimate destination for cutting-edge technology and innovation! At TechHub, we pride ourselves on being a premier online store dedicated to providing a curated selection of the latest and greatest in tech gadgets, including laptops, smartphones, and more.\\n\\nAbout Us:\\n\\nAt the heart of TechHub is a passion for technology and a commitment to delivering top-notch products that seamlessly blend style, functionality, and performance. With a team of tech enthusiasts, we understand the ever-evolving nature of the digital landscape and strive to stay at the forefront of the latest trends and advancements.\\n\\nOur Mission:\\n\\nOur mission at TechHub is to empower our customers with the best tools and devices that enhance their digital lifestyle. Whether you\'re a professional looking for a high-performance laptop to boost productivity or a smartphone aficionado seeking the latest flagship model, we\'ve got you covered. We believe that technology should not only meet but exceed your expectations, making every interaction with your devices a seamless and enjoyable experience.\\n\\nQuality Assurance:\\n\\nTechHub is committed to delivering products of the highest quality. We carefully curate our inventory, partnering with leading brands known for their commitment to excellence. Each product undergoes rigorous testing to ensure reliability, durability, and top-notch performance. Our dedication to quality assurance is reflected in every item we offer.\\n\\nCustomer-Centric Approach:\\n\\nAt TechHub, our customers are at the core of everything we do. We prioritize your satisfaction and strive to provide an unparalleled shopping experience. Our customer support team is ready to assist you at every step, from product inquiries to after-sales support. We value your feedback and continuously work to improve our services based on your needs.\\n\\nSecure Shopping:\\n\\nYour online security is our priority. TechHub employs state-of-the-art encryption technology to ensure that your personal information remains secure and protected. Shop with confidence, knowing that your data is in safe hands.\\n\\nExplore the world of innovation at TechHub, where technology meets lifestyle. Discover the perfect blend of style and functionality with our carefully curated selection of laptops, smartphones, and other cutting-edge gadgets. Join us on this exciting journey, and let\'s embrace the future together!\\n--------------------\\n\\u0412\\u044b \\u2014 \\u0418\\u0418 \\u0430\\u0441\\u0441\\u0438\\u0441\\u0442\\u0435\\u043d\\u0442 \\u043a\\u043e\\u043c\\u043f\\u0430\\u043d\\u0438\\u0438. \\u0412\\u0430\\u043c \\u0431\\u0443\\u0434\\u0443\\u0442 \\u0437\\u0430\\u0434\\u0430\\u043d\\u044b \\u0432\\u043e\\u043f\\u0440\\u043e\\u0441\\u044b \\u043e \\u043d\\u0430\\u0448\\u0435\\u0439 \\u043a\\u043e\\u043c\\u043f\\u0430\\u043d\\u0438\\u0438. \\u0412\\u0435\\u0436\\u043b\\u0438\\u0432\\u043e \\u043e\\u0442\\u0432\\u0435\\u0447\\u0430\\u0439\\u0442\\u0435 \\u043d\\u0430 \\u0432\\u043e\\u043f\\u0440\\u043e\\u0441\\u044b.\\r\\n    \\u041d\\u0438\\u0436\\u0435 \\u043c\\u044b \\u043f\\u0440\\u0435\\u0434\\u043e\\u0441\\u0442\\u0430\\u0432\\u0438\\u043b\\u0438 \\u043a\\u043e\\u043d\\u0442\\u0435\\u043a\\u0441\\u0442\\u043d\\u0443\\u044e \\u0438\\u043d\\u0444\\u043e\\u0440\\u043c\\u0430\\u0446\\u0438\\u044e.\\r\\n    ---------------------\\r\\n    {context_str}\\r\\n    ---------------------\\r\\n    \\u0423\\u0447\\u0438\\u0442\\u044b\\u0432\\u0430\\u044f \\u044d\\u0442\\u0443 \\u0438\\u043d\\u0444\\u043e\\u0440\\u043c\\u0430\\u0446\\u0438\\u044e, \\u043e\\u0442\\u0432\\u0435\\u0442\\u044c\\u0442\\u0435, \\u043f\\u043e\\u0436\\u0430\\u043b\\u0443\\u0439\\u0441\\u0442\\u0430, \\u043d\\u0430 \\u0432\\u043e\\u043f\\u0440\\u043e\\u0441: {query_str}\\r\\n    \\n History of conversation with the client: Client: i am looking for a smartphone,\\nAi response: Thank you for your interest in our products! While we don\'t have a specific product called \\"smartphone,\\" we do offer a wide range of similar products such as mobile phones and other cutting-edge gadgets. Our curated selection includes top brands known for their quality and performance. Please feel free to browse our website to explore the latest mobile phone options available. If you have any specific requirements or questions, our customer support team is here to assist you.. \\n Information about relative products Unfortunately i cant find product \'smartphone\'. But please checkout our similar products: \\n[]Information for AI Assistant: Our Api can\'t find product \'smartphone\'. Advise the client to use search and filters in the website if he is still interested in this product"}, {"role": "user", "content": "i am looking for a smartphone"}], "stream": false, "model": "gpt-3.5-turbo", "temperature": 0, "max_tokens": null}' message='Post details'
DEBUG:urllib3.connectionpool:https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
DEBUG:openai:message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=2290 request_id=69cf1332624377b03ad6b44edc14ab10 response_code=200
INFO:myapp:{'api': 1, 'product_data': 'http://wordpress/wp-json/chatty/v1', 'website': 'asdf', 'id': 4, 'left_tokens': 71340, 'description': None, 'temperature': Decimal('0.00'), 'model': 'gpt-3.5-turbo', 'prompt': 'Вы — ИИ ассистент компании. Вам будут заданы вопросы о нашей компании. Вежливо отвечайте на вопросы.\r\n    Ниже мы предоставили контекстную информацию.\r\n    ---------------------\r\n    {context_str}\r\n    ---------------------\r\n    Учитывая эту информацию, ответьте, пожалуйста, на вопрос: {query_str}\r\n    ', 'response_mode': 'compact', 'user_id': 12, 'answer': 'Client: i am looking for a smartphone,\nAi response: Thank you for your interest in our products! While we don\'t have a specific product called "smartphone," we do offer a wide range of similar products such as mobile phones and other cutting-edge gadgets. Our curated selection includes top brands known for their quality and performance. Please feel free to browse our website to explore the latest mobile phone options available. If you have any specific requirements or questions, our customer support team is here to assist you.', 'context': "Unfortunately i cant find product 'smartphone'. But please checkout our similar products: \n[]"}
INFO:werkzeug:127.0.0.1 - - [01/Jan/2024 21:35:13] "POST /projects/e47f0f811145d03c33fd6639dc3f09c0839d0891e264d849a75df04f4d047625/XP8TJvg4XlWnP3bPqPZ7Y8sND9H1CULT HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [01/Jan/2024 21:35:29] "GET /files/e47f0f811145d03c33fd6639dc3f09c0839d0891e264d849a75df04f4d047625 HTTP/1.1" 200 -
DEBUG:root:This is a debug message
DEBUG:celery.utils.functional:
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

DEBUG:celery.utils.functional:
def sendEmbeddingRequest(user_id, total_tokens):
    return 1

DEBUG:celery.utils.functional:
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

DEBUG:celery.utils.functional:
def xmap(task, it):
    return 1

DEBUG:celery.utils.functional:
def backend_cleanup():
    return 1

DEBUG:celery.utils.functional:
def chain(*args, **kwargs):
    return 1

DEBUG:celery.utils.functional:
def send_chat_request(user_id, project_id, session, total_tokens, answer, context):
    return 1

DEBUG:celery.utils.functional:
def xstarmap(task, it):
    return 1

DEBUG:celery.utils.functional:
def accumulate(self, *args, **kwargs):
    return 1

DEBUG:celery.utils.functional:
def set_vector_index_task(self, token):
    return 1

DEBUG:celery.utils.functional:
def process_set_vector_index(self, token, task_id):
    return 1

DEBUG:celery.utils.functional:
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

DEBUG:celery.utils.functional:
def chunks(task, it, n):
    return 1

INFO:werkzeug:127.0.0.1 - - [01/Jan/2024 21:36:05] "OPTIONS /projects/e47f0f811145d03c33fd6639dc3f09c0839d0891e264d849a75df04f4d047625/NyDN6SBdmYJ7QhC8B49NranuqJpeehnj HTTP/1.1" 200 -
INFO:myapp:{'api': 1, 'product_data': 'http://wordpress/wp-json/chatty/v1', 'website': 'asdf', 'id': 4, 'left_tokens': 70527, 'description': None, 'temperature': Decimal('0.00'), 'model': 'gpt-3.5-turbo', 'prompt': 'Вы — ИИ ассистент компании. Вам будут заданы вопросы о нашей компании. Вежливо отвечайте на вопросы.\r\n    Ниже мы предоставили контекстную информацию.\r\n    ---------------------\r\n    {context_str}\r\n    ---------------------\r\n    Учитывая эту информацию, ответьте, пожалуйста, на вопрос: {query_str}\r\n    ', 'response_mode': 'compact', 'user_id': 12, 'answer': None, 'context': None}
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): wordpress:80
DEBUG:urllib3.connectionpool:http://wordpress:80 "GET /wp-json/chatty/v1/shop_meta HTTP/1.1" 200 67
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.openai.com:443
DEBUG:urllib3.connectionpool:https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
INFO:myapp:[{'url_params': 'product_name=smartphone', 'is_related': 'yes', 'category': 'smartphones'}]
INFO:myapp:product_name=smartphone
INFO:myapp:prompt
INFO:myapp:You are AI assistant for a online shop. You should determine if a client is asking or information about a product in our store. It can be a question about price, availability in stock, product characteristic, comparing 2 products. In this case you should contruct query parameters based on a client question. Construct them for every mentioned product. Add sort_price parameter if required .For example product_name=item_name&color=green&size=44&sort_price=desc|asc List of available query parameters: product_name, color. product_name is a required parameter. You should use it in every query.Use only these query parameters for consructing. Add a category. List of available categories: laptops,smartphones. Write your asnwer as array of json objects. [{url_params: <url_here>, is_related: 'yes', category: <category_here> }] If the question is not related to products of the store, then your answer would be [{is_related: 'no'}] Be strict. Fix typos in product names. Dont write anything else. Your answer will be used for a next query. Client question: i am looking for a smartphone .Your answer:
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): wordpress:80
DEBUG:urllib3.connectionpool:http://wordpress:80 "GET /wp-json/chatty/v1/posts?product_name=smartphone HTTP/1.1" 200 173
INFO:myapp:api data Information for AI Assistant: Our Api can't find product 'smartphone'. Advise the client to use search and filters in the website if he is still interested in this product 

DEBUG:llama_index.storage.kvstore.simple_kvstore:Loading llama_index.storage.kvstore.simple_kvstore from projects/4/data\docstore.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/docstore.json
DEBUG:llama_index.storage.kvstore.simple_kvstore:Loading llama_index.storage.kvstore.simple_kvstore from projects/4/data\index_store.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/index_store.json
DEBUG:llama_index.vector_stores.simple:Loading llama_index.vector_stores.simple from projects/4/data\vector_store.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/vector_store.json
DEBUG:llama_index.graph_stores.simple:Loading llama_index.graph_stores.simple from projects/4/data\graph_store.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/graph_store.json
INFO:myapp:Final prompt: Вы — ИИ ассистент компании. Вам будут заданы вопросы о нашей компании. Вежливо отвечайте на вопросы.
    Ниже мы предоставили контекстную информацию.
    ---------------------
    {context_str}
    ---------------------
    Учитывая эту информацию, ответьте, пожалуйста, на вопрос: {query_str}
    
 History of conversation with the client: None. 
 Information about relative products Information for AI Assistant: Our Api can't find product 'smartphone'. Advise the client to use search and filters in the website if he is still interested in this product 

INFO:llama_index.indices.loading:Loading indices with ids: ['vector_index']
DEBUG:openai:message='Request to OpenAI API' method=post path=https://api.openai.com/v1/embeddings
DEBUG:openai:api_version=None data='{"input": ["i am looking for a smartphone"], "model": "text-embedding-ada-002", "encoding_format": "base64"}' message='Post details'
DEBUG:urllib3.util.retry:Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.openai.com:443
DEBUG:urllib3.connectionpool:https://api.openai.com:443 "POST /v1/embeddings HTTP/1.1" 200 None
DEBUG:openai:message='OpenAI API response' path=https://api.openai.com/v1/embeddings processing_ms=18 request_id=1514b1da34af19a3a1fbdf69ac87063f response_code=200
DEBUG:llama_index.indices.utils:> Top 1 nodes:
> [Node 909c5dd5-e87e-4999-a794-761f96e44168] [Similarity score:             -0.02904] Welcome to TechHub, your ultimate destination for cutting-edge technology and innovation! At Tech...
DEBUG:openai:message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
DEBUG:openai:api_version=None data='{"messages": [{"role": "system", "content": "Context information is below.\\n--------------------\\nWelcome to TechHub, your ultimate destination for cutting-edge technology and innovation! At TechHub, we pride ourselves on being a premier online store dedicated to providing a curated selection of the latest and greatest in tech gadgets, including laptops, smartphones, and more.\\n\\nAbout Us:\\n\\nAt the heart of TechHub is a passion for technology and a commitment to delivering top-notch products that seamlessly blend style, functionality, and performance. With a team of tech enthusiasts, we understand the ever-evolving nature of the digital landscape and strive to stay at the forefront of the latest trends and advancements.\\n\\nOur Mission:\\n\\nOur mission at TechHub is to empower our customers with the best tools and devices that enhance their digital lifestyle. Whether you\'re a professional looking for a high-performance laptop to boost productivity or a smartphone aficionado seeking the latest flagship model, we\'ve got you covered. We believe that technology should not only meet but exceed your expectations, making every interaction with your devices a seamless and enjoyable experience.\\n\\nQuality Assurance:\\n\\nTechHub is committed to delivering products of the highest quality. We carefully curate our inventory, partnering with leading brands known for their commitment to excellence. Each product undergoes rigorous testing to ensure reliability, durability, and top-notch performance. Our dedication to quality assurance is reflected in every item we offer.\\n\\nCustomer-Centric Approach:\\n\\nAt TechHub, our customers are at the core of everything we do. We prioritize your satisfaction and strive to provide an unparalleled shopping experience. Our customer support team is ready to assist you at every step, from product inquiries to after-sales support. We value your feedback and continuously work to improve our services based on your needs.\\n\\nSecure Shopping:\\n\\nYour online security is our priority. TechHub employs state-of-the-art encryption technology to ensure that your personal information remains secure and protected. Shop with confidence, knowing that your data is in safe hands.\\n\\nExplore the world of innovation at TechHub, where technology meets lifestyle. Discover the perfect blend of style and functionality with our carefully curated selection of laptops, smartphones, and other cutting-edge gadgets. Join us on this exciting journey, and let\'s embrace the future together!\\n--------------------\\n\\u0412\\u044b \\u2014 \\u0418\\u0418 \\u0430\\u0441\\u0441\\u0438\\u0441\\u0442\\u0435\\u043d\\u0442 \\u043a\\u043e\\u043c\\u043f\\u0430\\u043d\\u0438\\u0438. \\u0412\\u0430\\u043c \\u0431\\u0443\\u0434\\u0443\\u0442 \\u0437\\u0430\\u0434\\u0430\\u043d\\u044b \\u0432\\u043e\\u043f\\u0440\\u043e\\u0441\\u044b \\u043e \\u043d\\u0430\\u0448\\u0435\\u0439 \\u043a\\u043e\\u043c\\u043f\\u0430\\u043d\\u0438\\u0438. \\u0412\\u0435\\u0436\\u043b\\u0438\\u0432\\u043e \\u043e\\u0442\\u0432\\u0435\\u0447\\u0430\\u0439\\u0442\\u0435 \\u043d\\u0430 \\u0432\\u043e\\u043f\\u0440\\u043e\\u0441\\u044b.\\r\\n    \\u041d\\u0438\\u0436\\u0435 \\u043c\\u044b \\u043f\\u0440\\u0435\\u0434\\u043e\\u0441\\u0442\\u0430\\u0432\\u0438\\u043b\\u0438 \\u043a\\u043e\\u043d\\u0442\\u0435\\u043a\\u0441\\u0442\\u043d\\u0443\\u044e \\u0438\\u043d\\u0444\\u043e\\u0440\\u043c\\u0430\\u0446\\u0438\\u044e.\\r\\n    ---------------------\\r\\n    {context_str}\\r\\n    ---------------------\\r\\n    \\u0423\\u0447\\u0438\\u0442\\u044b\\u0432\\u0430\\u044f \\u044d\\u0442\\u0443 \\u0438\\u043d\\u0444\\u043e\\u0440\\u043c\\u0430\\u0446\\u0438\\u044e, \\u043e\\u0442\\u0432\\u0435\\u0442\\u044c\\u0442\\u0435, \\u043f\\u043e\\u0436\\u0430\\u043b\\u0443\\u0439\\u0441\\u0442\\u0430, \\u043d\\u0430 \\u0432\\u043e\\u043f\\u0440\\u043e\\u0441: {query_str}\\r\\n    \\n History of conversation with the client: None. \\n Information about relative products Information for AI Assistant: Our Api can\'t find product \'smartphone\'. Advise the client to use search and filters in the website if he is still interested in this product"}, {"role": "user", "content": "i am looking for a smartphone"}], "stream": false, "model": "gpt-3.5-turbo", "temperature": 0, "max_tokens": null}' message='Post details'
DEBUG:urllib3.connectionpool:https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
DEBUG:openai:message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=2673 request_id=e24c0c92d161231a9870475fbefafdfb response_code=200
INFO:myapp:{'api': 1, 'product_data': 'http://wordpress/wp-json/chatty/v1', 'website': 'asdf', 'id': 4, 'left_tokens': 70527, 'description': None, 'temperature': Decimal('0.00'), 'model': 'gpt-3.5-turbo', 'prompt': 'Вы — ИИ ассистент компании. Вам будут заданы вопросы о нашей компании. Вежливо отвечайте на вопросы.\r\n    Ниже мы предоставили контекстную информацию.\r\n    ---------------------\r\n    {context_str}\r\n    ---------------------\r\n    Учитывая эту информацию, ответьте, пожалуйста, на вопрос: {query_str}\r\n    ', 'response_mode': 'compact', 'user_id': 12, 'answer': None, 'context': None}
INFO:werkzeug:127.0.0.1 - - [01/Jan/2024 21:36:11] "POST /projects/e47f0f811145d03c33fd6639dc3f09c0839d0891e264d849a75df04f4d047625/NyDN6SBdmYJ7QhC8B49NranuqJpeehnj HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [01/Jan/2024 21:37:38] "GET /files/e47f0f811145d03c33fd6639dc3f09c0839d0891e264d849a75df04f4d047625 HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [01/Jan/2024 21:37:49] "GET /files/e47f0f811145d03c33fd6639dc3f09c0839d0891e264d849a75df04f4d047625 HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [01/Jan/2024 21:37:52] "OPTIONS /projects/e47f0f811145d03c33fd6639dc3f09c0839d0891e264d849a75df04f4d047625/ZQtzUu6JYfBSkpCRUfSrCFekwEs1Tbtt HTTP/1.1" 200 -
INFO:myapp:{'api': 1, 'product_data': 'http://wordpress/wp-json/chatty/v1', 'website': 'asdf', 'id': 4, 'left_tokens': 69812, 'description': None, 'temperature': Decimal('0.00'), 'model': 'gpt-3.5-turbo', 'prompt': 'Вы — ИИ ассистент компании. Вам будут заданы вопросы о нашей компании. Вежливо отвечайте на вопросы.\r\n    Ниже мы предоставили контекстную информацию.\r\n    ---------------------\r\n    {context_str}\r\n    ---------------------\r\n    Учитывая эту информацию, ответьте, пожалуйста, на вопрос: {query_str}\r\n    ', 'response_mode': 'compact', 'user_id': 12, 'answer': None, 'context': None}
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): wordpress:80
DEBUG:urllib3.connectionpool:http://wordpress:80 "GET /wp-json/chatty/v1/shop_meta HTTP/1.1" 200 67
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.openai.com:443
DEBUG:urllib3.connectionpool:https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
INFO:myapp:[{'url_params': 'product_name=smartphone', 'is_related': 'yes', 'category': 'smartphones'}]
INFO:myapp:product_name=smartphone
INFO:myapp:prompt
INFO:myapp:You are AI assistant for a online shop. You should determine if a client is asking or information about a product in our store. It can be a question about price, availability in stock, product characteristic, comparing 2 products. In this case you should contruct query parameters based on a client question. Construct them for every mentioned product. Add sort_price parameter if required .For example product_name=item_name&color=green&size=44&sort_price=desc|asc List of available query parameters: product_name, color. product_name is a required parameter. You should use it in every query.Use only these query parameters for consructing. Add a category. List of available categories: laptops,smartphones. Write your asnwer as array of json objects. [{url_params: <url_here>, is_related: 'yes', category: <category_here> }] If the question is not related to products of the store, then your answer would be [{is_related: 'no'}] Be strict. Fix typos in product names. Dont write anything else. Your answer will be used for a next query. Client question: i am looking for a smartphone .Your answer:
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): wordpress:80
DEBUG:urllib3.connectionpool:http://wordpress:80 "GET /wp-json/chatty/v1/posts?product_name=smartphone HTTP/1.1" 200 175
INFO:myapp:api data Information for AI Assistant: 'smartphone' is not found in the database. Advise the client to use search and filters in the website if he is still interested in this product 

DEBUG:llama_index.storage.kvstore.simple_kvstore:Loading llama_index.storage.kvstore.simple_kvstore from projects/4/data\docstore.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/docstore.json
DEBUG:llama_index.storage.kvstore.simple_kvstore:Loading llama_index.storage.kvstore.simple_kvstore from projects/4/data\index_store.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/index_store.json
DEBUG:llama_index.vector_stores.simple:Loading llama_index.vector_stores.simple from projects/4/data\vector_store.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/vector_store.json
DEBUG:llama_index.graph_stores.simple:Loading llama_index.graph_stores.simple from projects/4/data\graph_store.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/graph_store.json
INFO:myapp:Final prompt: Вы — ИИ ассистент компании. Вам будут заданы вопросы о нашей компании. Вежливо отвечайте на вопросы.
    Ниже мы предоставили контекстную информацию.
    ---------------------
    {context_str}
    ---------------------
    Учитывая эту информацию, ответьте, пожалуйста, на вопрос: {query_str}
    
 History of conversation with the client: None. 
 Information about relative products Information for AI Assistant: 'smartphone' is not found in the database. Advise the client to use search and filters in the website if he is still interested in this product 

INFO:llama_index.indices.loading:Loading indices with ids: ['vector_index']
DEBUG:openai:message='Request to OpenAI API' method=post path=https://api.openai.com/v1/embeddings
DEBUG:openai:api_version=None data='{"input": ["i am looking for a smartphone"], "model": "text-embedding-ada-002", "encoding_format": "base64"}' message='Post details'
DEBUG:urllib3.util.retry:Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.openai.com:443
DEBUG:urllib3.connectionpool:https://api.openai.com:443 "POST /v1/embeddings HTTP/1.1" 200 None
DEBUG:openai:message='OpenAI API response' path=https://api.openai.com/v1/embeddings processing_ms=17 request_id=80e1ec77e71a65be18e545610de08cb1 response_code=200
DEBUG:llama_index.indices.utils:> Top 1 nodes:
> [Node 909c5dd5-e87e-4999-a794-761f96e44168] [Similarity score:             -0.02904] Welcome to TechHub, your ultimate destination for cutting-edge technology and innovation! At Tech...
DEBUG:openai:message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
DEBUG:openai:api_version=None data='{"messages": [{"role": "system", "content": "Context information is below.\\n--------------------\\nWelcome to TechHub, your ultimate destination for cutting-edge technology and innovation! At TechHub, we pride ourselves on being a premier online store dedicated to providing a curated selection of the latest and greatest in tech gadgets, including laptops, smartphones, and more.\\n\\nAbout Us:\\n\\nAt the heart of TechHub is a passion for technology and a commitment to delivering top-notch products that seamlessly blend style, functionality, and performance. With a team of tech enthusiasts, we understand the ever-evolving nature of the digital landscape and strive to stay at the forefront of the latest trends and advancements.\\n\\nOur Mission:\\n\\nOur mission at TechHub is to empower our customers with the best tools and devices that enhance their digital lifestyle. Whether you\'re a professional looking for a high-performance laptop to boost productivity or a smartphone aficionado seeking the latest flagship model, we\'ve got you covered. We believe that technology should not only meet but exceed your expectations, making every interaction with your devices a seamless and enjoyable experience.\\n\\nQuality Assurance:\\n\\nTechHub is committed to delivering products of the highest quality. We carefully curate our inventory, partnering with leading brands known for their commitment to excellence. Each product undergoes rigorous testing to ensure reliability, durability, and top-notch performance. Our dedication to quality assurance is reflected in every item we offer.\\n\\nCustomer-Centric Approach:\\n\\nAt TechHub, our customers are at the core of everything we do. We prioritize your satisfaction and strive to provide an unparalleled shopping experience. Our customer support team is ready to assist you at every step, from product inquiries to after-sales support. We value your feedback and continuously work to improve our services based on your needs.\\n\\nSecure Shopping:\\n\\nYour online security is our priority. TechHub employs state-of-the-art encryption technology to ensure that your personal information remains secure and protected. Shop with confidence, knowing that your data is in safe hands.\\n\\nExplore the world of innovation at TechHub, where technology meets lifestyle. Discover the perfect blend of style and functionality with our carefully curated selection of laptops, smartphones, and other cutting-edge gadgets. Join us on this exciting journey, and let\'s embrace the future together!\\n--------------------\\n\\u0412\\u044b \\u2014 \\u0418\\u0418 \\u0430\\u0441\\u0441\\u0438\\u0441\\u0442\\u0435\\u043d\\u0442 \\u043a\\u043e\\u043c\\u043f\\u0430\\u043d\\u0438\\u0438. \\u0412\\u0430\\u043c \\u0431\\u0443\\u0434\\u0443\\u0442 \\u0437\\u0430\\u0434\\u0430\\u043d\\u044b \\u0432\\u043e\\u043f\\u0440\\u043e\\u0441\\u044b \\u043e \\u043d\\u0430\\u0448\\u0435\\u0439 \\u043a\\u043e\\u043c\\u043f\\u0430\\u043d\\u0438\\u0438. \\u0412\\u0435\\u0436\\u043b\\u0438\\u0432\\u043e \\u043e\\u0442\\u0432\\u0435\\u0447\\u0430\\u0439\\u0442\\u0435 \\u043d\\u0430 \\u0432\\u043e\\u043f\\u0440\\u043e\\u0441\\u044b.\\r\\n    \\u041d\\u0438\\u0436\\u0435 \\u043c\\u044b \\u043f\\u0440\\u0435\\u0434\\u043e\\u0441\\u0442\\u0430\\u0432\\u0438\\u043b\\u0438 \\u043a\\u043e\\u043d\\u0442\\u0435\\u043a\\u0441\\u0442\\u043d\\u0443\\u044e \\u0438\\u043d\\u0444\\u043e\\u0440\\u043c\\u0430\\u0446\\u0438\\u044e.\\r\\n    ---------------------\\r\\n    {context_str}\\r\\n    ---------------------\\r\\n    \\u0423\\u0447\\u0438\\u0442\\u044b\\u0432\\u0430\\u044f \\u044d\\u0442\\u0443 \\u0438\\u043d\\u0444\\u043e\\u0440\\u043c\\u0430\\u0446\\u0438\\u044e, \\u043e\\u0442\\u0432\\u0435\\u0442\\u044c\\u0442\\u0435, \\u043f\\u043e\\u0436\\u0430\\u043b\\u0443\\u0439\\u0441\\u0442\\u0430, \\u043d\\u0430 \\u0432\\u043e\\u043f\\u0440\\u043e\\u0441: {query_str}\\r\\n    \\n History of conversation with the client: None. \\n Information about relative products Information for AI Assistant: \'smartphone\' is not found in the database. Advise the client to use search and filters in the website if he is still interested in this product"}, {"role": "user", "content": "i am looking for a smartphone"}], "stream": false, "model": "gpt-3.5-turbo", "temperature": 0, "max_tokens": null}' message='Post details'
DEBUG:urllib3.connectionpool:https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
DEBUG:openai:message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=2970 request_id=92d2d5b32c01f5bdd3eefc04e6c97f82 response_code=200
INFO:myapp:{'api': 1, 'product_data': 'http://wordpress/wp-json/chatty/v1', 'website': 'asdf', 'id': 4, 'left_tokens': 69812, 'description': None, 'temperature': Decimal('0.00'), 'model': 'gpt-3.5-turbo', 'prompt': 'Вы — ИИ ассистент компании. Вам будут заданы вопросы о нашей компании. Вежливо отвечайте на вопросы.\r\n    Ниже мы предоставили контекстную информацию.\r\n    ---------------------\r\n    {context_str}\r\n    ---------------------\r\n    Учитывая эту информацию, ответьте, пожалуйста, на вопрос: {query_str}\r\n    ', 'response_mode': 'compact', 'user_id': 12, 'answer': None, 'context': None}
INFO:werkzeug:127.0.0.1 - - [01/Jan/2024 21:37:59] "POST /projects/e47f0f811145d03c33fd6639dc3f09c0839d0891e264d849a75df04f4d047625/ZQtzUu6JYfBSkpCRUfSrCFekwEs1Tbtt HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [01/Jan/2024 21:39:58] "GET /files/e47f0f811145d03c33fd6639dc3f09c0839d0891e264d849a75df04f4d047625 HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [01/Jan/2024 21:40:01] "OPTIONS /projects/e47f0f811145d03c33fd6639dc3f09c0839d0891e264d849a75df04f4d047625/FdLp3U4YgjGAxsEFmJbaZtLi6akR8Lqj HTTP/1.1" 200 -
INFO:myapp:{'api': 1, 'product_data': 'http://wordpress/wp-json/chatty/v1', 'website': 'asdf', 'id': 4, 'left_tokens': 69089, 'description': None, 'temperature': Decimal('0.00'), 'model': 'gpt-3.5-turbo', 'prompt': 'Вы — ИИ ассистент компании. Вам будут заданы вопросы о нашей компании. Вежливо отвечайте на вопросы.\r\n    Ниже мы предоставили контекстную информацию.\r\n    ---------------------\r\n    {context_str}\r\n    ---------------------\r\n    Учитывая эту информацию, ответьте, пожалуйста, на вопрос: {query_str}\r\n    ', 'response_mode': 'compact', 'user_id': 12, 'answer': None, 'context': None}
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): wordpress:80
DEBUG:urllib3.connectionpool:http://wordpress:80 "GET /wp-json/chatty/v1/shop_meta HTTP/1.1" 200 67
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.openai.com:443
DEBUG:urllib3.connectionpool:https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
INFO:myapp:[{'url_params': 'product_name=smartphone', 'is_related': 'yes', 'category': 'smartphones'}]
INFO:myapp:product_name=smartphone
INFO:myapp:prompt
INFO:myapp:You are AI assistant for a online shop. You should determine if a client is asking or information about a product in our store. It can be a question about price, availability in stock, product characteristic, comparing 2 products. In this case you should contruct query parameters based on a client question. Construct them for every mentioned product. Add sort_price parameter if required .For example product_name=item_name&color=green&size=44&sort_price=desc|asc List of available query parameters: product_name, color. product_name is a required parameter. You should use it in every query.Use only these query parameters for consructing. Add a category. List of available categories: laptops,smartphones. Write your asnwer as array of json objects. [{url_params: <url_here>, is_related: 'yes', category: <category_here> }] If the question is not related to products of the store, then your answer would be [{is_related: 'no'}] Be strict. Fix typos in product names. Dont write anything else. Your answer will be used for a next query. Client question: i am looking for a smartphone .Your answer:
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): wordpress:80
DEBUG:urllib3.connectionpool:http://wordpress:80 "GET /wp-json/chatty/v1/posts?product_name=smartphone HTTP/1.1" 200 160
INFO:myapp:api data Information for AI Assistant: 'smartphone' is not found in the database. Advise the client to use search and filters if he is still interested in this product 

DEBUG:llama_index.storage.kvstore.simple_kvstore:Loading llama_index.storage.kvstore.simple_kvstore from projects/4/data\docstore.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/docstore.json
DEBUG:llama_index.storage.kvstore.simple_kvstore:Loading llama_index.storage.kvstore.simple_kvstore from projects/4/data\index_store.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/index_store.json
DEBUG:llama_index.vector_stores.simple:Loading llama_index.vector_stores.simple from projects/4/data\vector_store.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/vector_store.json
DEBUG:llama_index.graph_stores.simple:Loading llama_index.graph_stores.simple from projects/4/data\graph_store.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/graph_store.json
INFO:myapp:Final prompt: Вы — ИИ ассистент компании. Вам будут заданы вопросы о нашей компании. Вежливо отвечайте на вопросы.
    Ниже мы предоставили контекстную информацию.
    ---------------------
    {context_str}
    ---------------------
    Учитывая эту информацию, ответьте, пожалуйста, на вопрос: {query_str}
    
 History of conversation with the client: None. 
 Information about relative products Information for AI Assistant: 'smartphone' is not found in the database. Advise the client to use search and filters if he is still interested in this product 

INFO:llama_index.indices.loading:Loading indices with ids: ['vector_index']
DEBUG:openai:message='Request to OpenAI API' method=post path=https://api.openai.com/v1/embeddings
DEBUG:openai:api_version=None data='{"input": ["i am looking for a smartphone"], "model": "text-embedding-ada-002", "encoding_format": "base64"}' message='Post details'
DEBUG:urllib3.util.retry:Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.openai.com:443
DEBUG:urllib3.connectionpool:https://api.openai.com:443 "POST /v1/embeddings HTTP/1.1" 200 None
DEBUG:openai:message='OpenAI API response' path=https://api.openai.com/v1/embeddings processing_ms=18 request_id=9de7d87901a0daa1c2ee8f4831a28950 response_code=200
DEBUG:llama_index.indices.utils:> Top 1 nodes:
> [Node 909c5dd5-e87e-4999-a794-761f96e44168] [Similarity score:             -0.02904] Welcome to TechHub, your ultimate destination for cutting-edge technology and innovation! At Tech...
DEBUG:openai:message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
DEBUG:openai:api_version=None data='{"messages": [{"role": "system", "content": "Context information is below.\\n--------------------\\nWelcome to TechHub, your ultimate destination for cutting-edge technology and innovation! At TechHub, we pride ourselves on being a premier online store dedicated to providing a curated selection of the latest and greatest in tech gadgets, including laptops, smartphones, and more.\\n\\nAbout Us:\\n\\nAt the heart of TechHub is a passion for technology and a commitment to delivering top-notch products that seamlessly blend style, functionality, and performance. With a team of tech enthusiasts, we understand the ever-evolving nature of the digital landscape and strive to stay at the forefront of the latest trends and advancements.\\n\\nOur Mission:\\n\\nOur mission at TechHub is to empower our customers with the best tools and devices that enhance their digital lifestyle. Whether you\'re a professional looking for a high-performance laptop to boost productivity or a smartphone aficionado seeking the latest flagship model, we\'ve got you covered. We believe that technology should not only meet but exceed your expectations, making every interaction with your devices a seamless and enjoyable experience.\\n\\nQuality Assurance:\\n\\nTechHub is committed to delivering products of the highest quality. We carefully curate our inventory, partnering with leading brands known for their commitment to excellence. Each product undergoes rigorous testing to ensure reliability, durability, and top-notch performance. Our dedication to quality assurance is reflected in every item we offer.\\n\\nCustomer-Centric Approach:\\n\\nAt TechHub, our customers are at the core of everything we do. We prioritize your satisfaction and strive to provide an unparalleled shopping experience. Our customer support team is ready to assist you at every step, from product inquiries to after-sales support. We value your feedback and continuously work to improve our services based on your needs.\\n\\nSecure Shopping:\\n\\nYour online security is our priority. TechHub employs state-of-the-art encryption technology to ensure that your personal information remains secure and protected. Shop with confidence, knowing that your data is in safe hands.\\n\\nExplore the world of innovation at TechHub, where technology meets lifestyle. Discover the perfect blend of style and functionality with our carefully curated selection of laptops, smartphones, and other cutting-edge gadgets. Join us on this exciting journey, and let\'s embrace the future together!\\n--------------------\\n\\u0412\\u044b \\u2014 \\u0418\\u0418 \\u0430\\u0441\\u0441\\u0438\\u0441\\u0442\\u0435\\u043d\\u0442 \\u043a\\u043e\\u043c\\u043f\\u0430\\u043d\\u0438\\u0438. \\u0412\\u0430\\u043c \\u0431\\u0443\\u0434\\u0443\\u0442 \\u0437\\u0430\\u0434\\u0430\\u043d\\u044b \\u0432\\u043e\\u043f\\u0440\\u043e\\u0441\\u044b \\u043e \\u043d\\u0430\\u0448\\u0435\\u0439 \\u043a\\u043e\\u043c\\u043f\\u0430\\u043d\\u0438\\u0438. \\u0412\\u0435\\u0436\\u043b\\u0438\\u0432\\u043e \\u043e\\u0442\\u0432\\u0435\\u0447\\u0430\\u0439\\u0442\\u0435 \\u043d\\u0430 \\u0432\\u043e\\u043f\\u0440\\u043e\\u0441\\u044b.\\r\\n    \\u041d\\u0438\\u0436\\u0435 \\u043c\\u044b \\u043f\\u0440\\u0435\\u0434\\u043e\\u0441\\u0442\\u0430\\u0432\\u0438\\u043b\\u0438 \\u043a\\u043e\\u043d\\u0442\\u0435\\u043a\\u0441\\u0442\\u043d\\u0443\\u044e \\u0438\\u043d\\u0444\\u043e\\u0440\\u043c\\u0430\\u0446\\u0438\\u044e.\\r\\n    ---------------------\\r\\n    {context_str}\\r\\n    ---------------------\\r\\n    \\u0423\\u0447\\u0438\\u0442\\u044b\\u0432\\u0430\\u044f \\u044d\\u0442\\u0443 \\u0438\\u043d\\u0444\\u043e\\u0440\\u043c\\u0430\\u0446\\u0438\\u044e, \\u043e\\u0442\\u0432\\u0435\\u0442\\u044c\\u0442\\u0435, \\u043f\\u043e\\u0436\\u0430\\u043b\\u0443\\u0439\\u0441\\u0442\\u0430, \\u043d\\u0430 \\u0432\\u043e\\u043f\\u0440\\u043e\\u0441: {query_str}\\r\\n    \\n History of conversation with the client: None. \\n Information about relative products Information for AI Assistant: \'smartphone\' is not found in the database. Advise the client to use search and filters if he is still interested in this product"}, {"role": "user", "content": "i am looking for a smartphone"}], "stream": false, "model": "gpt-3.5-turbo", "temperature": 0, "max_tokens": null}' message='Post details'
DEBUG:urllib3.connectionpool:https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
DEBUG:openai:message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=1970 request_id=3f2e99989ce08a5d52056f061198674d response_code=200
INFO:myapp:{'api': 1, 'product_data': 'http://wordpress/wp-json/chatty/v1', 'website': 'asdf', 'id': 4, 'left_tokens': 69089, 'description': None, 'temperature': Decimal('0.00'), 'model': 'gpt-3.5-turbo', 'prompt': 'Вы — ИИ ассистент компании. Вам будут заданы вопросы о нашей компании. Вежливо отвечайте на вопросы.\r\n    Ниже мы предоставили контекстную информацию.\r\n    ---------------------\r\n    {context_str}\r\n    ---------------------\r\n    Учитывая эту информацию, ответьте, пожалуйста, на вопрос: {query_str}\r\n    ', 'response_mode': 'compact', 'user_id': 12, 'answer': None, 'context': None}
INFO:werkzeug:127.0.0.1 - - [01/Jan/2024 21:40:07] "POST /projects/e47f0f811145d03c33fd6639dc3f09c0839d0891e264d849a75df04f4d047625/FdLp3U4YgjGAxsEFmJbaZtLi6akR8Lqj HTTP/1.1" 200 -
DEBUG:myapp:Flask app started
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
INFO:werkzeug:[33mPress CTRL+C to quit[0m
DEBUG:root:This is a debug message
DEBUG:celery.utils.functional:
def unlock_chord(self, group_id, callback, interval=0, max_retries=1, result=2, Result=3, GroupResult=4, result_from_tuple=5, **kwargs):
    return 1

DEBUG:celery.utils.functional:
def group(self, tasks, result, group_id, partial_args, add_to_parent=0):
    return 1

DEBUG:celery.utils.functional:
def send_chat_request(user_id, project_id, session, total_tokens, answer, context):
    return 1

DEBUG:celery.utils.functional:
def xmap(task, it):
    return 1

DEBUG:celery.utils.functional:
def sendEmbeddingRequest(user_id, total_tokens):
    return 1

DEBUG:celery.utils.functional:
def backend_cleanup():
    return 1

DEBUG:celery.utils.functional:
def set_vector_index_task(self, token):
    return 1

DEBUG:celery.utils.functional:
def process_set_vector_index(self, token, task_id):
    return 1

DEBUG:celery.utils.functional:
def chain(*args, **kwargs):
    return 1

DEBUG:celery.utils.functional:
def xstarmap(task, it):
    return 1

DEBUG:celery.utils.functional:
def accumulate(self, *args, **kwargs):
    return 1

DEBUG:celery.utils.functional:
def chord(self, header, body, partial_args=0, interval=1, countdown=2, max_retries=3, eager=4, **kwargs):
    return 1

DEBUG:celery.utils.functional:
def chunks(task, it, n):
    return 1

INFO:werkzeug:127.0.0.1 - - [01/Jan/2024 22:15:13] "GET /files/e47f0f811145d03c33fd6639dc3f09c0839d0891e264d849a75df04f4d047625 HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [01/Jan/2024 22:15:27] "OPTIONS /projects/e47f0f811145d03c33fd6639dc3f09c0839d0891e264d849a75df04f4d047625/rfi309H8SpTUPE78XH5mwES1Ierla5Yn HTTP/1.1" 200 -
INFO:myapp:{'api': 1, 'product_data': 'http://wordpress/wp-json/chatty/v1', 'website': 'asdf', 'id': 4, 'left_tokens': 68399, 'description': None, 'temperature': Decimal('0.00'), 'model': 'gpt-3.5-turbo', 'prompt': 'Вы — ИИ ассистент компании. Вам будут заданы вопросы о нашей компании. Вежливо отвечайте на вопросы.\r\n    Ниже мы предоставили контекстную информацию.\r\n    ---------------------\r\n    {context_str}\r\n    ---------------------\r\n    Учитывая эту информацию, ответьте, пожалуйста, на вопрос: {query_str}\r\n    ', 'response_mode': 'compact', 'user_id': 12, 'answer': None, 'context': None}
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): wordpress:80
DEBUG:urllib3.connectionpool:http://wordpress:80 "GET /wp-json/chatty/v1/shop_meta HTTP/1.1" 200 67
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.openai.com:443
DEBUG:urllib3.connectionpool:https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
INFO:myapp:[{'url_params': 'product_name=xiaomi', 'is_related': 'yes', 'category': 'smartphones'}]
INFO:myapp:product_name=xiaomi
INFO:myapp:prompt
INFO:myapp:You are AI assistant for a online shop. You should determine if a client is asking or information about a product in our store. It can be a question about price, availability in stock, product characteristic, comparing 2 products. In this case you should contruct query parameters based on a client question. Construct them for every mentioned product. Add sort_price parameter if required .For example product_name=item_name&color=green&size=44&sort_price=desc|asc List of available query parameters: product_name, color. product_name is a required parameter. You should use it in every query.Use only these query parameters for consructing. Add a category. List of available categories: laptops,smartphones. Write your asnwer as array of json objects. [{url_params: <url_here>, is_related: 'yes', category: <category_here> }] If the question is not related to products of the store, then your answer would be [{is_related: 'no'}] Be strict. Fix typos in product names. Dont write anything else. Your answer will be used for a next query. ========== History of conversation with client: NoneClient question: hello, do you have xiaomi .Your answer:
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): wordpress:80
DEBUG:urllib3.connectionpool:http://wordpress:80 "GET /wp-json/chatty/v1/posts?product_name=xiaomi HTTP/1.1" 200 1965
INFO:myapp:api data [{"id":17,"title":"Xiaomi 13","content":"\r\n \tUltra-immersive display design Light up the screen to enjoy an unrivalled experience. The 1.61mm ultra-thin bezels offer a boundless vision.\r\n \tBuilt for more scenarios IP68 water and dust resistant* Born splash-proof and water-resistant, thanks to the precision manufacturing. Record special memories anytime and anywhere.\r\n \tLeica main camera with professional optical lens Captures every great moment\r\n \tMasterpiece performance Leading Snapdragon 8 Gen 2 Boosted performance, reduced consumption\r\n","date":"27.12.2023","attributes":{"pa_color":["silver"]},"stock":"outofstock","image_url":false,"sku":"141234","price":"16000","formatted_price":"<span class=\"woocommerce-Price-amount amount\"><bdi>16000,00&nbsp;<span class=\"woocommerce-Price-currencySymbol\">&#8381;<\/span><\/bdi><\/span>","formatted_sale_price":"<span class=\"woocommerce-Price-amount amount\"><bdi>0,00&nbsp;<span class=\"woocommerce-Price-currencySymbol\">&#8381;<\/span><\/bdi><\/span>","on_sale":false,"product_link":"http:\/\/wordpress\/product\/%d0%ba%d1%80%d0%be%d1%81%d1%81%d0%be%d0%b2%d0%ba%d0%b8\/","weigth":"1 \u043a\u0433","dimensions":"23 &times; 23 &times; 33 \u0441\u043c","dimension_unit":"cm"},{"id":20,"title":"Xiaomi Redmi 12 128GB &#8212; Black &#8212; Unlocked &#8212; Dual-SIM","content":"","date":"29.12.2023","attributes":{"pa_color":["black"]},"stock":"instock","image_url":false,"sku":"141234-1","price":"15000","formatted_price":"<span class=\"woocommerce-Price-amount amount\"><bdi>15000,00&nbsp;<span class=\"woocommerce-Price-currencySymbol\">&#8381;<\/span><\/bdi><\/span>","formatted_sale_price":"<span class=\"woocommerce-Price-amount amount\"><bdi>0,00&nbsp;<span class=\"woocommerce-Price-currencySymbol\">&#8381;<\/span><\/bdi><\/span>","on_sale":false,"product_link":"http:\/\/wordpress\/product\/xiaomi-12-black\/","weigth":"\u041d\/\u0414","dimensions":"\u041d\/\u0414","dimension_unit":"cm"}]
DEBUG:llama_index.storage.kvstore.simple_kvstore:Loading llama_index.storage.kvstore.simple_kvstore from projects/4/data\docstore.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/docstore.json
DEBUG:llama_index.storage.kvstore.simple_kvstore:Loading llama_index.storage.kvstore.simple_kvstore from projects/4/data\index_store.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/index_store.json
DEBUG:llama_index.vector_stores.simple:Loading llama_index.vector_stores.simple from projects/4/data\vector_store.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/vector_store.json
DEBUG:llama_index.graph_stores.simple:Loading llama_index.graph_stores.simple from projects/4/data\graph_store.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/graph_store.json
INFO:myapp:Final prompt: Вы — ИИ ассистент компании. Вам будут заданы вопросы о нашей компании. Вежливо отвечайте на вопросы.
    Ниже мы предоставили контекстную информацию.
    ---------------------
    {context_str}
    ---------------------
    Учитывая эту информацию, ответьте, пожалуйста, на вопрос: {query_str}
    
 ============
 History of conversation with the client: None
=========== 
 Information about relative products [{"id":17,"title":"Xiaomi 13","content":"\r\n \tUltra-immersive display design Light up the screen to enjoy an unrivalled experience. The 1.61mm ultra-thin bezels offer a boundless vision.\r\n \tBuilt for more scenarios IP68 water and dust resistant* Born splash-proof and water-resistant, thanks to the precision manufacturing. Record special memories anytime and anywhere.\r\n \tLeica main camera with professional optical lens Captures every great moment\r\n \tMasterpiece performance Leading Snapdragon 8 Gen 2 Boosted performance, reduced consumption\r\n","date":"27.12.2023","attributes":{"pa_color":["silver"]},"stock":"outofstock","image_url":false,"sku":"141234","price":"16000","formatted_price":"<span class=\"woocommerce-Price-amount amount\"><bdi>16000,00&nbsp;<span class=\"woocommerce-Price-currencySymbol\">&#8381;<\/span><\/bdi><\/span>","formatted_sale_price":"<span class=\"woocommerce-Price-amount amount\"><bdi>0,00&nbsp;<span class=\"woocommerce-Price-currencySymbol\">&#8381;<\/span><\/bdi><\/span>","on_sale":false,"product_link":"http:\/\/wordpress\/product\/%d0%ba%d1%80%d0%be%d1%81%d1%81%d0%be%d0%b2%d0%ba%d0%b8\/","weigth":"1 \u043a\u0433","dimensions":"23 &times; 23 &times; 33 \u0441\u043c","dimension_unit":"cm"},{"id":20,"title":"Xiaomi Redmi 12 128GB &#8212; Black &#8212; Unlocked &#8212; Dual-SIM","content":"","date":"29.12.2023","attributes":{"pa_color":["black"]},"stock":"instock","image_url":false,"sku":"141234-1","price":"15000","formatted_price":"<span class=\"woocommerce-Price-amount amount\"><bdi>15000,00&nbsp;<span class=\"woocommerce-Price-currencySymbol\">&#8381;<\/span><\/bdi><\/span>","formatted_sale_price":"<span class=\"woocommerce-Price-amount amount\"><bdi>0,00&nbsp;<span class=\"woocommerce-Price-currencySymbol\">&#8381;<\/span><\/bdi><\/span>","on_sale":false,"product_link":"http:\/\/wordpress\/product\/xiaomi-12-black\/","weigth":"\u041d\/\u0414","dimensions":"\u041d\/\u0414","dimension_unit":"cm"}]
INFO:llama_index.indices.loading:Loading indices with ids: ['vector_index']
DEBUG:openai:message='Request to OpenAI API' method=post path=https://api.openai.com/v1/embeddings
DEBUG:openai:api_version=None data='{"input": ["hello, do you have xiaomi"], "model": "text-embedding-ada-002", "encoding_format": "base64"}' message='Post details'
DEBUG:urllib3.util.retry:Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.openai.com:443
DEBUG:urllib3.connectionpool:https://api.openai.com:443 "POST /v1/embeddings HTTP/1.1" 200 None
DEBUG:openai:message='OpenAI API response' path=https://api.openai.com/v1/embeddings processing_ms=19 request_id=5a698dc32f81282bd2ef23eaf3782895 response_code=200
DEBUG:llama_index.indices.utils:> Top 1 nodes:
> [Node 909c5dd5-e87e-4999-a794-761f96e44168] [Similarity score:             -0.0278777] Welcome to TechHub, your ultimate destination for cutting-edge technology and innovation! At Tech...
DEBUG:openai:message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
DEBUG:openai:api_version=None data='{"messages": [{"role": "system", "content": "Context information is below.\\n--------------------\\nWelcome to TechHub, your ultimate destination for cutting-edge technology and innovation! At TechHub, we pride ourselves on being a premier online store dedicated to providing a curated selection of the latest and greatest in tech gadgets, including laptops, smartphones, and more.\\n\\nAbout Us:\\n\\nAt the heart of TechHub is a passion for technology and a commitment to delivering top-notch products that seamlessly blend style, functionality, and performance. With a team of tech enthusiasts, we understand the ever-evolving nature of the digital landscape and strive to stay at the forefront of the latest trends and advancements.\\n\\nOur Mission:\\n\\nOur mission at TechHub is to empower our customers with the best tools and devices that enhance their digital lifestyle. Whether you\'re a professional looking for a high-performance laptop to boost productivity or a smartphone aficionado seeking the latest flagship model, we\'ve got you covered. We believe that technology should not only meet but exceed your expectations, making every interaction with your devices a seamless and enjoyable experience.\\n\\nQuality Assurance:\\n\\nTechHub is committed to delivering products of the highest quality. We carefully curate our inventory, partnering with leading brands known for their commitment to excellence. Each product undergoes rigorous testing to ensure reliability, durability, and top-notch performance. Our dedication to quality assurance is reflected in every item we offer.\\n\\nCustomer-Centric Approach:\\n\\nAt TechHub, our customers are at the core of everything we do. We prioritize your satisfaction and strive to provide an unparalleled shopping experience. Our customer support team is ready to assist you at every step, from product inquiries to after-sales support. We value your feedback and continuously work to improve our services based on your needs.\\n\\nSecure Shopping:\\n\\nYour online security is our priority. TechHub employs state-of-the-art encryption technology to ensure that your personal information remains secure and protected. Shop with confidence, knowing that your data is in safe hands.\\n\\nExplore the world of innovation at TechHub, where technology meets lifestyle. Discover the perfect blend of style and functionality with our carefully curated selection of laptops, smartphones, and other cutting-edge gadgets. Join us on this exciting journey, and let\'s embrace the future together!\\n--------------------\\n\\u0412\\u044b \\u2014 \\u0418\\u0418 \\u0430\\u0441\\u0441\\u0438\\u0441\\u0442\\u0435\\u043d\\u0442 \\u043a\\u043e\\u043c\\u043f\\u0430\\u043d\\u0438\\u0438. \\u0412\\u0430\\u043c \\u0431\\u0443\\u0434\\u0443\\u0442 \\u0437\\u0430\\u0434\\u0430\\u043d\\u044b \\u0432\\u043e\\u043f\\u0440\\u043e\\u0441\\u044b \\u043e \\u043d\\u0430\\u0448\\u0435\\u0439 \\u043a\\u043e\\u043c\\u043f\\u0430\\u043d\\u0438\\u0438. \\u0412\\u0435\\u0436\\u043b\\u0438\\u0432\\u043e \\u043e\\u0442\\u0432\\u0435\\u0447\\u0430\\u0439\\u0442\\u0435 \\u043d\\u0430 \\u0432\\u043e\\u043f\\u0440\\u043e\\u0441\\u044b.\\r\\n    \\u041d\\u0438\\u0436\\u0435 \\u043c\\u044b \\u043f\\u0440\\u0435\\u0434\\u043e\\u0441\\u0442\\u0430\\u0432\\u0438\\u043b\\u0438 \\u043a\\u043e\\u043d\\u0442\\u0435\\u043a\\u0441\\u0442\\u043d\\u0443\\u044e \\u0438\\u043d\\u0444\\u043e\\u0440\\u043c\\u0430\\u0446\\u0438\\u044e.\\r\\n    ---------------------\\r\\n    {context_str}\\r\\n    ---------------------\\r\\n    \\u0423\\u0447\\u0438\\u0442\\u044b\\u0432\\u0430\\u044f \\u044d\\u0442\\u0443 \\u0438\\u043d\\u0444\\u043e\\u0440\\u043c\\u0430\\u0446\\u0438\\u044e, \\u043e\\u0442\\u0432\\u0435\\u0442\\u044c\\u0442\\u0435, \\u043f\\u043e\\u0436\\u0430\\u043b\\u0443\\u0439\\u0441\\u0442\\u0430, \\u043d\\u0430 \\u0432\\u043e\\u043f\\u0440\\u043e\\u0441: {query_str}\\r\\n    \\n ============\\n History of conversation with the client: None\\n=========== \\n Information about relative products [{\\"id\\":17,\\"title\\":\\"Xiaomi 13\\",\\"content\\":\\"\\\\r\\\\n \\\\tUltra-immersive display design Light up the screen to enjoy an unrivalled experience. The 1.61mm ultra-thin bezels offer a boundless vision.\\\\r\\\\n \\\\tBuilt for more scenarios IP68 water and dust resistant* Born splash-proof and water-resistant, thanks to the precision manufacturing. Record special memories anytime and anywhere.\\\\r\\\\n \\\\tLeica main camera with professional optical lens Captures every great moment\\\\r\\\\n \\\\tMasterpiece performance Leading Snapdragon 8 Gen 2 Boosted performance, reduced consumption\\\\r\\\\n\\",\\"date\\":\\"27.12.2023\\",\\"attributes\\":{\\"pa_color\\":[\\"silver\\"]},\\"stock\\":\\"outofstock\\",\\"image_url\\":false,\\"sku\\":\\"141234\\",\\"price\\":\\"16000\\",\\"formatted_price\\":\\"<span class=\\\\\\"woocommerce-Price-amount amount\\\\\\"><bdi>16000,00&nbsp;<span class=\\\\\\"woocommerce-Price-currencySymbol\\\\\\">&#8381;<\\\\/span><\\\\/bdi><\\\\/span>\\",\\"formatted_sale_price\\":\\"<span class=\\\\\\"woocommerce-Price-amount amount\\\\\\"><bdi>0,00&nbsp;<span class=\\\\\\"woocommerce-Price-currencySymbol\\\\\\">&#8381;<\\\\/span><\\\\/bdi><\\\\/span>\\",\\"on_sale\\":false,\\"product_link\\":\\"http:\\\\/\\\\/wordpress\\\\/product\\\\/%d0%ba%d1%80%d0%be%d1%81%d1%81%d0%be%d0%b2%d0%ba%d0%b8\\\\/\\",\\"weigth\\":\\"1 \\\\u043a\\\\u0433\\",\\"dimensions\\":\\"23 &times; 23 &times; 33 \\\\u0441\\\\u043c\\",\\"dimension_unit\\":\\"cm\\"},{\\"id\\":20,\\"title\\":\\"Xiaomi Redmi 12 128GB &#8212; Black &#8212; Unlocked &#8212; Dual-SIM\\",\\"content\\":\\"\\",\\"date\\":\\"29.12.2023\\",\\"attributes\\":{\\"pa_color\\":[\\"black\\"]},\\"stock\\":\\"instock\\",\\"image_url\\":false,\\"sku\\":\\"141234-1\\",\\"price\\":\\"15000\\",\\"formatted_price\\":\\"<span class=\\\\\\"woocommerce-Price-amount amount\\\\\\"><bdi>15000,00&nbsp;<span class=\\\\\\"woocommerce-Price-currencySymbol\\\\\\">&#8381;<\\\\/span><\\\\/bdi><\\\\/span>\\",\\"formatted_sale_price\\":\\"<span class=\\\\\\"woocommerce-Price-amount amount\\\\\\"><bdi>0,00&nbsp;<span class=\\\\\\"woocommerce-Price-currencySymbol\\\\\\">&#8381;<\\\\/span><\\\\/bdi><\\\\/span>\\",\\"on_sale\\":false,\\"product_link\\":\\"http:\\\\/\\\\/wordpress\\\\/product\\\\/xiaomi-12-black\\\\/\\",\\"weigth\\":\\"\\\\u041d\\\\/\\\\u0414\\",\\"dimensions\\":\\"\\\\u041d\\\\/\\\\u0414\\",\\"dimension_unit\\":\\"cm\\"}]"}, {"role": "user", "content": "hello, do you have xiaomi"}], "stream": false, "model": "gpt-3.5-turbo", "temperature": 0, "max_tokens": null}' message='Post details'
DEBUG:urllib3.connectionpool:https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
DEBUG:openai:message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=565 request_id=f380012812216581fdb002d848d2d4c1 response_code=200
INFO:myapp:{'api': 1, 'product_data': 'http://wordpress/wp-json/chatty/v1', 'website': 'asdf', 'id': 4, 'left_tokens': 68399, 'description': None, 'temperature': Decimal('0.00'), 'model': 'gpt-3.5-turbo', 'prompt': 'Вы — ИИ ассистент компании. Вам будут заданы вопросы о нашей компании. Вежливо отвечайте на вопросы.\r\n    Ниже мы предоставили контекстную информацию.\r\n    ---------------------\r\n    {context_str}\r\n    ---------------------\r\n    Учитывая эту информацию, ответьте, пожалуйста, на вопрос: {query_str}\r\n    ', 'response_mode': 'compact', 'user_id': 12, 'answer': None, 'context': None}
DEBUG:root:This is a debug message
DEBUG:celery.utils.functional:
def send_chat_request(user_id, project_id, session, total_tokens, answer, context):
    return 1

INFO:werkzeug:127.0.0.1 - - [01/Jan/2024 22:15:53] "POST /projects/e47f0f811145d03c33fd6639dc3f09c0839d0891e264d849a75df04f4d047625/rfi309H8SpTUPE78XH5mwES1Ierla5Yn HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [01/Jan/2024 22:17:42] "OPTIONS /projects/e47f0f811145d03c33fd6639dc3f09c0839d0891e264d849a75df04f4d047625/rfi309H8SpTUPE78XH5mwES1Ierla5Yn HTTP/1.1" 200 -
INFO:myapp:{'api': 1, 'product_data': 'http://wordpress/wp-json/chatty/v1', 'website': 'asdf', 'id': 4, 'left_tokens': 67223, 'description': None, 'temperature': Decimal('0.00'), 'model': 'gpt-3.5-turbo', 'prompt': 'Вы — ИИ ассистент компании. Вам будут заданы вопросы о нашей компании. Вежливо отвечайте на вопросы.\r\n    Ниже мы предоставили контекстную информацию.\r\n    ---------------------\r\n    {context_str}\r\n    ---------------------\r\n    Учитывая эту информацию, ответьте, пожалуйста, на вопрос: {query_str}\r\n    ', 'response_mode': 'compact', 'user_id': 12, 'answer': 'Client: hello, do you have xiaomi,\nAi response: Yes, we have Xiaomi products available. Can you please specify which Xiaomi product you are interested in?', 'context': '[{"id":17,"title":"Xiaomi 13","content":"\\r\\n \\tUltra-immersive display design Light up the screen to enjoy an unrivalled experience. The 1.61mm ultra-thin bezels offer a boundless vision.\\r\\n \\tBuilt for more scenarios IP68 water and dust resistant* Born splash-proof and water-resistant, thanks to the precision manufacturing. Record special memories anytime and anywhere.\\r\\n \\tLeica main camera with professional optical lens Captures every great moment\\r\\n \\tMasterpiece performance Leading Snapdragon 8 Gen 2 Boosted performance, reduced consumption\\r\\n","date":"27.12.2023","attributes":{"pa_color":["silver"]},"stock":"outofstock","image_url":false,"sku":"141234","price":"16000","formatted_price":"<span class=\\"woocommerce-Price-amount amount\\"><bdi>16000,00&nbsp;<span class=\\"woocommerce-Price-currencySymbol\\">&#8381;<\\/span><\\/bdi><\\/span>","formatted_sale_price":"<span class=\\"woocommerce-Price-amount amount\\"><bdi>0,00&nbsp;<span class=\\"woocommerce-Price-currencySymbol\\">&#8381;<\\/span><\\/bdi><\\/span>","on_sale":false,"product_link":"http:\\/\\/wordpress\\/product\\/%d0%ba%d1%80%d0%be%d1%81%d1%81%d0%be%d0%b2%d0%ba%d0%b8\\/","weigth":"1 \\u043a\\u0433","dimensions":"23 &times; 23 &times; 33 \\u0441\\u043c","dimension_unit":"cm"},{"id":20,"title":"Xiaomi Redmi 12 128GB &#8212; Black &#8212; Unlocked &#8212; Dual-SIM","content":"","date":"29.12.2023","attributes":{"pa_color":["black"]},"stock":"instock","image_url":false,"sku":"141234-1","price":"15000","formatted_price":"<span class=\\"woocommerce-Price-amount amount\\"><bdi>15000,00&nbsp;<span class=\\"woocommerce-Price-currencySymbol\\">&#8381;<\\/span><\\/bdi><\\/span>","formatted_sale_price":"<span class=\\"woocommerce-Price-amount amount\\"><bdi>0,00&nbsp;<span class=\\"woocommerce-Price-currencySymbol\\">&#8381;<\\/span><\\/bdi><\\/span>","on_sale":false,"product_link":"http:\\/\\/wordpress\\/product\\/xiaomi-12-black\\/","weigth":"\\u041d\\/\\u0414","dimensions":"\\u041d\\/\\u0414","dimension_unit":"cm"}]'}
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): wordpress:80
DEBUG:urllib3.connectionpool:http://wordpress:80 "GET /wp-json/chatty/v1/shop_meta HTTP/1.1" 200 67
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.openai.com:443
DEBUG:urllib3.connectionpool:https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
INFO:myapp:[{'url_params': 'product_name=xiaomi', 'is_related': 'yes', 'category': 'smartphones'}]
INFO:myapp:product_name=xiaomi
INFO:myapp:prompt
INFO:myapp:You are AI assistant for a online shop. You should determine if a client is asking or information about a product in our store. It can be a question about price, availability in stock, product characteristic, comparing 2 products. In this case you should contruct query parameters based on a client question. Construct them for every mentioned product. Add sort_price parameter if required .For example product_name=item_name&color=green&size=44&sort_price=desc|asc List of available query parameters: product_name, color. product_name is a required parameter. You should use it in every query.Use only these query parameters for consructing. Add a category. List of available categories: laptops,smartphones. Write your asnwer as array of json objects. [{url_params: <url_here>, is_related: 'yes', category: <category_here> }] If the question is not related to products of the store, then your answer would be [{is_related: 'no'}] Be strict. Fix typos in product names. Dont write anything else. Your answer will be used for a next query. ========== History of conversation with client: Client: hello, do you have xiaomi,
Ai response: Yes, we have Xiaomi products available. Can you please specify which Xiaomi product you are interested in?Client question: 13 .Your answer:
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): wordpress:80
DEBUG:urllib3.connectionpool:http://wordpress:80 "GET /wp-json/chatty/v1/posts?product_name=xiaomi HTTP/1.1" 200 1965
INFO:myapp:api data [{"id":17,"title":"Xiaomi 13","content":"\r\n \tUltra-immersive display design Light up the screen to enjoy an unrivalled experience. The 1.61mm ultra-thin bezels offer a boundless vision.\r\n \tBuilt for more scenarios IP68 water and dust resistant* Born splash-proof and water-resistant, thanks to the precision manufacturing. Record special memories anytime and anywhere.\r\n \tLeica main camera with professional optical lens Captures every great moment\r\n \tMasterpiece performance Leading Snapdragon 8 Gen 2 Boosted performance, reduced consumption\r\n","date":"27.12.2023","attributes":{"pa_color":["silver"]},"stock":"outofstock","image_url":false,"sku":"141234","price":"16000","formatted_price":"<span class=\"woocommerce-Price-amount amount\"><bdi>16000,00&nbsp;<span class=\"woocommerce-Price-currencySymbol\">&#8381;<\/span><\/bdi><\/span>","formatted_sale_price":"<span class=\"woocommerce-Price-amount amount\"><bdi>0,00&nbsp;<span class=\"woocommerce-Price-currencySymbol\">&#8381;<\/span><\/bdi><\/span>","on_sale":false,"product_link":"http:\/\/wordpress\/product\/%d0%ba%d1%80%d0%be%d1%81%d1%81%d0%be%d0%b2%d0%ba%d0%b8\/","weigth":"1 \u043a\u0433","dimensions":"23 &times; 23 &times; 33 \u0441\u043c","dimension_unit":"cm"},{"id":20,"title":"Xiaomi Redmi 12 128GB &#8212; Black &#8212; Unlocked &#8212; Dual-SIM","content":"","date":"29.12.2023","attributes":{"pa_color":["black"]},"stock":"instock","image_url":false,"sku":"141234-1","price":"15000","formatted_price":"<span class=\"woocommerce-Price-amount amount\"><bdi>15000,00&nbsp;<span class=\"woocommerce-Price-currencySymbol\">&#8381;<\/span><\/bdi><\/span>","formatted_sale_price":"<span class=\"woocommerce-Price-amount amount\"><bdi>0,00&nbsp;<span class=\"woocommerce-Price-currencySymbol\">&#8381;<\/span><\/bdi><\/span>","on_sale":false,"product_link":"http:\/\/wordpress\/product\/xiaomi-12-black\/","weigth":"\u041d\/\u0414","dimensions":"\u041d\/\u0414","dimension_unit":"cm"}]
DEBUG:llama_index.storage.kvstore.simple_kvstore:Loading llama_index.storage.kvstore.simple_kvstore from projects/4/data\docstore.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/docstore.json
DEBUG:llama_index.storage.kvstore.simple_kvstore:Loading llama_index.storage.kvstore.simple_kvstore from projects/4/data\index_store.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/index_store.json
DEBUG:llama_index.vector_stores.simple:Loading llama_index.vector_stores.simple from projects/4/data\vector_store.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/vector_store.json
DEBUG:llama_index.graph_stores.simple:Loading llama_index.graph_stores.simple from projects/4/data\graph_store.json.
DEBUG:fsspec.local:open file: C:/OSPanel/domains/ai_assistant/api/projects/4/data/graph_store.json
INFO:myapp:Final prompt: Вы — ИИ ассистент компании. Вам будут заданы вопросы о нашей компании. Вежливо отвечайте на вопросы.
    Ниже мы предоставили контекстную информацию.
    ---------------------
    {context_str}
    ---------------------
    Учитывая эту информацию, ответьте, пожалуйста, на вопрос: {query_str}
    
 ============
 History of conversation with the client: Client: hello, do you have xiaomi,
Ai response: Yes, we have Xiaomi products available. Can you please specify which Xiaomi product you are interested in?
=========== 
 Information about relative products [{"id":17,"title":"Xiaomi 13","content":"\r\n \tUltra-immersive display design Light up the screen to enjoy an unrivalled experience. The 1.61mm ultra-thin bezels offer a boundless vision.\r\n \tBuilt for more scenarios IP68 water and dust resistant* Born splash-proof and water-resistant, thanks to the precision manufacturing. Record special memories anytime and anywhere.\r\n \tLeica main camera with professional optical lens Captures every great moment\r\n \tMasterpiece performance Leading Snapdragon 8 Gen 2 Boosted performance, reduced consumption\r\n","date":"27.12.2023","attributes":{"pa_color":["silver"]},"stock":"outofstock","image_url":false,"sku":"141234","price":"16000","formatted_price":"<span class=\"woocommerce-Price-amount amount\"><bdi>16000,00&nbsp;<span class=\"woocommerce-Price-currencySymbol\">&#8381;<\/span><\/bdi><\/span>","formatted_sale_price":"<span class=\"woocommerce-Price-amount amount\"><bdi>0,00&nbsp;<span class=\"woocommerce-Price-currencySymbol\">&#8381;<\/span><\/bdi><\/span>","on_sale":false,"product_link":"http:\/\/wordpress\/product\/%d0%ba%d1%80%d0%be%d1%81%d1%81%d0%be%d0%b2%d0%ba%d0%b8\/","weigth":"1 \u043a\u0433","dimensions":"23 &times; 23 &times; 33 \u0441\u043c","dimension_unit":"cm"},{"id":20,"title":"Xiaomi Redmi 12 128GB &#8212; Black &#8212; Unlocked &#8212; Dual-SIM","content":"","date":"29.12.2023","attributes":{"pa_color":["black"]},"stock":"instock","image_url":false,"sku":"141234-1","price":"15000","formatted_price":"<span class=\"woocommerce-Price-amount amount\"><bdi>15000,00&nbsp;<span class=\"woocommerce-Price-currencySymbol\">&#8381;<\/span><\/bdi><\/span>","formatted_sale_price":"<span class=\"woocommerce-Price-amount amount\"><bdi>0,00&nbsp;<span class=\"woocommerce-Price-currencySymbol\">&#8381;<\/span><\/bdi><\/span>","on_sale":false,"product_link":"http:\/\/wordpress\/product\/xiaomi-12-black\/","weigth":"\u041d\/\u0414","dimensions":"\u041d\/\u0414","dimension_unit":"cm"}][{"id":17,"title":"Xiaomi 13","content":"\r\n \tUltra-immersive display design Light up the screen to enjoy an unrivalled experience. The 1.61mm ultra-thin bezels offer a boundless vision.\r\n \tBuilt for more scenarios IP68 water and dust resistant* Born splash-proof and water-resistant, thanks to the precision manufacturing. Record special memories anytime and anywhere.\r\n \tLeica main camera with professional optical lens Captures every great moment\r\n \tMasterpiece performance Leading Snapdragon 8 Gen 2 Boosted performance, reduced consumption\r\n","date":"27.12.2023","attributes":{"pa_color":["silver"]},"stock":"outofstock","image_url":false,"sku":"141234","price":"16000","formatted_price":"<span class=\"woocommerce-Price-amount amount\"><bdi>16000,00&nbsp;<span class=\"woocommerce-Price-currencySymbol\">&#8381;<\/span><\/bdi><\/span>","formatted_sale_price":"<span class=\"woocommerce-Price-amount amount\"><bdi>0,00&nbsp;<span class=\"woocommerce-Price-currencySymbol\">&#8381;<\/span><\/bdi><\/span>","on_sale":false,"product_link":"http:\/\/wordpress\/product\/%d0%ba%d1%80%d0%be%d1%81%d1%81%d0%be%d0%b2%d0%ba%d0%b8\/","weigth":"1 \u043a\u0433","dimensions":"23 &times; 23 &times; 33 \u0441\u043c","dimension_unit":"cm"},{"id":20,"title":"Xiaomi Redmi 12 128GB &#8212; Black &#8212; Unlocked &#8212; Dual-SIM","content":"","date":"29.12.2023","attributes":{"pa_color":["black"]},"stock":"instock","image_url":false,"sku":"141234-1","price":"15000","formatted_price":"<span class=\"woocommerce-Price-amount amount\"><bdi>15000,00&nbsp;<span class=\"woocommerce-Price-currencySymbol\">&#8381;<\/span><\/bdi><\/span>","formatted_sale_price":"<span class=\"woocommerce-Price-amount amount\"><bdi>0,00&nbsp;<span class=\"woocommerce-Price-currencySymbol\">&#8381;<\/span><\/bdi><\/span>","on_sale":false,"product_link":"http:\/\/wordpress\/product\/xiaomi-12-black\/","weigth":"\u041d\/\u0414","dimensions":"\u041d\/\u0414","dimension_unit":"cm"}]
INFO:llama_index.indices.loading:Loading indices with ids: ['vector_index']
DEBUG:openai:message='Request to OpenAI API' method=post path=https://api.openai.com/v1/embeddings
DEBUG:openai:api_version=None data='{"input": ["13"], "model": "text-embedding-ada-002", "encoding_format": "base64"}' message='Post details'
DEBUG:urllib3.util.retry:Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): api.openai.com:443
DEBUG:urllib3.connectionpool:https://api.openai.com:443 "POST /v1/embeddings HTTP/1.1" 200 None
DEBUG:openai:message='OpenAI API response' path=https://api.openai.com/v1/embeddings processing_ms=17 request_id=51e8391cb63efad709b091b1ff27cbf1 response_code=200
DEBUG:llama_index.indices.utils:> Top 1 nodes:
> [Node 909c5dd5-e87e-4999-a794-761f96e44168] [Similarity score:             -0.0300609] Welcome to TechHub, your ultimate destination for cutting-edge technology and innovation! At Tech...
DEBUG:openai:message='Request to OpenAI API' method=post path=https://api.openai.com/v1/chat/completions
DEBUG:openai:api_version=None data='{"messages": [{"role": "system", "content": "Context information is below.\\n--------------------\\nWelcome to TechHub, your ultimate destination for cutting-edge technology and innovation! At TechHub, we pride ourselves on being a premier online store dedicated to providing a curated selection of the latest and greatest in tech gadgets, including laptops, smartphones, and more.\\n\\nAbout Us:\\n\\nAt the heart of TechHub is a passion for technology and a commitment to delivering top-notch products that seamlessly blend style, functionality, and performance. With a team of tech enthusiasts, we understand the ever-evolving nature of the digital landscape and strive to stay at the forefront of the latest trends and advancements.\\n\\nOur Mission:\\n\\nOur mission at TechHub is to empower our customers with the best tools and devices that enhance their digital lifestyle. Whether you\'re a professional looking for a high-performance laptop to boost productivity or a smartphone aficionado seeking the latest flagship model, we\'ve got you covered. We believe that technology should not only meet but exceed your expectations, making every interaction with your devices a seamless and enjoyable experience.\\n\\nQuality Assurance:\\n\\nTechHub is committed to delivering products of the highest quality. We carefully curate our inventory, partnering with leading brands known for their commitment to excellence. Each product undergoes rigorous testing to ensure reliability, durability, and top-notch performance. Our dedication to quality assurance is reflected in every item we offer.\\n\\nCustomer-Centric Approach:\\n\\nAt TechHub, our customers are at the core of everything we do. We prioritize your satisfaction and strive to provide an unparalleled shopping experience. Our customer support team is ready to assist you at every step, from product inquiries to after-sales support. We value your feedback and continuously work to improve our services based on your needs.\\n\\nSecure Shopping:\\n\\nYour online security is our priority. TechHub employs state-of-the-art encryption technology to ensure that your personal information remains secure and protected. Shop with confidence, knowing that your data is in safe hands.\\n\\nExplore the world of innovation at TechHub, where technology meets lifestyle. Discover the perfect blend of style and functionality with our carefully curated selection of laptops, smartphones, and other cutting-edge gadgets. Join us on this exciting journey, and let\'s embrace the future together!\\n--------------------\\n\\u0412\\u044b \\u2014 \\u0418\\u0418 \\u0430\\u0441\\u0441\\u0438\\u0441\\u0442\\u0435\\u043d\\u0442 \\u043a\\u043e\\u043c\\u043f\\u0430\\u043d\\u0438\\u0438. \\u0412\\u0430\\u043c \\u0431\\u0443\\u0434\\u0443\\u0442 \\u0437\\u0430\\u0434\\u0430\\u043d\\u044b \\u0432\\u043e\\u043f\\u0440\\u043e\\u0441\\u044b \\u043e \\u043d\\u0430\\u0448\\u0435\\u0439 \\u043a\\u043e\\u043c\\u043f\\u0430\\u043d\\u0438\\u0438. \\u0412\\u0435\\u0436\\u043b\\u0438\\u0432\\u043e \\u043e\\u0442\\u0432\\u0435\\u0447\\u0430\\u0439\\u0442\\u0435 \\u043d\\u0430 \\u0432\\u043e\\u043f\\u0440\\u043e\\u0441\\u044b.\\r\\n    \\u041d\\u0438\\u0436\\u0435 \\u043c\\u044b \\u043f\\u0440\\u0435\\u0434\\u043e\\u0441\\u0442\\u0430\\u0432\\u0438\\u043b\\u0438 \\u043a\\u043e\\u043d\\u0442\\u0435\\u043a\\u0441\\u0442\\u043d\\u0443\\u044e \\u0438\\u043d\\u0444\\u043e\\u0440\\u043c\\u0430\\u0446\\u0438\\u044e.\\r\\n    ---------------------\\r\\n    {context_str}\\r\\n    ---------------------\\r\\n    \\u0423\\u0447\\u0438\\u0442\\u044b\\u0432\\u0430\\u044f \\u044d\\u0442\\u0443 \\u0438\\u043d\\u0444\\u043e\\u0440\\u043c\\u0430\\u0446\\u0438\\u044e, \\u043e\\u0442\\u0432\\u0435\\u0442\\u044c\\u0442\\u0435, \\u043f\\u043e\\u0436\\u0430\\u043b\\u0443\\u0439\\u0441\\u0442\\u0430, \\u043d\\u0430 \\u0432\\u043e\\u043f\\u0440\\u043e\\u0441: {query_str}\\r\\n    \\n ============\\n History of conversation with the client: Client: hello, do you have xiaomi,\\nAi response: Yes, we have Xiaomi products available. Can you please specify which Xiaomi product you are interested in?\\n=========== \\n Information about relative products [{\\"id\\":17,\\"title\\":\\"Xiaomi 13\\",\\"content\\":\\"\\\\r\\\\n \\\\tUltra-immersive display design Light up the screen to enjoy an unrivalled experience. The 1.61mm ultra-thin bezels offer a boundless vision.\\\\r\\\\n \\\\tBuilt for more scenarios IP68 water and dust resistant* Born splash-proof and water-resistant, thanks to the precision manufacturing. Record special memories anytime and anywhere.\\\\r\\\\n \\\\tLeica main camera with professional optical lens Captures every great moment\\\\r\\\\n \\\\tMasterpiece performance Leading Snapdragon 8 Gen 2 Boosted performance, reduced consumption\\\\r\\\\n\\",\\"date\\":\\"27.12.2023\\",\\"attributes\\":{\\"pa_color\\":[\\"silver\\"]},\\"stock\\":\\"outofstock\\",\\"image_url\\":false,\\"sku\\":\\"141234\\",\\"price\\":\\"16000\\",\\"formatted_price\\":\\"<span class=\\\\\\"woocommerce-Price-amount amount\\\\\\"><bdi>16000,00&nbsp;<span class=\\\\\\"woocommerce-Price-currencySymbol\\\\\\">&#8381;<\\\\/span><\\\\/bdi><\\\\/span>\\",\\"formatted_sale_price\\":\\"<span class=\\\\\\"woocommerce-Price-amount amount\\\\\\"><bdi>0,00&nbsp;<span class=\\\\\\"woocommerce-Price-currencySymbol\\\\\\">&#8381;<\\\\/span><\\\\/bdi><\\\\/span>\\",\\"on_sale\\":false,\\"product_link\\":\\"http:\\\\/\\\\/wordpress\\\\/product\\\\/%d0%ba%d1%80%d0%be%d1%81%d1%81%d0%be%d0%b2%d0%ba%d0%b8\\\\/\\",\\"weigth\\":\\"1 \\\\u043a\\\\u0433\\",\\"dimensions\\":\\"23 &times; 23 &times; 33 \\\\u0441\\\\u043c\\",\\"dimension_unit\\":\\"cm\\"},{\\"id\\":20,\\"title\\":\\"Xiaomi Redmi 12 128GB &#8212; Black &#8212; Unlocked &#8212; Dual-SIM\\",\\"content\\":\\"\\",\\"date\\":\\"29.12.2023\\",\\"attributes\\":{\\"pa_color\\":[\\"black\\"]},\\"stock\\":\\"instock\\",\\"image_url\\":false,\\"sku\\":\\"141234-1\\",\\"price\\":\\"15000\\",\\"formatted_price\\":\\"<span class=\\\\\\"woocommerce-Price-amount amount\\\\\\"><bdi>15000,00&nbsp;<span class=\\\\\\"woocommerce-Price-currencySymbol\\\\\\">&#8381;<\\\\/span><\\\\/bdi><\\\\/span>\\",\\"formatted_sale_price\\":\\"<span class=\\\\\\"woocommerce-Price-amount amount\\\\\\"><bdi>0,00&nbsp;<span class=\\\\\\"woocommerce-Price-currencySymbol\\\\\\">&#8381;<\\\\/span><\\\\/bdi><\\\\/span>\\",\\"on_sale\\":false,\\"product_link\\":\\"http:\\\\/\\\\/wordpress\\\\/product\\\\/xiaomi-12-black\\\\/\\",\\"weigth\\":\\"\\\\u041d\\\\/\\\\u0414\\",\\"dimensions\\":\\"\\\\u041d\\\\/\\\\u0414\\",\\"dimension_unit\\":\\"cm\\"}][{\\"id\\":17,\\"title\\":\\"Xiaomi 13\\",\\"content\\":\\"\\\\r\\\\n \\\\tUltra-immersive display design Light up the screen to enjoy an unrivalled experience. The 1.61mm ultra-thin bezels offer a boundless vision.\\\\r\\\\n \\\\tBuilt for more scenarios IP68 water and dust resistant* Born splash-proof and water-resistant, thanks to the precision manufacturing. Record special memories anytime and anywhere.\\\\r\\\\n \\\\tLeica main camera with professional optical lens Captures every great moment\\\\r\\\\n \\\\tMasterpiece performance Leading Snapdragon 8 Gen 2 Boosted performance, reduced consumption\\\\r\\\\n\\",\\"date\\":\\"27.12.2023\\",\\"attributes\\":{\\"pa_color\\":[\\"silver\\"]},\\"stock\\":\\"outofstock\\",\\"image_url\\":false,\\"sku\\":\\"141234\\",\\"price\\":\\"16000\\",\\"formatted_price\\":\\"<span class=\\\\\\"woocommerce-Price-amount amount\\\\\\"><bdi>16000,00&nbsp;<span class=\\\\\\"woocommerce-Price-currencySymbol\\\\\\">&#8381;<\\\\/span><\\\\/bdi><\\\\/span>\\",\\"formatted_sale_price\\":\\"<span class=\\\\\\"woocommerce-Price-amount amount\\\\\\"><bdi>0,00&nbsp;<span class=\\\\\\"woocommerce-Price-currencySymbol\\\\\\">&#8381;<\\\\/span><\\\\/bdi><\\\\/span>\\",\\"on_sale\\":false,\\"product_link\\":\\"http:\\\\/\\\\/wordpress\\\\/product\\\\/%d0%ba%d1%80%d0%be%d1%81%d1%81%d0%be%d0%b2%d0%ba%d0%b8\\\\/\\",\\"weigth\\":\\"1 \\\\u043a\\\\u0433\\",\\"dimensions\\":\\"23 &times; 23 &times; 33 \\\\u0441\\\\u043c\\",\\"dimension_unit\\":\\"cm\\"},{\\"id\\":20,\\"title\\":\\"Xiaomi Redmi 12 128GB &#8212; Black &#8212; Unlocked &#8212; Dual-SIM\\",\\"content\\":\\"\\",\\"date\\":\\"29.12.2023\\",\\"attributes\\":{\\"pa_color\\":[\\"black\\"]},\\"stock\\":\\"instock\\",\\"image_url\\":false,\\"sku\\":\\"141234-1\\",\\"price\\":\\"15000\\",\\"formatted_price\\":\\"<span class=\\\\\\"woocommerce-Price-amount amount\\\\\\"><bdi>15000,00&nbsp;<span class=\\\\\\"woocommerce-Price-currencySymbol\\\\\\">&#8381;<\\\\/span><\\\\/bdi><\\\\/span>\\",\\"formatted_sale_price\\":\\"<span class=\\\\\\"woocommerce-Price-amount amount\\\\\\"><bdi>0,00&nbsp;<span class=\\\\\\"woocommerce-Price-currencySymbol\\\\\\">&#8381;<\\\\/span><\\\\/bdi><\\\\/span>\\",\\"on_sale\\":false,\\"product_link\\":\\"http:\\\\/\\\\/wordpress\\\\/product\\\\/xiaomi-12-black\\\\/\\",\\"weigth\\":\\"\\\\u041d\\\\/\\\\u0414\\",\\"dimensions\\":\\"\\\\u041d\\\\/\\\\u0414\\",\\"dimension_unit\\":\\"cm\\"}]"}, {"role": "user", "content": "13"}], "stream": false, "model": "gpt-3.5-turbo", "temperature": 0, "max_tokens": null}' message='Post details'
DEBUG:urllib3.connectionpool:https://api.openai.com:443 "POST /v1/chat/completions HTTP/1.1" 200 None
DEBUG:openai:message='OpenAI API response' path=https://api.openai.com/v1/chat/completions processing_ms=3505 request_id=418bc84a4196d993dce4b90a28ad7b32 response_code=200
INFO:myapp:{'api': 1, 'product_data': 'http://wordpress/wp-json/chatty/v1', 'website': 'asdf', 'id': 4, 'left_tokens': 67223, 'description': None, 'temperature': Decimal('0.00'), 'model': 'gpt-3.5-turbo', 'prompt': 'Вы — ИИ ассистент компании. Вам будут заданы вопросы о нашей компании. Вежливо отвечайте на вопросы.\r\n    Ниже мы предоставили контекстную информацию.\r\n    ---------------------\r\n    {context_str}\r\n    ---------------------\r\n    Учитывая эту информацию, ответьте, пожалуйста, на вопрос: {query_str}\r\n    ', 'response_mode': 'compact', 'user_id': 12, 'answer': 'Client: hello, do you have xiaomi,\nAi response: Yes, we have Xiaomi products available. Can you please specify which Xiaomi product you are interested in?', 'context': '[{"id":17,"title":"Xiaomi 13","content":"\\r\\n \\tUltra-immersive display design Light up the screen to enjoy an unrivalled experience. The 1.61mm ultra-thin bezels offer a boundless vision.\\r\\n \\tBuilt for more scenarios IP68 water and dust resistant* Born splash-proof and water-resistant, thanks to the precision manufacturing. Record special memories anytime and anywhere.\\r\\n \\tLeica main camera with professional optical lens Captures every great moment\\r\\n \\tMasterpiece performance Leading Snapdragon 8 Gen 2 Boosted performance, reduced consumption\\r\\n","date":"27.12.2023","attributes":{"pa_color":["silver"]},"stock":"outofstock","image_url":false,"sku":"141234","price":"16000","formatted_price":"<span class=\\"woocommerce-Price-amount amount\\"><bdi>16000,00&nbsp;<span class=\\"woocommerce-Price-currencySymbol\\">&#8381;<\\/span><\\/bdi><\\/span>","formatted_sale_price":"<span class=\\"woocommerce-Price-amount amount\\"><bdi>0,00&nbsp;<span class=\\"woocommerce-Price-currencySymbol\\">&#8381;<\\/span><\\/bdi><\\/span>","on_sale":false,"product_link":"http:\\/\\/wordpress\\/product\\/%d0%ba%d1%80%d0%be%d1%81%d1%81%d0%be%d0%b2%d0%ba%d0%b8\\/","weigth":"1 \\u043a\\u0433","dimensions":"23 &times; 23 &times; 33 \\u0441\\u043c","dimension_unit":"cm"},{"id":20,"title":"Xiaomi Redmi 12 128GB &#8212; Black &#8212; Unlocked &#8212; Dual-SIM","content":"","date":"29.12.2023","attributes":{"pa_color":["black"]},"stock":"instock","image_url":false,"sku":"141234-1","price":"15000","formatted_price":"<span class=\\"woocommerce-Price-amount amount\\"><bdi>15000,00&nbsp;<span class=\\"woocommerce-Price-currencySymbol\\">&#8381;<\\/span><\\/bdi><\\/span>","formatted_sale_price":"<span class=\\"woocommerce-Price-amount amount\\"><bdi>0,00&nbsp;<span class=\\"woocommerce-Price-currencySymbol\\">&#8381;<\\/span><\\/bdi><\\/span>","on_sale":false,"product_link":"http:\\/\\/wordpress\\/product\\/xiaomi-12-black\\/","weigth":"\\u041d\\/\\u0414","dimensions":"\\u041d\\/\\u0414","dimension_unit":"cm"}]'}
INFO:werkzeug:127.0.0.1 - - [01/Jan/2024 22:17:50] "POST /projects/e47f0f811145d03c33fd6639dc3f09c0839d0891e264d849a75df04f4d047625/rfi309H8SpTUPE78XH5mwES1Ierla5Yn HTTP/1.1" 200 -
